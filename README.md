# Address Sanitizer Diagnostics

## Test case 101_PW_15_f_pseudopots

### On process id asan.3008

```bash

=================================================================
==3008==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f9942871e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9940e590bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 432 byte(s) in 6 object(s) allocated from:
    #0 0x7f99428737a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d431277643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55d4317e65fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55d43129796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55d43128794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55d431adcd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55d431aa4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d431aa7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d430de87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f994066bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7f99428737a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d431277643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55d4317ea4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55d43129796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55d43128794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55d431adcd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55d431aa4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d431aa7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d430de87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f994066bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 6 object(s) allocated from:
    #0 0x7f99428737a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d4312774c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55d4317e65fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55d43129796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55d43128794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55d431adcd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55d431aa4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d431aa7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d430de87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f994066bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f99428737a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d430ed35df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55d430eafd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55d431adc24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55d431aa4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55d431aa7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55d430de87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f994066bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f99428737a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d4312774c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55d4317ea4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55d43129796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55d43128794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55d431adcd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55d431aa4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d431aa7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d430de87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f994066bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f99428737a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d430ed34e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55d430eafd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55d431adc24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55d431aa4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55d431aa7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55d430de87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f994066bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f99428737a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d430ed3578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55d430eafd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55d431adc24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55d431aa4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55d431aa7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55d430de87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f994066bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9942871e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9940eaf94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9942871e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9940eaf4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 1696 byte(s) leaked in 22 allocation(s).
```

### On process id asan.3009

```bash

=================================================================
==3009==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 432 byte(s) in 6 object(s) allocated from:
    #0 0x7f074957e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55eab62f0643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55eab685f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55eab631096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55eab630094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55eab6b55d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55eab6b1de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55eab6b20678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55eab5e617cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0747376d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7f074957e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55eab62f0643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55eab68634d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55eab631096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55eab630094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55eab6b55d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55eab6b1de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55eab6b20678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55eab5e617cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0747376d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 6 object(s) allocated from:
    #0 0x7f074957e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55eab62f04c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55eab685f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55eab631096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55eab630094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55eab6b55d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55eab6b1de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55eab6b20678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55eab5e617cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0747376d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f074957e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55eab5ee0df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55eab5f14f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55eab5f290b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55eab6b5524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55eab6b1de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55eab6b20678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55eab5e617cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f0747376d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f074957e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55eab62f04c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55eab68634d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55eab631096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55eab630094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55eab6b55d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55eab6b1de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55eab6b20678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55eab5e617cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0747376d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f074957e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55eab5ee0d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55eab5f14f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55eab5f290b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55eab6b5524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55eab6b1de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55eab6b20678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55eab5e617cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f0747376d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f074957e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55eab5ee0d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55eab5f14f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55eab5f290b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55eab6b5524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55eab6b1de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55eab6b20678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55eab5e617cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f0747376d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 600 byte(s) leaked in 17 allocation(s).
```

## Test case 101_PW_15_pseudopots

### On process id asan.3122

```bash

=================================================================
==3122==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f8431e52e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f843043a0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 960 byte(s) in 10 object(s) allocated from:
    #0 0x7f8431e547a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56234c878643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x56234cde75fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x56234c89896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56234c88894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56234d0ddd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56234d0a5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56234d0a8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56234c3e97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f842fc4cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f8431e547a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56234c878643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x56234cdeb4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x56234c89896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56234c88894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56234d0ddd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56234d0a5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56234d0a8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56234c3e97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f842fc4cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 80 byte(s) in 10 object(s) allocated from:
    #0 0x7f8431e547a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56234c8784c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x56234cde75fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x56234c89896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56234c88894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56234d0ddd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56234d0a5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56234d0a8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56234c3e97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f842fc4cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f8431e547a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56234c4d45df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x56234c4b0d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x56234d0dd24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x56234d0a5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x56234d0a8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x56234c3e97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f842fc4cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f8431e547a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56234c4d44e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x56234c4b0d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x56234d0dd24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x56234d0a5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x56234d0a8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x56234c3e97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f842fc4cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f8431e547a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56234c4d4578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x56234c4b0d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x56234d0dd24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x56234d0a5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x56234d0a8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x56234c3e97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f842fc4cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f8431e547a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56234c8784c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x56234cdeb4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x56234c89896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56234c88894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56234d0ddd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56234d0a5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56234d0a8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56234c3e97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f842fc4cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f8431e52e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f843049094e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f8431e52e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f84304904d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 2320 byte(s) leaked in 30 allocation(s).
```

### On process id asan.3123

```bash

=================================================================
==3123==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 960 byte(s) in 10 object(s) allocated from:
    #0 0x7f54dd7c47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55cf1ccb3643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55cf1d2225fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55cf1ccd396d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55cf1ccc394a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55cf1d518d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55cf1d4e0e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55cf1d4e3678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55cf1c8247cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f54db5bcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f54dd7c47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55cf1ccb3643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55cf1d2264d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55cf1ccd396d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55cf1ccc394a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55cf1d518d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55cf1d4e0e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55cf1d4e3678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55cf1c8247cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f54db5bcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 80 byte(s) in 10 object(s) allocated from:
    #0 0x7f54dd7c47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55cf1ccb34c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55cf1d2225fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55cf1ccd396d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55cf1ccc394a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55cf1d518d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55cf1d4e0e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55cf1d4e3678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55cf1c8247cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f54db5bcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f54dd7c47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55cf1c8a3df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55cf1c8d7f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55cf1c8ec0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55cf1d51824e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55cf1d4e0e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55cf1d4e3678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55cf1c8247cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f54db5bcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f54dd7c47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55cf1c8a3d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55cf1c8d7f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55cf1c8ec0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55cf1d51824e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55cf1d4e0e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55cf1d4e3678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55cf1c8247cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f54db5bcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f54dd7c47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55cf1c8a3d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55cf1c8d7f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55cf1c8ec0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55cf1d51824e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55cf1d4e0e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55cf1d4e3678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55cf1c8247cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f54db5bcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f54dd7c47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55cf1ccb34c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55cf1d2264d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55cf1ccd396d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55cf1ccc394a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55cf1d518d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55cf1d4e0e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55cf1d4e3678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55cf1c8247cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f54db5bcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 1224 byte(s) leaked in 25 allocation(s).
```

## Test case 101_PW_blps_pseudopots

### On process id asan.3236

```bash

=================================================================
==3236==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f0c62c5de8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f0c612450bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 480 byte(s) in 5 object(s) allocated from:
    #0 0x7f0c62c5f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562b1f939643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x562b1fea85fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x562b1f95996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x562b1f94994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x562b2019ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x562b20166e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x562b20169678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x562b1f4aa7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0c60a57d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f0c62c5f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562b1f939643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x562b1feac4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x562b1f95996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x562b1f94994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x562b2019ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x562b20166e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x562b20169678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x562b1f4aa7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0c60a57d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f0c62c5f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562b1f5955df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x562b1f571d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x562b2019e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x562b20166e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x562b20169678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x562b1f4aa7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f0c60a57d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 40 byte(s) in 5 object(s) allocated from:
    #0 0x7f0c62c5f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562b1f9394c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x562b1fea85fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x562b1f95996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x562b1f94994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x562b2019ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x562b20166e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x562b20169678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x562b1f4aa7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0c60a57d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f0c62c5f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562b1f5954e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x562b1f571d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x562b2019e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x562b20166e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x562b20169678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x562b1f4aa7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f0c60a57d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f0c62c5f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562b1f595578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x562b1f571d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x562b2019e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x562b20166e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x562b20169678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x562b1f4aa7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f0c60a57d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f0c62c5f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562b1f9394c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x562b1feac4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x562b1f95996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x562b1f94994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x562b2019ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x562b20166e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x562b20169678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x562b1f4aa7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0c60a57d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f0c62c5de8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f0c6129b94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f0c62c5de8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f0c6129b4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 1800 byte(s) leaked in 20 allocation(s).
```

### On process id asan.3237

```bash

=================================================================
==3237==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 480 byte(s) in 5 object(s) allocated from:
    #0 0x7f92fd1e57a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56520b5ae643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x56520bb1d5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x56520b5ce96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56520b5be94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56520be13d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56520bddbe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56520bdde678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56520b11f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f92fafddd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f92fd1e57a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56520b5ae643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x56520bb214d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x56520b5ce96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56520b5be94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56520be13d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56520bddbe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56520bdde678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56520b11f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f92fafddd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f92fd1e57a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56520b19edf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x56520b1d2f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x56520b1e70b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56520be1324e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x56520bddbe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x56520bdde678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x56520b11f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f92fafddd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 40 byte(s) in 5 object(s) allocated from:
    #0 0x7f92fd1e57a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56520b5ae4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x56520bb1d5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x56520b5ce96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56520b5be94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56520be13d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56520bddbe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56520bdde678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56520b11f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f92fafddd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f92fd1e57a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56520b19ed86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x56520b1d2f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x56520b1e70b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56520be1324e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x56520bddbe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x56520bdde678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x56520b11f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f92fafddd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f92fd1e57a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56520b19ed20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x56520b1d2f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x56520b1e70b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56520be1324e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x56520bddbe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x56520bdde678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x56520b11f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f92fafddd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f92fd1e57a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56520b5ae4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x56520bb214d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x56520b5ce96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56520b5be94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56520be13d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56520bddbe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56520bdde678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56520b11f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f92fafddd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 704 byte(s) leaked in 15 allocation(s).
```

## Test case 101_PW_OU_pseudopots

### On process id asan.3350

```bash

=================================================================
==3350==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7fe3773f87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55da5895cfb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x55da5896ac76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55da5858acf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55da5858e64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55da5858f512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55da5858294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55da58dd7d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55da58d9fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55da58da2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55da580e37cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fe3751f0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7fe3773f6e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fe3759de0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 576 byte(s) in 6 object(s) allocated from:
    #0 0x7fe3773f87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55da58572643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55da58ae15fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55da5859296d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55da5858294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55da58dd7d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55da58d9fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55da58da2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55da580e37cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fe3751f0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7fe3773f87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55da5895d03d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x55da5896ac76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55da5858acf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55da5858e64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55da5858f512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55da5858294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55da58dd7d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55da58d9fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55da58da2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55da580e37cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fe3751f0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7fe3773f87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55da5895d07c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x55da5896ac76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55da5858acf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55da5858e64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55da5858f512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55da5858294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55da58dd7d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55da58d9fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55da58da2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55da580e37cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fe3751f0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fe3773f87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55da58572643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55da58ae54d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55da5859296d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55da5858294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55da58dd7d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55da58d9fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55da58da2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55da580e37cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fe3751f0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fe3773f87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55da581ce5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55da581aad76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55da58dd724e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55da58d9fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55da58da2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55da580e37cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fe3751f0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 6 object(s) allocated from:
    #0 0x7fe3773f87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55da585724c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55da58ae15fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55da5859296d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55da5858294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55da58dd7d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55da58d9fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55da58da2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55da580e37cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fe3751f0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fe3773f87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55da581ce4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55da581aad76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55da58dd724e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55da58d9fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55da58da2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55da580e37cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fe3751f0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fe3773f87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55da581ce578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55da581aad76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55da58dd724e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55da58d9fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55da58da2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55da580e37cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fe3751f0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fe3773f87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55da585724c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55da58ae54d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55da5859296d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55da5858294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55da58dd7d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55da58d9fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55da58da2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55da580e37cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fe3751f0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fe3773f6e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fe375a3494e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fe3773f6e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fe375a344d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 3704 byte(s) leaked in 25 allocation(s).
```

### On process id asan.3351

```bash

=================================================================
==3351==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 576 byte(s) in 6 object(s) allocated from:
    #0 0x7f3d8444e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5583c4c18643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5583c51875fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x5583c4c3896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5583c4c2894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5583c547dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5583c5445e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5583c5448678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5583c47897cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3d82246d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f3d8444e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5583c4c18643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5583c518b4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x5583c4c3896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5583c4c2894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5583c547dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5583c5445e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5583c5448678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5583c47897cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3d82246d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 6 object(s) allocated from:
    #0 0x7f3d8444e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5583c4c184c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5583c51875fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x5583c4c3896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5583c4c2894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5583c547dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5583c5445e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5583c5448678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5583c47897cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3d82246d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f3d8444e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5583c4808df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x5583c483cf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5583c48510b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5583c547d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5583c5445e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5583c5448678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5583c47897cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f3d82246d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f3d8444e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5583c4808d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x5583c483cf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5583c48510b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5583c547d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5583c5445e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5583c5448678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5583c47897cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f3d82246d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f3d8444e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5583c4808d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x5583c483cf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5583c48510b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5583c547d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5583c5445e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5583c5448678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5583c47897cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f3d82246d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f3d8444e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5583c4c184c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5583c518b4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x5583c4c3896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5583c4c2894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5583c547dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5583c5445e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5583c5448678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5583c47897cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3d82246d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 808 byte(s) leaked in 17 allocation(s).
```

## Test case 101_PW_upf201_pseudopots

### On process id asan.3504

```bash

=================================================================
==3504==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f0c52877e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f0c50e5f0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 576 byte(s) in 6 object(s) allocated from:
    #0 0x7f0c528797a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56036903c643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5603695ab5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x56036905c96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56036904c94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5603698a1d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x560369869e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56036986c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560368bad7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0c50671d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f0c528797a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56036903c643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5603695af4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x56036905c96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56036904c94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5603698a1d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x560369869e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56036986c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560368bad7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0c50671d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f0c528797a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560368c985df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x560368c74d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x5603698a124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x560369869e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x56036986c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x560368bad7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f0c50671d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 6 object(s) allocated from:
    #0 0x7f0c528797a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56036903c4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5603695ab5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x56036905c96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56036904c94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5603698a1d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x560369869e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56036986c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560368bad7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0c50671d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f0c528797a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560368c984e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x560368c74d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x5603698a124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x560369869e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x56036986c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x560368bad7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f0c50671d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f0c528797a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560368c98578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x560368c74d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x5603698a124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x560369869e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x56036986c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x560368bad7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f0c50671d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f0c528797a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56036903c4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5603695af4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x56036905c96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56036904c94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5603698a1d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x560369869e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56036986c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560368bad7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0c50671d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f0c52877e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f0c50eb594e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f0c52877e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f0c50eb54d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 1904 byte(s) leaked in 22 allocation(s).
```

### On process id asan.3505

```bash

=================================================================
==3505==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 576 byte(s) in 6 object(s) allocated from:
    #0 0x7f37723847a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557c72d4e643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x557c732bd5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x557c72d6e96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557c72d5e94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557c735b3d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557c7357be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557c7357e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557c728bf7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f377017cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f37723847a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557c72d4e643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x557c732c14d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x557c72d6e96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557c72d5e94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557c735b3d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557c7357be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557c7357e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557c728bf7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f377017cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 6 object(s) allocated from:
    #0 0x7f37723847a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557c72d4e4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x557c732bd5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x557c72d6e96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557c72d5e94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557c735b3d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557c7357be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557c7357e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557c728bf7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f377017cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f37723847a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557c7293edf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x557c72972f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x557c729870b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x557c735b324e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x557c7357be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x557c7357e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x557c728bf7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f377017cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f37723847a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557c7293ed86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x557c72972f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x557c729870b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x557c735b324e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x557c7357be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x557c7357e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x557c728bf7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f377017cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f37723847a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557c7293ed20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x557c72972f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x557c729870b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x557c735b324e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x557c7357be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x557c7357e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x557c728bf7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f377017cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f37723847a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557c72d4e4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x557c732c14d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x557c72d6e96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557c72d5e94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557c735b3d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557c7357be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557c7357e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557c728bf7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f377017cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 808 byte(s) leaked in 17 allocation(s).
```

## Test case 101_PW_VW_pseudopots

### On process id asan.3618

```bash

=================================================================
==3618==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f52a19e4e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f529ffcc0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 576 byte(s) in 6 object(s) allocated from:
    #0 0x7f52a19e67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fe04647643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55fe04bb65fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55fe0466796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fe0465794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fe04eacd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fe04e74e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fe04e77678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fe041b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f529f7ded09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f52a19e67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fe04647643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55fe04bba4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55fe0466796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fe0465794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fe04eacd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fe04e74e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fe04e77678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fe041b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f529f7ded09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f52a19e67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fe042a35df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55fe0427fd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55fe04eac24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55fe04e74e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55fe04e77678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55fe041b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f529f7ded09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 6 object(s) allocated from:
    #0 0x7f52a19e67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fe046474c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55fe04bb65fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55fe0466796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fe0465794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fe04eacd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fe04e74e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fe04e77678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fe041b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f529f7ded09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f52a19e67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fe042a34e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55fe0427fd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55fe04eac24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55fe04e74e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55fe04e77678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55fe041b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f529f7ded09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f52a19e67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fe042a3578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55fe0427fd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55fe04eac24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55fe04e74e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55fe04e77678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55fe041b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f529f7ded09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f52a19e67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fe046474c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55fe04bba4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55fe0466796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fe0465794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fe04eacd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fe04e74e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fe04e77678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fe041b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f529f7ded09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f52a19e4e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f52a002294e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f52a19e4e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f52a00224d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 1904 byte(s) leaked in 22 allocation(s).
```

### On process id asan.3619

```bash

=================================================================
==3619==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 576 byte(s) in 6 object(s) allocated from:
    #0 0x7fba1cefb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55dce0064643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55dce05d35fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55dce008496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55dce007494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55dce08c9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55dce0891e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55dce0894678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55dcdfbd57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fba1acf3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fba1cefb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55dce0064643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55dce05d74d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55dce008496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55dce007494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55dce08c9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55dce0891e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55dce0894678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55dcdfbd57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fba1acf3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 6 object(s) allocated from:
    #0 0x7fba1cefb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55dce00644c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55dce05d35fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55dce008496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55dce007494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55dce08c9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55dce0891e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55dce0894678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55dcdfbd57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fba1acf3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fba1cefb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55dcdfc54df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55dcdfc88f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55dcdfc9d0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55dce08c924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55dce0891e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55dce0894678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55dcdfbd57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fba1acf3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fba1cefb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55dcdfc54d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55dcdfc88f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55dcdfc9d0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55dce08c924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55dce0891e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55dce0894678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55dcdfbd57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fba1acf3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fba1cefb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55dcdfc54d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55dcdfc88f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55dcdfc9d0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55dce08c924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55dce0891e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55dce0894678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55dcdfbd57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fba1acf3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fba1cefb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55dce00644c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55dce05d74d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55dce008496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55dce007494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55dce08c9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55dce0891e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55dce0894678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55dcdfbd57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fba1acf3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 808 byte(s) leaked in 17 allocation(s).
```

## Test case 102_PW_DA_davidson

### On process id asan.3732

```bash

=================================================================
==3732==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1248 byte(s) in 13 object(s) allocated from:
    #0 0x7f4a0ecf07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f6d3f1c643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55f6d448b5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55f6d3f3c96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55f6d3f2c94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55f6d4781d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55f6d4749e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55f6d474c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55f6d3a8d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f4a0cae8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f4a0eceee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f4a0d2d60bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 104 byte(s) in 13 object(s) allocated from:
    #0 0x7f4a0ecf07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f6d3f1c4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55f6d448b5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55f6d3f3c96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55f6d3f2c94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55f6d4781d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55f6d4749e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55f6d474c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55f6d3a8d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f4a0cae8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f4a0ecf07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f6d3f1c643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55f6d448f4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55f6d3f3c96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55f6d3f2c94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55f6d4781d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55f6d4749e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55f6d474c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55f6d3a8d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f4a0cae8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f4a0ecf07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f6d3b785df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55f6d3b54d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55f6d478124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55f6d4749e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55f6d474c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55f6d3a8d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f4a0cae8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f4a0ecf07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f6d3b784e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55f6d3b54d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55f6d478124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55f6d4749e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55f6d474c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55f6d3a8d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f4a0cae8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f4a0ecf07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f6d3b78578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55f6d3b54d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55f6d478124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55f6d4749e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55f6d474c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55f6d3a8d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f4a0cae8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f4a0ecf07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f6d3f1c4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55f6d448f4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55f6d3f3c96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55f6d3f2c94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55f6d4781d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55f6d4749e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55f6d474c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55f6d3a8d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f4a0cae8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f4a0eceee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f4a0d32c94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f4a0eceee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f4a0d32c4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 2632 byte(s) leaked in 36 allocation(s).
```

### On process id asan.3733

```bash

=================================================================
==3733==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1248 byte(s) in 13 object(s) allocated from:
    #0 0x7f9dac8477a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fea0436643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55fea09a55fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55fea045696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fea044694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fea0c9bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fea0c63e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fea0c66678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fe9ffa77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9daa63fd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 104 byte(s) in 13 object(s) allocated from:
    #0 0x7f9dac8477a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fea04364c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55fea09a55fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55fea045696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fea044694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fea0c9bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fea0c63e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fea0c66678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fe9ffa77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9daa63fd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f9dac8477a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fea0436643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55fea09a94d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55fea045696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fea044694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fea0c9bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fea0c63e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fea0c66678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fe9ffa77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9daa63fd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f9dac8477a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fea0026df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55fea005af76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55fea006f0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55fea0c9b24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55fea0c63e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55fea0c66678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55fe9ffa77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f9daa63fd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f9dac8477a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fea0026d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55fea005af76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55fea006f0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55fea0c9b24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55fea0c63e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55fea0c66678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55fe9ffa77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f9daa63fd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f9dac8477a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fea0026d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55fea005af76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55fea006f0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55fea0c9b24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55fea0c63e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55fea0c66678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55fe9ffa77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f9daa63fd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9dac8477a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fea04364c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55fea09a94d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55fea045696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fea044694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fea0c9bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fea0c63e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fea0c66678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fe9ffa77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9daa63fd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 1536 byte(s) leaked in 31 allocation(s).
```

## Test case 103_PW_15_CS_CF

### On process id asan.3846

```bash

=================================================================
==3846==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1344 byte(s) in 14 object(s) allocated from:
    #0 0x7fc08d8867a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ffd8033643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55ffd85a25fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55ffd805396d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ffd804394a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ffd8898d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ffd8860e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ffd8863678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ffd7ba47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc08b67ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7fc08d8867a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ffd841dfb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x55ffd842bc76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55ffd804bcf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55ffd804f64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55ffd8050512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55ffd804394a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55ffd8898d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55ffd8860e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55ffd8863678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55ffd7ba47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fc08b67ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7fc08d884e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fc08be6c0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7fc08d8867a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ffd841e03d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x55ffd842bc76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55ffd804bcf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55ffd804f64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55ffd8050512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55ffd804394a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55ffd8898d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55ffd8860e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55ffd8863678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55ffd7ba47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fc08b67ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7fc08d8867a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ffd841e07c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x55ffd842bc76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55ffd804bcf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55ffd804f64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55ffd8050512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55ffd804394a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55ffd8898d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55ffd8860e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55ffd8863678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55ffd7ba47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fc08b67ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 112 byte(s) in 14 object(s) allocated from:
    #0 0x7fc08d8867a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ffd80334c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55ffd85a25fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55ffd805396d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ffd804394a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ffd8898d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ffd8860e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ffd8863678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ffd7ba47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc08b67ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fc08d8867a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ffd8033643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55ffd85a64d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55ffd805396d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ffd804394a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ffd8898d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ffd8860e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ffd8863678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ffd7ba47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc08b67ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7fc08d8867a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ffd7c8f5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55ffd7c6bd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55ffd889824e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55ffd8860e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55ffd8863678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55ffd7ba47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fc08b67ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fc08d8867a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ffd7c8f4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55ffd7c6bd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55ffd889824e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55ffd8860e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55ffd8863678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55ffd7ba47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fc08b67ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fc08d8867a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ffd7c8f578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55ffd7c6bd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55ffd889824e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55ffd8860e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55ffd8863678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55ffd7ba47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fc08b67ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fc08d8867a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ffd80334c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55ffd85a64d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55ffd805396d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ffd804394a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ffd8898d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ffd8860e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ffd8863678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ffd7ba47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc08b67ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fc08d884e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fc08bec294e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fc08d884e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fc08bec24d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 4536 byte(s) leaked in 44 allocation(s).
```

### On process id asan.3847

```bash

=================================================================
==3847==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1344 byte(s) in 14 object(s) allocated from:
    #0 0x7fa37d60b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559bbaec9643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x559bbb4385fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x559bbaee996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x559bbaed994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x559bbb72ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x559bbb6f6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x559bbb6f9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x559bbaa3a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fa37b403d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 112 byte(s) in 14 object(s) allocated from:
    #0 0x7fa37d60b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559bbaec94c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x559bbb4385fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x559bbaee996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x559bbaed994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x559bbb72ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x559bbb6f6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x559bbb6f9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x559bbaa3a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fa37b403d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fa37d60b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559bbaec9643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x559bbb43c4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x559bbaee996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x559bbaed994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x559bbb72ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x559bbb6f6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x559bbb6f9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x559bbaa3a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fa37b403d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7fa37d60b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559bbaab9df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x559bbaaedf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x559bbab020b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x559bbb72e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x559bbb6f6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x559bbb6f9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x559bbaa3a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fa37b403d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fa37d60b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559bbaab9d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x559bbaaedf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x559bbab020b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x559bbb72e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x559bbb6f6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x559bbb6f9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x559bbaa3a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fa37b403d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fa37d60b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559bbaab9d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x559bbaaedf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x559bbab020b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x559bbb72e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x559bbb6f6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x559bbb6f9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x559bbaa3a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fa37b403d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fa37d60b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559bbaec94c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x559bbb43c4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x559bbaee996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x559bbaed994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x559bbb72ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x559bbb6f6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x559bbb6f9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x559bbaa3a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fa37b403d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 1640 byte(s) leaked in 36 allocation(s).
```

## Test case 103_PW_15_CS_CF_bspline

### On process id asan.4044

```bash

=================================================================
==4044==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1344 byte(s) in 14 object(s) allocated from:
    #0 0x7f5980adb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d164ac1643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55d1650305fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55d164ae196d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55d164ad194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55d165326d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55d1652eee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d1652f1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d1646327cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f597e8d3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7f5980adb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d164eabfb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x55d164eb9c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55d164ad9cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55d164add64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55d164ade512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55d164ad194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55d165326d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55d1652eee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55d1652f1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55d1646327cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f597e8d3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f5980ad9e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f597f0c10bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7f5980adb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d164eac03d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x55d164eb9c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55d164ad9cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55d164add64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55d164ade512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55d164ad194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55d165326d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55d1652eee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55d1652f1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55d1646327cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f597e8d3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7f5980adb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d164eac07c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x55d164eb9c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55d164ad9cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55d164add64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55d164ade512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55d164ad194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55d165326d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55d1652eee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55d1652f1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55d1646327cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f597e8d3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 112 byte(s) in 14 object(s) allocated from:
    #0 0x7f5980adb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d164ac14c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55d1650305fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55d164ae196d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55d164ad194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55d165326d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55d1652eee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d1652f1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d1646327cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f597e8d3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f5980adb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d164ac1643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55d1650344d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55d164ae196d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55d164ad194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55d165326d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55d1652eee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d1652f1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d1646327cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f597e8d3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7f5980adb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d16471d5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55d1646f9d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55d16532624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55d1652eee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55d1652f1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55d1646327cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f597e8d3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f5980adb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d16471d4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55d1646f9d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55d16532624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55d1652eee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55d1652f1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55d1646327cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f597e8d3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f5980adb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d16471d578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55d1646f9d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55d16532624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55d1652eee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55d1652f1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55d1646327cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f597e8d3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f5980adb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d164ac14c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55d1650344d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55d164ae196d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55d164ad194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55d165326d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55d1652eee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d1652f1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d1646327cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f597e8d3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f5980ad9e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f597f11794e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f5980ad9e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f597f1174d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 4536 byte(s) leaked in 44 allocation(s).
```

### On process id asan.4045

```bash

=================================================================
==4045==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1344 byte(s) in 14 object(s) allocated from:
    #0 0x7f06a08d97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x558e3b21f643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x558e3b78e5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x558e3b23f96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x558e3b22f94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x558e3ba84d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x558e3ba4ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x558e3ba4f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x558e3ad907cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f069e6d1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 112 byte(s) in 14 object(s) allocated from:
    #0 0x7f06a08d97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x558e3b21f4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x558e3b78e5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x558e3b23f96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x558e3b22f94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x558e3ba84d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x558e3ba4ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x558e3ba4f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x558e3ad907cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f069e6d1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f06a08d97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x558e3b21f643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x558e3b7924d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x558e3b23f96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x558e3b22f94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x558e3ba84d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x558e3ba4ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x558e3ba4f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x558e3ad907cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f069e6d1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7f06a08d97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x558e3ae0fdf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x558e3ae43f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x558e3ae580b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x558e3ba8424e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x558e3ba4ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x558e3ba4f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x558e3ad907cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f069e6d1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f06a08d97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x558e3ae0fd86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x558e3ae43f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x558e3ae580b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x558e3ba8424e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x558e3ba4ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x558e3ba4f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x558e3ad907cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f069e6d1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f06a08d97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x558e3ae0fd20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x558e3ae43f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x558e3ae580b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x558e3ba8424e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x558e3ba4ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x558e3ba4f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x558e3ad907cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f069e6d1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f06a08d97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x558e3b21f4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x558e3b7924d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x558e3b23f96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x558e3b22f94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x558e3ba84d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x558e3ba4ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x558e3ba4f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x558e3ad907cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f069e6d1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 1640 byte(s) leaked in 36 allocation(s).
```

## Test case 103_PW_CF_CS_S1_smallg

### On process id asan.4214

```bash

=================================================================
==4214==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7fa4417807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c4c156bfb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x55c4c1579c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55c4c1199cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55c4c119d64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55c4c119e512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55c4c119194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55c4c19e6d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55c4c19aee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55c4c19b1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55c4c0cf27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fa43f578d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7fa44177ee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fa43fd660bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 1080 byte(s) in 9 object(s) allocated from:
    #0 0x7fa4417807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c4c1181643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55c4c16f05fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55c4c11a196d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c4c119194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c4c19e6d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c4c19aee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c4c19b1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c4c0cf27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fa43f578d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7fa4417807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c4c156c03d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x55c4c1579c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55c4c1199cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55c4c119d64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55c4c119e512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55c4c119194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55c4c19e6d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55c4c19aee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55c4c19b1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55c4c0cf27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fa43f578d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7fa4417807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c4c156c07c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x55c4c1579c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55c4c1199cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55c4c119d64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55c4c119e512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55c4c119194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55c4c19e6d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55c4c19aee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55c4c19b1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55c4c0cf27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fa43f578d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 120 byte(s) in 1 object(s) allocated from:
    #0 0x7fa4417807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c4c1181643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55c4c16f44d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55c4c11a196d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c4c119194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c4c19e6d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c4c19aee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c4c19b1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c4c0cf27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fa43f578d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 2 object(s) allocated from:
    #0 0x7fa4417807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c4c0ddd5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55c4c0db9d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55c4c19e624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55c4c19aee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55c4c19b1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55c4c0cf27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fa43f578d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 9 object(s) allocated from:
    #0 0x7fa4417807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c4c11814c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55c4c16f05fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55c4c11a196d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c4c119194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c4c19e6d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c4c19aee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c4c19b1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c4c0cf27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fa43f578d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 2 object(s) allocated from:
    #0 0x7fa4417807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c4c0ddd4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55c4c0db9d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55c4c19e624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55c4c19aee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55c4c19b1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55c4c0cf27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fa43f578d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 2 object(s) allocated from:
    #0 0x7fa4417807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c4c0ddd578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55c4c0db9d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55c4c19e624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55c4c19aee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55c4c19b1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55c4c0cf27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fa43f578d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fa4417807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c4c11814c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55c4c16f44d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55c4c11a196d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c4c119194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c4c19e6d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c4c19aee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c4c19b1678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c4c0cf27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fa43f578d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fa44177ee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fa43fdbc94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fa44177ee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fa43fdbc4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 4296 byte(s) leaked in 34 allocation(s).
```

### On process id asan.4215

```bash

=================================================================
==4215==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 9 object(s) allocated from:
    #0 0x7fd58a6fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ae964f8643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55ae96a675fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55ae9651896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ae9650894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ae96d5dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ae96d25e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ae96d28678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ae960697cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd5884f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 120 byte(s) in 1 object(s) allocated from:
    #0 0x7fd58a6fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ae964f8643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55ae96a6b4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55ae9651896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ae9650894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ae96d5dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ae96d25e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ae96d28678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ae960697cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd5884f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 9 object(s) allocated from:
    #0 0x7fd58a6fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ae964f84c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55ae96a675fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55ae9651896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ae9650894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ae96d5dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ae96d25e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ae96d28678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ae960697cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd5884f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 2 object(s) allocated from:
    #0 0x7fd58a6fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ae960e8df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55ae9611cf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55ae961310b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55ae96d5d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55ae96d25e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55ae96d28678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55ae960697cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fd5884f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 2 object(s) allocated from:
    #0 0x7fd58a6fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ae960e8d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55ae9611cf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55ae961310b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55ae96d5d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55ae96d25e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55ae96d28678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55ae960697cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fd5884f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 2 object(s) allocated from:
    #0 0x7fd58a6fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ae960e8d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55ae9611cf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55ae961310b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55ae96d5d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55ae96d25e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55ae96d28678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55ae960697cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fd5884f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fd58a6fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ae964f84c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55ae96a6b4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55ae9651896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ae9650894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ae96d5dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ae96d25e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ae96d28678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ae960697cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd5884f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 1400 byte(s) leaked in 26 allocation(s).
```

## Test case 103_PW_15_CF_CS_S1_smallg

### On process id asan.4423

```bash

=================================================================
==4423==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 4096 byte(s) in 16 object(s) allocated from:
    #0 0x7f1998ba37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f8ee9b8643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55f8eef275fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55f8ee9d896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55f8ee9c894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55f8ef21dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55f8ef1e5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55f8ef1e8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55f8ee5297cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f199699bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7f1998ba37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f8eeda2fb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x55f8eedb0c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55f8ee9d0cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55f8ee9d464e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55f8ee9d5512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55f8ee9c894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55f8ef21dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55f8ef1e5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55f8ef1e8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55f8ee5297cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f199699bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f1998ba1e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f19971890bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7f1998ba37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f8eeda303d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x55f8eedb0c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55f8ee9d0cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55f8ee9d464e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55f8ee9d5512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55f8ee9c894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55f8ef21dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55f8ef1e5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55f8ef1e8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55f8ee5297cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f199699bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 256 byte(s) in 1 object(s) allocated from:
    #0 0x7f1998ba37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f8ee9b8643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55f8eef2b4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55f8ee9d896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55f8ee9c894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55f8ef21dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55f8ef1e5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55f8ef1e8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55f8ee5297cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f199699bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7f1998ba37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f8eeda307c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x55f8eedb0c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55f8ee9d0cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55f8ee9d464e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55f8ee9d5512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55f8ee9c894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55f8ef21dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55f8ef1e5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55f8ef1e8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55f8ee5297cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f199699bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 128 byte(s) in 16 object(s) allocated from:
    #0 0x7f1998ba37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f8ee9b84c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55f8eef275fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55f8ee9d896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55f8ee9c894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55f8ef21dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55f8ef1e5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55f8ef1e8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55f8ee5297cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f199699bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 2 object(s) allocated from:
    #0 0x7f1998ba37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f8ee6145df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55f8ee5f0d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55f8ef21d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55f8ef1e5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55f8ef1e8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55f8ee5297cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f199699bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 2 object(s) allocated from:
    #0 0x7f1998ba37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f8ee614578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55f8ee5f0d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55f8ef21d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55f8ef1e5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55f8ef1e8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55f8ee5297cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f199699bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 2 object(s) allocated from:
    #0 0x7f1998ba37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f8ee6144e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55f8ee5f0d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55f8ef21d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55f8ef1e5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55f8ef1e8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55f8ee5297cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f199699bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f1998ba37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f8ee9b84c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55f8eef2b4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55f8ee9d896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55f8ee9c894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55f8ef21dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55f8ef1e5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55f8ef1e8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55f8ee5297cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f199699bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f1998ba1e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f19971df94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f1998ba1e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f19971df4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 7504 byte(s) leaked in 48 allocation(s).
```

### On process id asan.4424

```bash

=================================================================
==4424==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 4096 byte(s) in 16 object(s) allocated from:
    #0 0x7f442feb57a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55df9c1bf643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55df9c72e5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55df9c1df96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55df9c1cf94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55df9ca24d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55df9c9ece39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55df9c9ef678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55df9bd307cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f442dcadd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 256 byte(s) in 1 object(s) allocated from:
    #0 0x7f442feb57a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55df9c1bf643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55df9c7324d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55df9c1df96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55df9c1cf94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55df9ca24d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55df9c9ece39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55df9c9ef678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55df9bd307cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f442dcadd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 128 byte(s) in 16 object(s) allocated from:
    #0 0x7f442feb57a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55df9c1bf4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55df9c72e5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55df9c1df96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55df9c1cf94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55df9ca24d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55df9c9ece39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55df9c9ef678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55df9bd307cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f442dcadd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 2 object(s) allocated from:
    #0 0x7f442feb57a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55df9bdafdf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55df9bde3f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55df9bdf80b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55df9ca2424e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55df9c9ece39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55df9c9ef678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55df9bd307cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f442dcadd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 2 object(s) allocated from:
    #0 0x7f442feb57a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55df9bdafd86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55df9bde3f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55df9bdf80b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55df9ca2424e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55df9c9ece39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55df9c9ef678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55df9bd307cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f442dcadd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 2 object(s) allocated from:
    #0 0x7f442feb57a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55df9bdafd20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55df9bde3f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55df9bdf80b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55df9ca2424e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55df9c9ece39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55df9c9ef678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55df9bd307cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f442dcadd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f442feb57a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55df9c1bf4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55df9c7324d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55df9c1df96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55df9c1cf94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55df9ca24d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55df9c9ece39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55df9c9ef678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55df9bd307cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f442dcadd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 4608 byte(s) leaked in 40 allocation(s).
```

## Test case 103_PW_CF_CS_S2_smallg

### On process id asan.4632

```bash

=================================================================
==4632==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 2160 byte(s) in 18 object(s) allocated from:
    #0 0x7fcd4a15e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e3a9e46643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55e3aa3b55fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55e3a9e6696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e3a9e5694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e3aa6abd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e3aa673e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e3aa676678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e3a99b77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fcd47f56d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7fcd4a15e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e3aa230fb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x55e3aa23ec76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55e3a9e5ecf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55e3a9e6264e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55e3a9e63512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55e3a9e5694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55e3aa6abd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55e3aa673e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55e3aa676678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55e3a99b77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fcd47f56d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7fcd4a15ce8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fcd487440bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7fcd4a15e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e3aa23103d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x55e3aa23ec76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55e3a9e5ecf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55e3a9e6264e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55e3a9e63512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55e3a9e5694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55e3aa6abd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55e3aa673e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55e3aa676678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55e3a99b77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fcd47f56d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 240 byte(s) in 2 object(s) allocated from:
    #0 0x7fcd4a15e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e3a9e46643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55e3aa3b94d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55e3a9e6696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e3a9e5694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e3aa6abd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e3aa673e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e3aa676678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e3a99b77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fcd47f56d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7fcd4a15e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e3aa23107c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x55e3aa23ec76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55e3a9e5ecf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55e3a9e6264e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55e3a9e63512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55e3a9e5694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55e3aa6abd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55e3aa673e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55e3aa676678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55e3a99b77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fcd47f56d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 144 byte(s) in 18 object(s) allocated from:
    #0 0x7fcd4a15e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e3a9e464c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55e3aa3b55fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55e3a9e6696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e3a9e5694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e3aa6abd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e3aa673e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e3aa676678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e3a99b77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fcd47f56d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 2 object(s) allocated from:
    #0 0x7fcd4a15e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e3a9aa25df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55e3a9a7ed76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55e3aa6ab24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55e3aa673e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55e3aa676678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55e3a99b77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fcd47f56d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 2 object(s) allocated from:
    #0 0x7fcd4a15e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e3a9aa24e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55e3a9a7ed76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55e3aa6ab24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55e3aa673e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55e3aa676678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55e3a99b77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fcd47f56d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 2 object(s) allocated from:
    #0 0x7fcd4a15e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e3a9aa2578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55e3a9a7ed76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55e3aa6ab24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55e3aa673e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55e3aa676678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55e3a99b77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fcd47f56d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fcd4a15e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e3a9e464c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55e3aa3b94d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55e3a9e6696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e3a9e5694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e3aa6abd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e3aa673e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e3aa676678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e3a99b77cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fcd47f56d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fcd4a15ce8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fcd4879a94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fcd4a15ce8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fcd4879a4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 5576 byte(s) leaked in 54 allocation(s).
```

### On process id asan.4633

```bash

=================================================================
==4633==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 2160 byte(s) in 18 object(s) allocated from:
    #0 0x7effab8c77a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f4a6fa6643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55f4a75155fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55f4a6fc696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55f4a6fb694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55f4a780bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55f4a77d3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55f4a77d6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55f4a6b177cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7effa96bfd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 240 byte(s) in 2 object(s) allocated from:
    #0 0x7effab8c77a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f4a6fa6643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55f4a75194d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55f4a6fc696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55f4a6fb694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55f4a780bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55f4a77d3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55f4a77d6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55f4a6b177cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7effa96bfd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 144 byte(s) in 18 object(s) allocated from:
    #0 0x7effab8c77a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f4a6fa64c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55f4a75155fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55f4a6fc696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55f4a6fb694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55f4a780bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55f4a77d3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55f4a77d6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55f4a6b177cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7effa96bfd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 2 object(s) allocated from:
    #0 0x7effab8c77a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f4a6b96df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55f4a6bcaf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55f4a6bdf0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55f4a780b24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55f4a77d3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55f4a77d6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55f4a6b177cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7effa96bfd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 2 object(s) allocated from:
    #0 0x7effab8c77a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f4a6b96d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55f4a6bcaf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55f4a6bdf0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55f4a780b24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55f4a77d3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55f4a77d6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55f4a6b177cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7effa96bfd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 2 object(s) allocated from:
    #0 0x7effab8c77a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f4a6b96d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55f4a6bcaf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55f4a6bdf0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55f4a780b24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55f4a77d3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55f4a77d6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55f4a6b177cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7effa96bfd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7effab8c77a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f4a6fa64c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55f4a75194d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55f4a6fc696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55f4a6fb694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55f4a780bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55f4a77d3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55f4a77d6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55f4a6b177cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7effa96bfd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 2680 byte(s) leaked in 46 allocation(s).
```

## Test case 103_PW_15_CF_CS_S2_smallg

### On process id asan.4841

```bash

=================================================================
==4841==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 8192 byte(s) in 32 object(s) allocated from:
    #0 0x7fd8252fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d9b5224643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55d9b57935fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55d9b524496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55d9b523494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55d9b5a89d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55d9b5a51e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d9b5a54678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d9b4d957cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd8230f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7fd8252fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d9b560efb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x55d9b561cc76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55d9b523ccf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55d9b524064e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55d9b5241512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55d9b523494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55d9b5a89d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55d9b5a51e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55d9b5a54678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55d9b4d957cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fd8230f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7fd8252f9e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fd8238e10bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 512 byte(s) in 2 object(s) allocated from:
    #0 0x7fd8252fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d9b5224643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55d9b57974d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55d9b524496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55d9b523494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55d9b5a89d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55d9b5a51e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d9b5a54678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d9b4d957cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd8230f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7fd8252fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d9b560f03d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x55d9b561cc76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55d9b523ccf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55d9b524064e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55d9b5241512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55d9b523494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55d9b5a89d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55d9b5a51e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55d9b5a54678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55d9b4d957cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fd8230f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 256 byte(s) in 32 object(s) allocated from:
    #0 0x7fd8252fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d9b52244c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55d9b57935fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55d9b524496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55d9b523494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55d9b5a89d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55d9b5a51e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d9b5a54678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d9b4d957cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd8230f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7fd8252fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d9b560f07c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x55d9b561cc76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55d9b523ccf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55d9b524064e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55d9b5241512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55d9b523494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55d9b5a89d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55d9b5a51e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55d9b5a54678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55d9b4d957cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fd8230f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 2 object(s) allocated from:
    #0 0x7fd8252fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d9b4e805df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55d9b4e5cd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55d9b5a8924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55d9b5a51e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55d9b5a54678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55d9b4d957cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fd8230f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 2 object(s) allocated from:
    #0 0x7fd8252fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d9b4e80578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55d9b4e5cd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55d9b5a8924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55d9b5a51e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55d9b5a54678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55d9b4d957cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fd8230f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 2 object(s) allocated from:
    #0 0x7fd8252fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d9b4e804e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55d9b4e5cd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55d9b5a8924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55d9b5a51e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55d9b5a54678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55d9b4d957cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fd8230f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fd8252fb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d9b52244c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55d9b57974d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55d9b524496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55d9b523494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55d9b5a89d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55d9b5a51e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d9b5a54678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d9b4d957cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd8230f3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fd8252f9e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fd82393794e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fd8252f9e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fd8239374d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 11992 byte(s) leaked in 82 allocation(s).
```

### On process id asan.4842

```bash

=================================================================
==4842==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 8192 byte(s) in 32 object(s) allocated from:
    #0 0x7fdba45ee7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5638d4869643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5638d4dd85fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x5638d488996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5638d487994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5638d50ced1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5638d5096e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5638d5099678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5638d43da7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fdba23e6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 512 byte(s) in 2 object(s) allocated from:
    #0 0x7fdba45ee7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5638d4869643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5638d4ddc4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x5638d488996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5638d487994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5638d50ced1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5638d5096e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5638d5099678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5638d43da7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fdba23e6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 256 byte(s) in 32 object(s) allocated from:
    #0 0x7fdba45ee7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5638d48694c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5638d4dd85fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x5638d488996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5638d487994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5638d50ced1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5638d5096e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5638d5099678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5638d43da7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fdba23e6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 2 object(s) allocated from:
    #0 0x7fdba45ee7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5638d4459df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x5638d448df76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5638d44a20b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5638d50ce24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5638d5096e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5638d5099678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5638d43da7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fdba23e6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 2 object(s) allocated from:
    #0 0x7fdba45ee7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5638d4459d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x5638d448df76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5638d44a20b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5638d50ce24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5638d5096e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5638d5099678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5638d43da7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fdba23e6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 2 object(s) allocated from:
    #0 0x7fdba45ee7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5638d4459d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x5638d448df76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5638d44a20b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5638d50ce24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5638d5096e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5638d5099678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5638d43da7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fdba23e6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fdba45ee7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5638d48694c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5638d4ddc4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x5638d488996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5638d487994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5638d50ced1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5638d5096e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5638d5099678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5638d43da7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fdba23e6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 9096 byte(s) leaked in 74 allocation(s).
```

## Test case 103_PW_OU_CS_CF

### On process id asan.5050

```bash

=================================================================
==5050==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1248 byte(s) in 13 object(s) allocated from:
    #0 0x7f80c25d37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b6338e2643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55b633e515fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55b63390296d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b6338f294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b634147d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b63410fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b634112678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b6334537cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f80c03cbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7f80c25d37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b633cccfb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x55b633cdac76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55b6338facf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55b6338fe64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55b6338ff512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55b6338f294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55b634147d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55b63410fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55b634112678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55b6334537cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f80c03cbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f80c25d1e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f80c0bb90bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7f80c25d37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b633ccd03d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x55b633cdac76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55b6338facf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55b6338fe64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55b6338ff512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55b6338f294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55b634147d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55b63410fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55b634112678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55b6334537cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f80c03cbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7f80c25d37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b633ccd07c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x55b633cdac76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55b6338facf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55b6338fe64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55b6338ff512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55b6338f294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55b634147d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55b63410fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55b634112678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55b6334537cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f80c03cbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 104 byte(s) in 13 object(s) allocated from:
    #0 0x7f80c25d37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b6338e24c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55b633e515fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55b63390296d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b6338f294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b634147d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b63410fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b634112678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b6334537cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f80c03cbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f80c25d37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b6338e2643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55b633e554d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55b63390296d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b6338f294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b634147d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b63410fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b634112678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b6334537cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f80c03cbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7f80c25d37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b63353e5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55b63351ad76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55b63414724e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55b63410fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55b634112678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55b6334537cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f80c03cbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f80c25d37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b63353e4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55b63351ad76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55b63414724e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55b63410fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55b634112678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55b6334537cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f80c03cbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f80c25d37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b63353e578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55b63351ad76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55b63414724e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55b63410fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55b634112678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55b6334537cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f80c03cbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f80c25d37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b6338e24c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55b633e554d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55b63390296d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b6338f294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b634147d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b63410fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b634112678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b6334537cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f80c03cbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f80c25d1e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f80c0c0f94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f80c25d1e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f80c0c0f4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 4432 byte(s) leaked in 42 allocation(s).
```

### On process id asan.5051

```bash

=================================================================
==5051==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1248 byte(s) in 13 object(s) allocated from:
    #0 0x7fdfcbd1c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c252420643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55c25298f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55c25244096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c25243094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c252c85d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c252c4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c252c50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c251f917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fdfc9b14d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 104 byte(s) in 13 object(s) allocated from:
    #0 0x7fdfcbd1c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c2524204c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55c25298f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55c25244096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c25243094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c252c85d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c252c4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c252c50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c251f917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fdfc9b14d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fdfcbd1c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c252420643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55c2529934d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55c25244096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c25243094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c252c85d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c252c4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c252c50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c251f917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fdfc9b14d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7fdfcbd1c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c252010df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55c252044f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55c2520590b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55c252c8524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55c252c4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55c252c50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55c251f917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fdfc9b14d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fdfcbd1c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c252010d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55c252044f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55c2520590b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55c252c8524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55c252c4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55c252c50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55c251f917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fdfc9b14d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fdfcbd1c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c252010d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55c252044f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55c2520590b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55c252c8524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55c252c4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55c252c50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55c251f917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fdfc9b14d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fdfcbd1c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c2524204c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55c2529934d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55c25244096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c25243094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c252c85d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c252c4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c252c50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c251f917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fdfc9b14d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 1536 byte(s) leaked in 34 allocation(s).
```

## Test case 104_PW_AF_magnetic

### On process id asan.5249

```bash

=================================================================
==5249==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 2160 byte(s) in 36 object(s) allocated from:
    #0 0x7f0c272c27a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556d79996643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x556d79f055fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x556d799b696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x556d799a694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x556d7a1fbd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x556d7a1c3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x556d7a1c6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x556d795077cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0c250bad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f0c272c0e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f0c258a80bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 288 byte(s) in 36 object(s) allocated from:
    #0 0x7f0c272c27a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556d799964c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x556d79f055fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x556d799b696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x556d799a694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x556d7a1fbd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x556d7a1c3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x556d7a1c6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x556d795077cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0c250bad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 120 byte(s) in 2 object(s) allocated from:
    #0 0x7f0c272c27a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556d79996643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x556d79f094d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x556d799b696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x556d799a694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x556d7a1fbd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x556d7a1c3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x556d7a1c6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x556d795077cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0c250bad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7f0c272c27a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556d795f25df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x556d795ced76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x556d7a1fb24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x556d7a1c3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x556d7a1c6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x556d795077cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f0c250bad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f0c272c27a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556d799964c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x556d79f094d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x556d799b696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x556d799a694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x556d7a1fbd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x556d7a1c3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x556d7a1c6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x556d795077cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0c250bad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f0c272c27a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556d795f24e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x556d795ced76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x556d7a1fb24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x556d7a1c3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x556d7a1c6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x556d795077cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f0c250bad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f0c272c27a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556d795f2578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x556d795ced76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x556d7a1fb24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x556d7a1c3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x556d7a1c6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x556d795077cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f0c250bad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f0c272c0e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f0c258fe94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f0c272c0e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f0c258fe4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 3760 byte(s) leaked in 87 allocation(s).
```

### On process id asan.5250

```bash

=================================================================
==5250==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 2160 byte(s) in 36 object(s) allocated from:
    #0 0x7f143ca717a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c8c6c94643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55c8c72035fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55c8c6cb496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c8c6ca494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c8c74f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c8c74c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c8c74c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c8c68057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f143a869d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 288 byte(s) in 36 object(s) allocated from:
    #0 0x7f143ca717a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c8c6c944c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55c8c72035fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55c8c6cb496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c8c6ca494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c8c74f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c8c74c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c8c74c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c8c68057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f143a869d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 120 byte(s) in 2 object(s) allocated from:
    #0 0x7f143ca717a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c8c6c94643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55c8c72074d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55c8c6cb496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c8c6ca494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c8c74f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c8c74c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c8c74c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c8c68057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f143a869d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7f143ca717a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c8c6884df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55c8c68b8f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55c8c68cd0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55c8c74f924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55c8c74c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55c8c74c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55c8c68057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f143a869d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f143ca717a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c8c6c944c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55c8c72074d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55c8c6cb496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c8c6ca494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c8c74f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c8c74c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c8c74c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c8c68057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f143a869d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f143ca717a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c8c6884d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55c8c68b8f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55c8c68cd0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55c8c74f924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55c8c74c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55c8c74c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55c8c68057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f143a869d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f143ca717a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c8c6884d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55c8c68b8f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55c8c68cd0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55c8c74f924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55c8c74c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55c8c74c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55c8c68057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f143a869d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 2664 byte(s) leaked in 82 allocation(s).
```

## Test case 104_PW_FM_magnetic

### On process id asan.5362

```bash

=================================================================
==5362==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 2280 byte(s) in 38 object(s) allocated from:
    #0 0x7fdd1e38b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555db7a92643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x555db80015fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x555db7ab296d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555db7aa294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x555db82f7d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555db82bfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555db82c2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x555db76037cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fdd1c183d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7fdd1e389e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fdd1c9710bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 304 byte(s) in 38 object(s) allocated from:
    #0 0x7fdd1e38b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555db7a924c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x555db80015fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x555db7ab296d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555db7aa294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x555db82f7d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555db82bfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555db82c2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x555db76037cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fdd1c183d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 120 byte(s) in 2 object(s) allocated from:
    #0 0x7fdd1e38b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555db7a92643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x555db80054d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x555db7ab296d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555db7aa294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x555db82f7d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555db82bfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555db82c2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x555db76037cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fdd1c183d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fdd1e38b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555db76ee5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x555db76cad76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x555db82f724e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x555db82bfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x555db82c2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x555db76037cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fdd1c183d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fdd1e38b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555db7a924c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x555db80054d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x555db7ab296d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555db7aa294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x555db82f7d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555db82bfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555db82c2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x555db76037cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fdd1c183d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fdd1e38b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555db76ee4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x555db76cad76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x555db82f724e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x555db82bfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x555db82c2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x555db76037cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fdd1c183d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fdd1e38b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555db76ee578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x555db76cad76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x555db82f724e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x555db82bfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x555db82c2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x555db76037cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fdd1c183d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fdd1e389e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fdd1c9c794e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fdd1e389e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fdd1c9c74d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 3896 byte(s) leaked in 88 allocation(s).
```

### On process id asan.5363

```bash

=================================================================
==5363==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 2280 byte(s) in 38 object(s) allocated from:
    #0 0x7fdf16cf27a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561426e95643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5614274045fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x561426eb596d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x561426ea594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5614276fad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5614276c2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5614276c5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x561426a067cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fdf14aead09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 304 byte(s) in 38 object(s) allocated from:
    #0 0x7fdf16cf27a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561426e954c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5614274045fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x561426eb596d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x561426ea594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5614276fad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5614276c2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5614276c5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x561426a067cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fdf14aead09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 120 byte(s) in 2 object(s) allocated from:
    #0 0x7fdf16cf27a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561426e95643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5614274084d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x561426eb596d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x561426ea594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5614276fad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5614276c2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5614276c5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x561426a067cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fdf14aead09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fdf16cf27a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561426a85df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x561426ab9f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x561426ace0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5614276fa24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5614276c2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5614276c5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x561426a067cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fdf14aead09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fdf16cf27a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561426e954c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5614274084d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x561426eb596d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x561426ea594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5614276fad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5614276c2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5614276c5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x561426a067cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fdf14aead09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fdf16cf27a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561426a85d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x561426ab9f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x561426ace0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5614276fa24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5614276c2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5614276c5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x561426a067cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fdf14aead09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fdf16cf27a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561426a85d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x561426ab9f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x561426ace0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5614276fa24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5614276c2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5614276c5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x561426a067cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fdf14aead09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 2800 byte(s) leaked in 83 allocation(s).
```

## Test case 104_PW_NC_magnetic

### On process id asan.5475

```bash

=================================================================
==5475==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 5040 byte(s) in 84 object(s) allocated from:
    #0 0x7f3d5ddd47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bca4dbc643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55bca532b5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55bca4ddc96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55bca4dcc94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55bca5621d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55bca55e9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55bca55ec678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55bca492d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3d5bbccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f3d5ddd2e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f3d5c3ba0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 672 byte(s) in 84 object(s) allocated from:
    #0 0x7f3d5ddd47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bca4dbc4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55bca532b5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55bca4ddc96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55bca4dcc94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55bca5621d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55bca55e9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55bca55ec678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55bca492d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3d5bbccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 240 byte(s) in 4 object(s) allocated from:
    #0 0x7f3d5ddd47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bca4dbc643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55bca532f4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55bca4ddc96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55bca4dcc94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55bca5621d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55bca55e9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55bca55ec678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55bca492d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3d5bbccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f3d5ddd47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bca4a185df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55bca49f4d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55bca562124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55bca55e9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55bca55ec678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55bca492d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f3d5bbccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 32 byte(s) in 4 object(s) allocated from:
    #0 0x7f3d5ddd47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bca4dbc4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55bca532f4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55bca4ddc96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55bca4dcc94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55bca5621d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55bca55e9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55bca55ec678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55bca492d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3d5bbccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f3d5ddd47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bca4a184e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55bca49f4d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55bca562124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55bca55e9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55bca55ec678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55bca492d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f3d5bbccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f3d5ddd47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bca4a18578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55bca49f4d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55bca562124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55bca55e9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55bca55ec678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55bca492d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f3d5bbccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f3d5ddd2e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f3d5c41094e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f3d5ddd2e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f3d5c4104d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 7160 byte(s) leaked in 184 allocation(s).
```

### On process id asan.5476

```bash

=================================================================
==5476==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 5040 byte(s) in 84 object(s) allocated from:
    #0 0x7efd426c67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56116eda0643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x56116f30f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x56116edc096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56116edb094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56116f605d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56116f5cde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56116f5d0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56116e9117cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7efd404bed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 672 byte(s) in 84 object(s) allocated from:
    #0 0x7efd426c67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56116eda04c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x56116f30f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x56116edc096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56116edb094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56116f605d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56116f5cde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56116f5d0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56116e9117cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7efd404bed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 240 byte(s) in 4 object(s) allocated from:
    #0 0x7efd426c67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56116eda0643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x56116f3134d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x56116edc096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56116edb094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56116f605d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56116f5cde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56116f5d0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56116e9117cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7efd404bed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7efd426c67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56116e990df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x56116e9c4f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x56116e9d90b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56116f60524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x56116f5cde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x56116f5d0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x56116e9117cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7efd404bed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 32 byte(s) in 4 object(s) allocated from:
    #0 0x7efd426c67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56116eda04c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x56116f3134d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x56116edc096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56116edb094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56116f605d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56116f5cde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56116f5d0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56116e9117cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7efd404bed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7efd426c67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56116e990d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x56116e9c4f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x56116e9d90b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56116f60524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x56116f5cde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x56116f5d0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x56116e9117cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7efd404bed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7efd426c67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56116e990d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x56116e9c4f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x56116e9d90b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56116f60524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x56116f5cde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x56116f5d0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x56116e9117cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7efd404bed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 6064 byte(s) leaked in 179 allocation(s).
```

## Test case 105_PW_FD_smearing

### On process id asan.5588

```bash

=================================================================
==5588==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 8800 byte(s) in 22 object(s) allocated from:
    #0 0x7ff5d0bb17a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fc43684643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55fc43bf35fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55fc436a496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fc4369494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fc43ee9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fc43eb1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fc43eb4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fc431f57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7ff5ce9a9d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7ff5d0bafe8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7ff5cf1970bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7ff5d0bb17a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fc43684643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55fc43bf74d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55fc436a496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fc4369494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fc43ee9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fc43eb1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fc43eb4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fc431f57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7ff5ce9a9d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 176 byte(s) in 22 object(s) allocated from:
    #0 0x7ff5d0bb17a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fc436844c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55fc43bf35fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55fc436a496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fc4369494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fc43ee9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fc43eb1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fc43eb4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fc431f57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7ff5ce9a9d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 120 byte(s) in 1 object(s) allocated from:
    #0 0x7ff5d0bb17a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fc432e05df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55fc432bcd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55fc43ee924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55fc43eb1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55fc43eb4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55fc431f57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7ff5ce9a9d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 40 byte(s) in 1 object(s) allocated from:
    #0 0x7ff5d0bb17a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fc432e0578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55fc432bcd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55fc43ee924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55fc43eb1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55fc43eb4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55fc431f57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7ff5ce9a9d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 40 byte(s) in 1 object(s) allocated from:
    #0 0x7ff5d0bb17a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fc432e04e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55fc432bcd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55fc43ee924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55fc43eb1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55fc43eb4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55fc431f57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7ff5ce9a9d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7ff5d0bb17a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fc436844c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55fc43bf74d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55fc436a496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fc4369494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fc43ee9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fc43eb1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fc43eb4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fc431f57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7ff5ce9a9d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7ff5d0bafe8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7ff5cf1ed94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7ff5d0bafe8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7ff5cf1ed4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 10680 byte(s) leaked in 54 allocation(s).
```

### On process id asan.5589

```bash

=================================================================
==5589==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 8800 byte(s) in 22 object(s) allocated from:
    #0 0x7f9218ea47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56334abe8643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x56334b1575fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x56334ac0896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56334abf894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56334b44dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56334b415e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56334b418678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56334a7597cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9216c9cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7f9218ea47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56334abe8643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x56334b15b4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x56334ac0896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56334abf894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56334b44dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56334b415e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56334b418678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56334a7597cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9216c9cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 176 byte(s) in 22 object(s) allocated from:
    #0 0x7f9218ea47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56334abe84c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x56334b1575fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x56334ac0896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56334abf894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56334b44dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56334b415e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56334b418678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56334a7597cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9216c9cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 120 byte(s) in 1 object(s) allocated from:
    #0 0x7f9218ea47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56334a7d8df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x56334a80cf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x56334a8210b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56334b44d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x56334b415e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x56334b418678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x56334a7597cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f9216c9cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 40 byte(s) in 1 object(s) allocated from:
    #0 0x7f9218ea47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56334a7d8d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x56334a80cf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x56334a8210b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56334b44d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x56334b415e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x56334b418678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x56334a7597cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f9216c9cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 40 byte(s) in 1 object(s) allocated from:
    #0 0x7f9218ea47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56334a7d8d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x56334a80cf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x56334a8210b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56334b44d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x56334b415e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x56334b418678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x56334a7597cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f9216c9cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9218ea47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56334abe84c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x56334b15b4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x56334ac0896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56334abf894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56334b44dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56334b415e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56334b418678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56334a7597cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9216c9cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 9584 byte(s) leaked in 49 allocation(s).
```

## Test case 105_PW_FX_smearing

### On process id asan.5702

```bash

=================================================================
==5702==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7fd4632aee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fd4618960bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 672 byte(s) in 7 object(s) allocated from:
    #0 0x7fd4632b07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55a6f0667643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55a6f0bd65fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55a6f068796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55a6f067794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55a6f0eccd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55a6f0e94e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55a6f0e97678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55a6f01d87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd4610a8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fd4632b07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55a6f0667643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55a6f0bda4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55a6f068796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55a6f067794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55a6f0eccd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55a6f0e94e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55a6f0e97678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55a6f01d87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd4610a8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 56 byte(s) in 7 object(s) allocated from:
    #0 0x7fd4632b07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55a6f06674c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55a6f0bd65fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55a6f068796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55a6f067794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55a6f0eccd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55a6f0e94e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55a6f0e97678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55a6f01d87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd4610a8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fd4632b07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55a6f02c35df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55a6f029fd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55a6f0ecc24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55a6f0e94e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55a6f0e97678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55a6f01d87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fd4610a8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fd4632b07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55a6f02c34e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55a6f029fd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55a6f0ecc24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55a6f0e94e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55a6f0e97678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55a6f01d87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fd4610a8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fd4632b07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55a6f02c3578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55a6f029fd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55a6f0ecc24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55a6f0e94e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55a6f0e97678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55a6f01d87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fd4610a8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fd4632b07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55a6f06674c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55a6f0bda4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55a6f068796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55a6f067794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55a6f0eccd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55a6f0e94e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55a6f0e97678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55a6f01d87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd4610a8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fd4632aee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fd4618ec94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fd4632aee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fd4618ec4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 2008 byte(s) leaked in 24 allocation(s).
```

### On process id asan.5703

```bash

=================================================================
==5703==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 672 byte(s) in 7 object(s) allocated from:
    #0 0x7fa6285437a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fbb7a8c643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55fbb7ffb5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55fbb7aac96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fbb7a9c94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fbb82f1d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fbb82b9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fbb82bc678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fbb75fd7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fa62633bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fa6285437a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fbb7a8c643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55fbb7fff4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55fbb7aac96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fbb7a9c94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fbb82f1d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fbb82b9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fbb82bc678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fbb75fd7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fa62633bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 56 byte(s) in 7 object(s) allocated from:
    #0 0x7fa6285437a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fbb7a8c4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55fbb7ffb5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55fbb7aac96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fbb7a9c94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fbb82f1d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fbb82b9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fbb82bc678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fbb75fd7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fa62633bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fa6285437a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fbb767cdf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55fbb76b0f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55fbb76c50b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55fbb82f124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55fbb82b9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55fbb82bc678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55fbb75fd7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fa62633bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fa6285437a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fbb767cd86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55fbb76b0f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55fbb76c50b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55fbb82f124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55fbb82b9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55fbb82bc678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55fbb75fd7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fa62633bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fa6285437a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fbb767cd20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55fbb76b0f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55fbb76c50b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55fbb82f124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55fbb82b9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55fbb82bc678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55fbb75fd7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fa62633bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fa6285437a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fbb7a8c4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55fbb7fff4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55fbb7aac96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fbb7a9c94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fbb82f1d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fbb82b9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fbb82bc678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fbb75fd7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fa62633bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 912 byte(s) leaked in 19 allocation(s).
```

## Test case 105_PW_GA_smearing

### On process id asan.5816

```bash

=================================================================
==5816==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 10400 byte(s) in 26 object(s) allocated from:
    #0 0x7f60943077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560440020643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x56044058f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x56044004096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56044003094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x560440885d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56044084de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x560440850678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56043fb917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f60920ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f6094305e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f60928ed0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7f60943077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560440020643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5604405934d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x56044004096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56044003094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x560440885d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56044084de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x560440850678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56043fb917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f60920ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 208 byte(s) in 26 object(s) allocated from:
    #0 0x7f60943077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5604400204c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x56044058f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x56044004096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56044003094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x560440885d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56044084de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x560440850678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56043fb917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f60920ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 120 byte(s) in 1 object(s) allocated from:
    #0 0x7f60943077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56043fc7c5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x56043fc58d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x56044088524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x56044084de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x560440850678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x56043fb917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f60920ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 40 byte(s) in 1 object(s) allocated from:
    #0 0x7f60943077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56043fc7c578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x56043fc58d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x56044088524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x56044084de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x560440850678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x56043fb917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f60920ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 40 byte(s) in 1 object(s) allocated from:
    #0 0x7f60943077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56043fc7c4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x56043fc58d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x56044088524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x56044084de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x560440850678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x56043fb917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f60920ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f60943077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5604400204c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5604405934d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x56044004096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56044003094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x560440885d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56044084de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x560440850678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56043fb917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f60920ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f6094305e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f609294394e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f6094305e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f60929434d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 12312 byte(s) leaked in 62 allocation(s).
```

### On process id asan.5817

```bash

=================================================================
==5817==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 10400 byte(s) in 26 object(s) allocated from:
    #0 0x7f07317637a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555ee5d39643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x555ee62a85fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x555ee5d5996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555ee5d4994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x555ee659ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555ee6566e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555ee6569678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x555ee58aa7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f072f55bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7f07317637a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555ee5d39643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x555ee62ac4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x555ee5d5996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555ee5d4994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x555ee659ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555ee6566e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555ee6569678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x555ee58aa7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f072f55bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 208 byte(s) in 26 object(s) allocated from:
    #0 0x7f07317637a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555ee5d394c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x555ee62a85fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x555ee5d5996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555ee5d4994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x555ee659ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555ee6566e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555ee6569678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x555ee58aa7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f072f55bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 120 byte(s) in 1 object(s) allocated from:
    #0 0x7f07317637a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555ee5929df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x555ee595df76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x555ee59720b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x555ee659e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x555ee6566e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x555ee6569678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x555ee58aa7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f072f55bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 40 byte(s) in 1 object(s) allocated from:
    #0 0x7f07317637a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555ee5929d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x555ee595df76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x555ee59720b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x555ee659e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x555ee6566e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x555ee6569678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x555ee58aa7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f072f55bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 40 byte(s) in 1 object(s) allocated from:
    #0 0x7f07317637a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555ee5929d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x555ee595df76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x555ee59720b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x555ee659e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x555ee6566e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x555ee6569678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x555ee58aa7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f072f55bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f07317637a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555ee5d394c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x555ee62ac4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x555ee5d5996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555ee5d4994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x555ee659ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555ee6566e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555ee6569678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x555ee58aa7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f072f55bd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 11216 byte(s) leaked in 57 allocation(s).
```

## Test case 105_PW_M2_smearing

### On process id asan.5930

```bash

=================================================================
==5930==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f6b48e4ee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f6b474360bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 768 byte(s) in 8 object(s) allocated from:
    #0 0x7f6b48e507a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e7ca104643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55e7ca6735fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55e7ca12496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e7ca11494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e7ca969d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e7ca931e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e7ca934678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e7c9c757cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f6b46c48d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f6b48e507a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e7ca104643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55e7ca6774d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55e7ca12496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e7ca11494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e7ca969d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e7ca931e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e7ca934678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e7c9c757cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f6b46c48d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 64 byte(s) in 8 object(s) allocated from:
    #0 0x7f6b48e507a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e7ca1044c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55e7ca6735fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55e7ca12496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e7ca11494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e7ca969d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e7ca931e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e7ca934678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e7c9c757cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f6b46c48d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f6b48e507a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e7c9d605df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55e7c9d3cd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55e7ca96924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55e7ca931e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55e7ca934678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55e7c9c757cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f6b46c48d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f6b48e507a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e7ca1044c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55e7ca6774d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55e7ca12496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e7ca11494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e7ca969d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e7ca931e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e7ca934678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e7c9c757cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f6b46c48d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f6b48e507a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e7c9d604e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55e7c9d3cd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55e7ca96924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55e7ca931e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55e7ca934678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55e7c9c757cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f6b46c48d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f6b48e507a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e7c9d60578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55e7c9d3cd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55e7ca96924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55e7ca931e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55e7ca934678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55e7c9c757cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f6b46c48d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f6b48e4ee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f6b4748c94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f6b48e4ee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f6b4748c4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 2072 byte(s) leaked in 26 allocation(s).
```

### On process id asan.5931

```bash

=================================================================
==5931==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 768 byte(s) in 8 object(s) allocated from:
    #0 0x7f86d75627a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fc5b41b643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55fc5b98a5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55fc5b43b96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fc5b42b94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fc5bc80d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fc5bc48e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fc5bc4b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fc5af8c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f86d535ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f86d75627a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fc5b41b643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55fc5b98e4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55fc5b43b96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fc5b42b94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fc5bc80d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fc5bc48e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fc5bc4b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fc5af8c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f86d535ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 64 byte(s) in 8 object(s) allocated from:
    #0 0x7f86d75627a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fc5b41b4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55fc5b98a5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55fc5b43b96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fc5b42b94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fc5bc80d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fc5bc48e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fc5bc4b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fc5af8c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f86d535ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f86d75627a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fc5b00bdf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55fc5b03ff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55fc5b0540b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55fc5bc8024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55fc5bc48e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55fc5bc4b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55fc5af8c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f86d535ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f86d75627a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fc5b41b4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55fc5b98e4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55fc5b43b96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fc5b42b94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fc5bc80d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fc5bc48e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fc5bc4b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fc5af8c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f86d535ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f86d75627a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fc5b00bd86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55fc5b03ff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55fc5b0540b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55fc5bc8024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55fc5bc48e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55fc5bc4b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55fc5af8c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f86d535ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f86d75627a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fc5b00bd20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55fc5b03ff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55fc5b0540b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55fc5bc8024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55fc5bc48e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55fc5bc4b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55fc5af8c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f86d535ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 976 byte(s) leaked in 21 allocation(s).
```

## Test case 105_PW_MP_smearing

### On process id asan.6044

```bash

=================================================================
==6044==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1500 byte(s) in 15 object(s) allocated from:
    #0 0x7fe7bd3947a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ab75c9d643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55ab7620c5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55ab75cbd96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ab75cad94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ab76502d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ab764cae39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ab764cd678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ab7580e7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fe7bb18cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7fe7bd392e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fe7bb97a0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 120 byte(s) in 15 object(s) allocated from:
    #0 0x7fe7bd3947a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ab75c9d4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55ab7620c5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55ab75cbd96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ab75cad94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ab76502d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ab764cae39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ab764cd678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ab7580e7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fe7bb18cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 100 byte(s) in 1 object(s) allocated from:
    #0 0x7fe7bd3947a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ab75c9d643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55ab762104d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55ab75cbd96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ab75cad94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ab76502d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ab764cae39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ab764cd678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ab7580e7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fe7bb18cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7fe7bd3947a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ab758f95df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55ab758d5d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55ab7650224e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55ab764cae39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55ab764cd678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55ab7580e7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fe7bb18cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fe7bd3947a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ab75c9d4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55ab762104d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55ab75cbd96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ab75cad94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ab76502d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ab764cae39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ab764cd678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ab7580e7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fe7bb18cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fe7bd3947a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ab758f94e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55ab758d5d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55ab7650224e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55ab764cae39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55ab764cd678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55ab7580e7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fe7bb18cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fe7bd3947a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ab758f9578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55ab758d5d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55ab7650224e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55ab764cae39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55ab764cd678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55ab7580e7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fe7bb18cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fe7bd392e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fe7bb9d094e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fe7bd392e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fe7bb9d04d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 2864 byte(s) leaked in 40 allocation(s).
```

### On process id asan.6045

```bash

=================================================================
==6045==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1500 byte(s) in 15 object(s) allocated from:
    #0 0x7f2c0ad8d7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5610f265f643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5610f2bce5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x5610f267f96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5610f266f94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5610f2ec4d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5610f2e8ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5610f2e8f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5610f21d07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2c08b85d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 120 byte(s) in 15 object(s) allocated from:
    #0 0x7f2c0ad8d7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5610f265f4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5610f2bce5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x5610f267f96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5610f266f94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5610f2ec4d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5610f2e8ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5610f2e8f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5610f21d07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2c08b85d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 100 byte(s) in 1 object(s) allocated from:
    #0 0x7f2c0ad8d7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5610f265f643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5610f2bd24d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x5610f267f96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5610f266f94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5610f2ec4d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5610f2e8ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5610f2e8f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5610f21d07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2c08b85d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f2c0ad8d7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5610f224fdf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x5610f2283f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5610f22980b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5610f2ec424e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5610f2e8ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5610f2e8f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5610f21d07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f2c08b85d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f2c0ad8d7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5610f265f4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5610f2bd24d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x5610f267f96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5610f266f94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5610f2ec4d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5610f2e8ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5610f2e8f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5610f21d07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2c08b85d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f2c0ad8d7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5610f224fd86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x5610f2283f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5610f22980b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5610f2ec424e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5610f2e8ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5610f2e8f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5610f21d07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f2c08b85d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f2c0ad8d7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5610f224fd20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x5610f2283f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5610f22980b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5610f2ec424e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5610f2e8ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5610f2e8f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5610f21d07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f2c08b85d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 1768 byte(s) leaked in 35 allocation(s).
```

## Test case 105_PW_MV_smearing

### On process id asan.6158

```bash

=================================================================
==6158==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f9b933bae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9b919a20bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 960 byte(s) in 12 object(s) allocated from:
    #0 0x7f9b933bc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b6745f4643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55b674b635fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55b67461496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b67460494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b674e59d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b674e21e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b674e24678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b6741657cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9b911b4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 12 object(s) allocated from:
    #0 0x7f9b933bc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b6745f44c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55b674b635fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55b67461496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b67460494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b674e59d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b674e21e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b674e24678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b6741657cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9b911b4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 80 byte(s) in 1 object(s) allocated from:
    #0 0x7f9b933bc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b6745f4643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55b674b674d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55b67461496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b67460494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b674e59d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b674e21e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b674e24678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b6741657cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9b911b4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f9b933bc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b6742505df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55b67422cd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55b674e5924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55b674e21e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55b674e24678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55b6741657cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f9b911b4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f9b933bc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b6742504e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55b67422cd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55b674e5924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55b674e21e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55b674e24678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55b6741657cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f9b911b4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f9b933bc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b674250578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55b67422cd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55b674e5924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55b674e21e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55b674e24678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55b6741657cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f9b911b4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9b933bc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b6745f44c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55b674b674d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55b67461496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b67460494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b674e59d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b674e21e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b674e24678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b6741657cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9b911b4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9b933bae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9b919f894e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9b933bae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9b919f84d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 2320 byte(s) leaked in 34 allocation(s).
```

### On process id asan.6159

```bash

=================================================================
==6159==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 960 byte(s) in 12 object(s) allocated from:
    #0 0x7fe062aa07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562cf8d8a643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x562cf92f95fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x562cf8daa96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x562cf8d9a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x562cf95efd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x562cf95b7e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x562cf95ba678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x562cf88fb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fe060898d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 12 object(s) allocated from:
    #0 0x7fe062aa07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562cf8d8a4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x562cf92f95fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x562cf8daa96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x562cf8d9a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x562cf95efd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x562cf95b7e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x562cf95ba678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x562cf88fb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fe060898d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 80 byte(s) in 1 object(s) allocated from:
    #0 0x7fe062aa07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562cf8d8a643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x562cf92fd4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x562cf8daa96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x562cf8d9a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x562cf95efd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x562cf95b7e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x562cf95ba678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x562cf88fb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fe060898d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fe062aa07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562cf897adf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x562cf89aef76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x562cf89c30b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x562cf95ef24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x562cf95b7e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x562cf95ba678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x562cf88fb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fe060898d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fe062aa07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562cf897ad86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x562cf89aef76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x562cf89c30b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x562cf95ef24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x562cf95b7e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x562cf95ba678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x562cf88fb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fe060898d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fe062aa07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562cf897ad20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x562cf89aef76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x562cf89c30b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x562cf95ef24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x562cf95b7e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x562cf95ba678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x562cf88fb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fe060898d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fe062aa07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562cf8d8a4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x562cf92fd4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x562cf8daa96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x562cf8d9a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x562cf95efd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x562cf95b7e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x562cf95ba678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x562cf88fb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fe060898d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 1224 byte(s) leaked in 29 allocation(s).
```

## Test case 106_PW_BD_chargemixing

### On process id asan.6272

```bash

=================================================================
==6272==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f9214254e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f921283c0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 864 byte(s) in 9 object(s) allocated from:
    #0 0x7f92142567a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e9f9d50643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55e9fa2bf5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55e9f9d7096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e9f9d6094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e9fa5b5d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e9fa57de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e9fa580678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e9f98c17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f921204ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f92142567a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e9f9d50643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55e9fa2c34d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55e9f9d7096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e9f9d6094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e9fa5b5d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e9fa57de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e9fa580678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e9f98c17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f921204ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 9 object(s) allocated from:
    #0 0x7f92142567a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e9f9d504c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55e9fa2bf5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55e9f9d7096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e9f9d6094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e9fa5b5d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e9fa57de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e9fa580678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e9f98c17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f921204ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f92142567a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e9f99ac5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55e9f9988d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55e9fa5b524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55e9fa57de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55e9fa580678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55e9f98c17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f921204ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f92142567a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e9f9d504c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55e9fa2c34d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55e9f9d7096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e9f9d6094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e9fa5b5d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e9fa57de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e9fa580678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e9f98c17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f921204ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f92142567a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e9f99ac4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55e9f9988d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55e9fa5b524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55e9fa57de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55e9fa580678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55e9f98c17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f921204ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f92142567a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e9f99ac578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55e9f9988d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55e9fa5b524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55e9fa57de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55e9fa580678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55e9f98c17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f921204ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9214254e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f921289294e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9214254e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f92128924d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 2176 byte(s) leaked in 28 allocation(s).
```

### On process id asan.6273

```bash

=================================================================
==6273==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 864 byte(s) in 9 object(s) allocated from:
    #0 0x7f10edcda7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555680d16643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5556812855fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x555680d3696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555680d2694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55568157bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555681543e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555681546678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5556808877cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f10ebad2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f10edcda7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555680d16643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5556812894d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x555680d3696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555680d2694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55568157bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555681543e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555681546678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5556808877cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f10ebad2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 9 object(s) allocated from:
    #0 0x7f10edcda7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555680d164c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5556812855fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x555680d3696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555680d2694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55568157bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555681543e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555681546678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5556808877cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f10ebad2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f10edcda7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555680906df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55568093af76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55568094f0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55568157b24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x555681543e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x555681546678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5556808877cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f10ebad2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f10edcda7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555680d164c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5556812894d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x555680d3696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555680d2694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55568157bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555681543e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555681546678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5556808877cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f10ebad2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f10edcda7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555680906d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55568093af76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55568094f0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55568157b24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x555681543e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x555681546678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5556808877cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f10ebad2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f10edcda7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555680906d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55568093af76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55568094f0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55568157b24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x555681543e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x555681546678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5556808877cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f10ebad2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 1080 byte(s) leaked in 23 allocation(s).
```

## Test case 106_PW_KK_chargemixing

### On process id asan.6386

```bash

=================================================================
==6386==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f01bf9ade8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f01bdf950bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 1056 byte(s) in 11 object(s) allocated from:
    #0 0x7f01bf9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e1c4634643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55e1c4ba35fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55e1c465496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e1c464494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e1c4e99d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e1c4e61e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e1c4e64678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e1c41a57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f01bd7a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f01bf9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e1c4634643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55e1c4ba74d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55e1c465496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e1c464494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e1c4e99d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e1c4e61e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e1c4e64678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e1c41a57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f01bd7a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 88 byte(s) in 11 object(s) allocated from:
    #0 0x7f01bf9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e1c46344c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55e1c4ba35fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55e1c465496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e1c464494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e1c4e99d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e1c4e61e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e1c4e64678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e1c41a57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f01bd7a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f01bf9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e1c42905df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55e1c426cd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55e1c4e9924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55e1c4e61e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55e1c4e64678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55e1c41a57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f01bd7a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f01bf9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e1c46344c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55e1c4ba74d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55e1c465496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e1c464494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e1c4e99d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e1c4e61e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e1c4e64678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e1c41a57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f01bd7a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f01bf9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e1c42904e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55e1c426cd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55e1c4e9924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55e1c4e61e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55e1c4e64678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55e1c41a57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f01bd7a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f01bf9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e1c4290578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55e1c426cd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55e1c4e9924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55e1c4e61e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55e1c4e64678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55e1c41a57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f01bd7a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f01bf9ade8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f01bdfeb94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f01bf9ade8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f01bdfeb4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 2384 byte(s) leaked in 32 allocation(s).
```

### On process id asan.6387

```bash

=================================================================
==6387==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1056 byte(s) in 11 object(s) allocated from:
    #0 0x7f6b859647a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55edb3c75643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55edb41e45fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55edb3c9596d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55edb3c8594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55edb44dad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55edb44a2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55edb44a5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55edb37e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f6b8375cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f6b859647a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55edb3c75643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55edb41e84d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55edb3c9596d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55edb3c8594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55edb44dad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55edb44a2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55edb44a5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55edb37e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f6b8375cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 88 byte(s) in 11 object(s) allocated from:
    #0 0x7f6b859647a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55edb3c754c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55edb41e45fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55edb3c9596d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55edb3c8594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55edb44dad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55edb44a2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55edb44a5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55edb37e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f6b8375cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f6b859647a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55edb3865df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55edb3899f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55edb38ae0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55edb44da24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55edb44a2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55edb44a5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55edb37e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f6b8375cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f6b859647a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55edb3c754c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55edb41e84d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55edb3c9596d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55edb3c8594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55edb44dad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55edb44a2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55edb44a5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55edb37e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f6b8375cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f6b859647a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55edb3865d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55edb3899f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55edb38ae0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55edb44da24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55edb44a2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55edb44a5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55edb37e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f6b8375cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f6b859647a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55edb3865d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55edb3899f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55edb38ae0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55edb44da24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55edb44a2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55edb44a5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55edb37e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f6b8375cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 1288 byte(s) leaked in 27 allocation(s).
```

## Test case 106_PW_PK_chargemixing

### On process id asan.6500

```bash

=================================================================
==6500==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f87e6fb4e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f87e559c0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 768 byte(s) in 8 object(s) allocated from:
    #0 0x7f87e6fb67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55742445d643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5574249cc5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55742447d96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55742446d94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557424cc2d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557424c8ae39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557424c8d678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557423fce7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f87e4daed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f87e6fb67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55742445d643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5574249d04d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55742447d96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55742446d94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557424cc2d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557424c8ae39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557424c8d678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557423fce7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f87e4daed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 64 byte(s) in 8 object(s) allocated from:
    #0 0x7f87e6fb67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55742445d4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5574249cc5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55742447d96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55742446d94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557424cc2d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557424c8ae39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557424c8d678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557423fce7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f87e4daed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f87e6fb67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5574240b95df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x557424095d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x557424cc224e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x557424c8ae39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x557424c8d678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x557423fce7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f87e4daed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f87e6fb67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55742445d4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5574249d04d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55742447d96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55742446d94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557424cc2d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557424c8ae39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557424c8d678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557423fce7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f87e4daed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f87e6fb67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5574240b94e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x557424095d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x557424cc224e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x557424c8ae39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x557424c8d678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x557423fce7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f87e4daed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f87e6fb67a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5574240b9578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x557424095d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x557424cc224e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x557424c8ae39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x557424c8d678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x557423fce7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f87e4daed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f87e6fb4e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f87e55f294e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f87e6fb4e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f87e55f24d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 2072 byte(s) leaked in 26 allocation(s).
```

### On process id asan.6501

```bash

=================================================================
==6501==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 768 byte(s) in 8 object(s) allocated from:
    #0 0x7fef7d2467a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560935f95643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5609365045fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x560935fb596d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x560935fa594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5609367fad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5609367c2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5609367c5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560935b067cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fef7b03ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fef7d2467a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560935f95643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5609365084d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x560935fb596d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x560935fa594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5609367fad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5609367c2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5609367c5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560935b067cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fef7b03ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 64 byte(s) in 8 object(s) allocated from:
    #0 0x7fef7d2467a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560935f954c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5609365045fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x560935fb596d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x560935fa594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5609367fad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5609367c2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5609367c5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560935b067cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fef7b03ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7fef7d2467a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560935b85df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x560935bb9f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x560935bce0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5609367fa24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5609367c2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5609367c5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x560935b067cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fef7b03ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fef7d2467a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560935f954c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5609365084d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x560935fb596d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x560935fa594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5609367fad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5609367c2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5609367c5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560935b067cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fef7b03ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fef7d2467a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560935b85d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x560935bb9f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x560935bce0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5609367fa24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5609367c2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5609367c5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x560935b067cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fef7b03ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fef7d2467a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560935b85d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x560935bb9f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x560935bce0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5609367fa24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5609367c2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5609367c5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x560935b067cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fef7b03ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 976 byte(s) leaked in 21 allocation(s).
```

## Test case 106_PW_PL_chargemixing

### On process id asan.6614

```bash

=================================================================
==6614==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7fd6f5cf5e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fd6f42dd0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 768 byte(s) in 8 object(s) allocated from:
    #0 0x7fd6f5cf77a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5629e2338643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5629e28a75fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x5629e235896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5629e234894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5629e2b9dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5629e2b65e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5629e2b68678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5629e1ea97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd6f3aefd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fd6f5cf77a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5629e2338643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5629e28ab4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x5629e235896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5629e234894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5629e2b9dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5629e2b65e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5629e2b68678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5629e1ea97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd6f3aefd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 64 byte(s) in 8 object(s) allocated from:
    #0 0x7fd6f5cf77a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5629e23384c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5629e28a75fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x5629e235896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5629e234894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5629e2b9dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5629e2b65e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5629e2b68678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5629e1ea97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd6f3aefd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7fd6f5cf77a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5629e1f945df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x5629e1f70d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x5629e2b9d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x5629e2b65e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x5629e2b68678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5629e1ea97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fd6f3aefd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fd6f5cf77a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5629e23384c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5629e28ab4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x5629e235896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5629e234894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5629e2b9dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5629e2b65e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5629e2b68678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5629e1ea97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd6f3aefd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fd6f5cf77a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5629e1f944e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x5629e1f70d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x5629e2b9d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x5629e2b65e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x5629e2b68678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5629e1ea97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fd6f3aefd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fd6f5cf77a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5629e1f94578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x5629e1f70d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x5629e2b9d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x5629e2b65e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x5629e2b68678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5629e1ea97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fd6f3aefd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fd6f5cf5e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fd6f433394e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fd6f5cf5e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fd6f43334d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 2072 byte(s) leaked in 26 allocation(s).
```

### On process id asan.6615

```bash

=================================================================
==6615==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 768 byte(s) in 8 object(s) allocated from:
    #0 0x7f15c52927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e42457a643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55e424ae95fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55e42459a96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e42458a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e424ddfd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e424da7e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e424daa678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e4240eb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f15c308ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f15c52927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e42457a643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55e424aed4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55e42459a96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e42458a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e424ddfd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e424da7e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e424daa678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e4240eb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f15c308ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 64 byte(s) in 8 object(s) allocated from:
    #0 0x7f15c52927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e42457a4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55e424ae95fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55e42459a96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e42458a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e424ddfd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e424da7e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e424daa678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e4240eb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f15c308ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f15c52927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e42416adf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55e42419ef76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55e4241b30b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55e424ddf24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55e424da7e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55e424daa678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55e4240eb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f15c308ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f15c52927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e42457a4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55e424aed4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55e42459a96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e42458a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e424ddfd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e424da7e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e424daa678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e4240eb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f15c308ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f15c52927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e42416ad86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55e42419ef76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55e4241b30b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55e424ddf24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55e424da7e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55e424daa678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55e4240eb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f15c308ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f15c52927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e42416ad20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55e42419ef76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55e4241b30b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55e424ddf24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55e424da7e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55e424daa678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55e4240eb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f15c308ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 976 byte(s) leaked in 21 allocation(s).
```

## Test case 106_PW_PU_chargemixing

### On process id asan.6728

```bash

=================================================================
==6728==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f872bafbe8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f872a0e30bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 768 byte(s) in 8 object(s) allocated from:
    #0 0x7f872bafd7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557bf3e47643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x557bf43b65fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x557bf3e6796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557bf3e5794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557bf46acd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557bf4674e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557bf4677678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557bf39b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f87298f5d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f872bafd7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557bf3e47643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x557bf43ba4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x557bf3e6796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557bf3e5794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557bf46acd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557bf4674e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557bf4677678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557bf39b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f87298f5d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 64 byte(s) in 8 object(s) allocated from:
    #0 0x7f872bafd7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557bf3e474c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x557bf43b65fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x557bf3e6796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557bf3e5794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557bf46acd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557bf4674e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557bf4677678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557bf39b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f87298f5d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f872bafd7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557bf3aa35df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x557bf3a7fd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x557bf46ac24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x557bf4674e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x557bf4677678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x557bf39b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f87298f5d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f872bafd7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557bf3e474c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x557bf43ba4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x557bf3e6796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557bf3e5794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557bf46acd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557bf4674e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557bf4677678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557bf39b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f87298f5d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f872bafd7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557bf3aa34e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x557bf3a7fd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x557bf46ac24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x557bf4674e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x557bf4677678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x557bf39b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f87298f5d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f872bafd7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557bf3aa3578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x557bf3a7fd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x557bf46ac24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x557bf4674e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x557bf4677678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x557bf39b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f87298f5d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f872bafbe8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f872a13994e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f872bafbe8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f872a1394d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 2072 byte(s) leaked in 26 allocation(s).
```

### On process id asan.6729

```bash

=================================================================
==6729==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 768 byte(s) in 8 object(s) allocated from:
    #0 0x7f1c337187a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563353fa9643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5633545185fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x563353fc996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x563353fb994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56335480ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5633547d6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5633547d9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x563353b1a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f1c31510d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f1c337187a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563353fa9643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x56335451c4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x563353fc996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x563353fb994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56335480ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5633547d6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5633547d9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x563353b1a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f1c31510d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 64 byte(s) in 8 object(s) allocated from:
    #0 0x7f1c337187a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563353fa94c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5633545185fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x563353fc996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x563353fb994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56335480ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5633547d6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5633547d9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x563353b1a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f1c31510d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f1c337187a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563353b99df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x563353bcdf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x563353be20b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56335480e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5633547d6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5633547d9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x563353b1a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f1c31510d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f1c337187a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563353fa94c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x56335451c4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x563353fc996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x563353fb994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56335480ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5633547d6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5633547d9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x563353b1a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f1c31510d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f1c337187a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563353b99d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x563353bcdf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x563353be20b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56335480e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5633547d6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5633547d9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x563353b1a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f1c31510d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f1c337187a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563353b99d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x563353bcdf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x563353be20b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56335480e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5633547d6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5633547d9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x563353b1a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f1c31510d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 976 byte(s) leaked in 21 allocation(s).
```

## Test case 107_PW_OB_outputbands

### On process id asan.6842

```bash

=================================================================
==6842==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f4cee1bee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f4cec7a60bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f4cee1c07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5630ae3e45df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x5630ae3c0d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x5630aefed24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x5630aefb5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x5630aefb8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5630ae2f97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f4cebfb8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f4cee1c07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5630ae3e44e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x5630ae3c0d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x5630aefed24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x5630aefb5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x5630aefb8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5630ae2f97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f4cebfb8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f4cee1c07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5630ae3e4578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x5630ae3c0d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x5630aefed24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x5630aefb5e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x5630aefb8678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5630ae2f97cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f4cebfb8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f4cee1bee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f4cec7fc94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f4cee1bee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f4cec7fc4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 1176 byte(s) leaked in 8 allocation(s).
```

### On process id asan.6843

```bash

=================================================================
==6843==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f10f98f07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5612729c9df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x5612729fdf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x561272a120b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56127363e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x561273606e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x561273609678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x56127294a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f10f76e8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f10f98f07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5612729c9d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x5612729fdf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x561272a120b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56127363e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x561273606e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x561273609678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x56127294a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f10f76e8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f10f98f07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5612729c9d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x5612729fdf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x561272a120b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56127363e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x561273606e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x561273609678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x56127294a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f10f76e8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 80 byte(s) leaked in 3 allocation(s).
```

## Test case 107_PW_OD_outputdos

### On process id asan.7065

```bash

=================================================================
==7065==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7fadd3144e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fadd172c0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fadd31467a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556abe3085df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x556abe2e4d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x556abef1124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x556abeed9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x556abeedc678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x556abe21d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fadd0f3ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fadd31467a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556abe3084e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x556abe2e4d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x556abef1124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x556abeed9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x556abeedc678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x556abe21d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fadd0f3ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fadd31467a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556abe308578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x556abe2e4d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x556abef1124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x556abeed9e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x556abeedc678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x556abe21d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fadd0f3ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fadd3144e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fadd178294e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fadd3144e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fadd17824d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 1176 byte(s) leaked in 8 allocation(s).
```

### On process id asan.7066

```bash

=================================================================
==7066==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fd8f0e6a7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556b8e322df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x556b8e356f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x556b8e36b0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x556b8ef9724e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x556b8ef5fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x556b8ef62678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x556b8e2a37cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fd8eec62d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fd8f0e6a7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556b8e322d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x556b8e356f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x556b8e36b0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x556b8ef9724e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x556b8ef5fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x556b8ef62678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x556b8e2a37cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fd8eec62d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fd8f0e6a7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556b8e322d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x556b8e356f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x556b8e36b0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x556b8ef9724e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x556b8ef5fe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x556b8ef62678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x556b8e2a37cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fd8eec62d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 80 byte(s) leaked in 3 allocation(s).
```

## Test case 108_PW_RE

### On process id asan.7170

```bash

=================================================================
==7170==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 2400 byte(s) in 2 object(s) allocated from:
    #0 0x7f0b2ecd97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555f5e1cafb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x555f5e1d8c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x555f5ddf8cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x555f5ddfc64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x555f5ddfd512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x555f5ddf094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x555f5e645d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x555f5e60de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x555f5e610678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x555f5d9517cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f0b2cad1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1440 byte(s) in 15 object(s) allocated from:
    #0 0x7f0b2ecd97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555f5dde0643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x555f5e34f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x555f5de0096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555f5ddf094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x555f5e645d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555f5e60de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555f5e610678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x555f5d9517cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0b2cad1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f0b2ecd7e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f0b2d2bf0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 800 byte(s) in 2 object(s) allocated from:
    #0 0x7f0b2ecd97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555f5e1cb03d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x555f5e1d8c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x555f5ddf8cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x555f5ddfc64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x555f5ddfd512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x555f5ddf094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x555f5e645d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x555f5e60de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x555f5e610678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x555f5d9517cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f0b2cad1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 2 object(s) allocated from:
    #0 0x7f0b2ecd97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555f5e1cb07c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x555f5e1d8c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x555f5ddf8cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x555f5ddfc64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x555f5ddfd512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x555f5ddf094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x555f5e645d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x555f5e60de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x555f5e610678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x555f5d9517cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f0b2cad1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 192 byte(s) in 2 object(s) allocated from:
    #0 0x7f0b2ecd97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555f5dde0643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x555f5e3534d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x555f5de0096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555f5ddf094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x555f5e645d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555f5e60de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555f5e610678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x555f5d9517cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0b2cad1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 120 byte(s) in 15 object(s) allocated from:
    #0 0x7f0b2ecd97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555f5dde04c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x555f5e34f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x555f5de0096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555f5ddf094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x555f5e645d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555f5e60de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555f5e610678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x555f5d9517cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0b2cad1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f0b2ecd97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555f5da3c5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x555f5da18d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x555f5e64524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x555f5e60de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x555f5e610678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x555f5d9517cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f0b2cad1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f0b2ecd97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555f5dde04c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x555f5e3534d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x555f5de0096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555f5ddf094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x555f5e645d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555f5e60de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555f5e610678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x555f5d9517cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f0b2cad1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f0b2ecd97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555f5da3c4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x555f5da18d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x555f5e64524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x555f5e60de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x555f5e610678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x555f5d9517cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f0b2cad1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f0b2ecd97a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555f5da3c578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x555f5da18d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x555f5e64524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x555f5e60de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x555f5e610678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x555f5d9517cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f0b2cad1d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f0b2ecd7e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f0b2d31594e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f0b2ecd7e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f0b2d3154d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 6544 byte(s) leaked in 48 allocation(s).
```

### On process id asan.7171

```bash

=================================================================
==7171==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1440 byte(s) in 15 object(s) allocated from:
    #0 0x7f83bcd7e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559b485bb643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x559b48b2a5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x559b485db96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x559b485cb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x559b48e20d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x559b48de8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x559b48deb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x559b4812c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f83bab76d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 192 byte(s) in 2 object(s) allocated from:
    #0 0x7f83bcd7e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559b485bb643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x559b48b2e4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x559b485db96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x559b485cb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x559b48e20d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x559b48de8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x559b48deb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x559b4812c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f83bab76d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 120 byte(s) in 15 object(s) allocated from:
    #0 0x7f83bcd7e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559b485bb4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x559b48b2a5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x559b485db96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x559b485cb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x559b48e20d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x559b48de8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x559b48deb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x559b4812c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f83bab76d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f83bcd7e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559b481abdf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x559b481dff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x559b481f40b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x559b48e2024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x559b48de8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x559b48deb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x559b4812c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f83bab76d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f83bcd7e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559b481abdf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x559b481e07c9 in UnitCell::bcast_atoms_tau() /workspace/abacus-develop/source/module_cell/unitcell.cpp:404
    #3 0x559b485e2a9b in Ions_Move_Basic::move_atoms(double*, double*) /workspace/abacus-develop/source/src_ions/ions_move_basic.cpp:112
    #4 0x559b485ed94a in Ions_Move_CG::start(ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_cg.cpp:145
    #5 0x559b485f048d in Ions_Move_Methods::cal_movement(int const&, int const&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_methods.cpp:61
    #6 0x559b485d59b3 in Ions::do_relax(int const&, int&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions.cpp:372
    #7 0x559b485d7542 in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:280
    #8 0x559b485d8512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #9 0x559b485cb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #10 0x559b48e20d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #11 0x559b48de8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #12 0x559b48deb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #13 0x559b4812c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #14 0x7f83bab76d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f83bcd7e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559b481abd86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x559b481e07c9 in UnitCell::bcast_atoms_tau() /workspace/abacus-develop/source/module_cell/unitcell.cpp:404
    #3 0x559b485e2a9b in Ions_Move_Basic::move_atoms(double*, double*) /workspace/abacus-develop/source/src_ions/ions_move_basic.cpp:112
    #4 0x559b485ed94a in Ions_Move_CG::start(ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_cg.cpp:145
    #5 0x559b485f048d in Ions_Move_Methods::cal_movement(int const&, int const&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_methods.cpp:61
    #6 0x559b485d59b3 in Ions::do_relax(int const&, int&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions.cpp:372
    #7 0x559b485d7542 in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:280
    #8 0x559b485d8512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #9 0x559b485cb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #10 0x559b48e20d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #11 0x559b48de8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #12 0x559b48deb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #13 0x559b4812c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #14 0x7f83bab76d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f83bcd7e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559b481abd20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x559b481e07c9 in UnitCell::bcast_atoms_tau() /workspace/abacus-develop/source/module_cell/unitcell.cpp:404
    #3 0x559b485e2a9b in Ions_Move_Basic::move_atoms(double*, double*) /workspace/abacus-develop/source/src_ions/ions_move_basic.cpp:112
    #4 0x559b485ed94a in Ions_Move_CG::start(ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_cg.cpp:145
    #5 0x559b485f048d in Ions_Move_Methods::cal_movement(int const&, int const&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_methods.cpp:61
    #6 0x559b485d59b3 in Ions::do_relax(int const&, int&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions.cpp:372
    #7 0x559b485d7542 in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:280
    #8 0x559b485d8512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #9 0x559b485cb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #10 0x559b48e20d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #11 0x559b48de8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #12 0x559b48deb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #13 0x559b4812c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #14 0x7f83bab76d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f83bcd7e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559b485bb4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x559b48b2e4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x559b485db96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x559b485cb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x559b48e20d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x559b48de8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x559b48deb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x559b4812c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f83bab76d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f83bcd7e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559b481abd86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x559b481dff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x559b481f40b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x559b48e2024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x559b48de8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x559b48deb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x559b4812c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f83bab76d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f83bcd7e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559b481abd20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x559b481dff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x559b481f40b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x559b48e2024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x559b48de8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x559b48deb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x559b4812c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f83bab76d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 1928 byte(s) leaked in 40 allocation(s).
```

## Test case 108_PW_RE_MB

### On process id asan.7369

```bash

=================================================================
==7369==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 2400 byte(s) in 2 object(s) allocated from:
    #0 0x7f80b9e9b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560d30483fb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x560d30491c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x560d300b1cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x560d300b564e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x560d300b6512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x560d300a994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x560d308fed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x560d308c6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x560d308c9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x560d2fc0a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f80b7c93d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1920 byte(s) in 20 object(s) allocated from:
    #0 0x7f80b9e9b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560d30099643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x560d306085fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x560d300b996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x560d300a994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x560d308fed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x560d308c6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x560d308c9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560d2fc0a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f80b7c93d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f80b9e99e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f80b84810bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 800 byte(s) in 2 object(s) allocated from:
    #0 0x7f80b9e9b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560d3048403d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x560d30491c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x560d300b1cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x560d300b564e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x560d300b6512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x560d300a994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x560d308fed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x560d308c6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x560d308c9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x560d2fc0a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f80b7c93d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 2 object(s) allocated from:
    #0 0x7f80b9e9b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560d3048407c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x560d30491c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x560d300b1cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x560d300b564e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x560d300b6512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x560d300a994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x560d308fed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x560d308c6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x560d308c9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x560d2fc0a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f80b7c93d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 192 byte(s) in 2 object(s) allocated from:
    #0 0x7f80b9e9b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560d30099643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x560d3060c4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x560d300b996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x560d300a994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x560d308fed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x560d308c6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x560d308c9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560d2fc0a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f80b7c93d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 160 byte(s) in 20 object(s) allocated from:
    #0 0x7f80b9e9b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560d300994c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x560d306085fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x560d300b996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x560d300a994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x560d308fed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x560d308c6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x560d308c9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560d2fc0a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f80b7c93d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f80b9e9b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560d2fcf55df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x560d2fcd1d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x560d308fe24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x560d308c6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x560d308c9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x560d2fc0a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f80b7c93d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f80b9e9b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560d300994c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x560d3060c4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x560d300b996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x560d300a994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x560d308fed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x560d308c6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x560d308c9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560d2fc0a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f80b7c93d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f80b9e9b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560d2fcf54e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x560d2fcd1d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x560d308fe24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x560d308c6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x560d308c9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x560d2fc0a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f80b7c93d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f80b9e9b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560d2fcf5578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x560d2fcd1d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x560d308fe24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x560d308c6e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x560d308c9678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x560d2fc0a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f80b7c93d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f80b9e99e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f80b84d794e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f80b9e99e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f80b84d74d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 7064 byte(s) leaked in 58 allocation(s).
```

### On process id asan.7370

```bash

=================================================================
==7370==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1920 byte(s) in 20 object(s) allocated from:
    #0 0x7f96d3bf37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560ee6df1643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x560ee73605fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x560ee6e1196d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x560ee6e0194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x560ee7656d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x560ee761ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x560ee7621678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560ee69627cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f96d19ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 192 byte(s) in 2 object(s) allocated from:
    #0 0x7f96d3bf37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560ee6df1643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x560ee73644d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x560ee6e1196d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x560ee6e0194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x560ee7656d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x560ee761ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x560ee7621678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560ee69627cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f96d19ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 160 byte(s) in 20 object(s) allocated from:
    #0 0x7f96d3bf37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560ee6df14c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x560ee73605fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x560ee6e1196d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x560ee6e0194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x560ee7656d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x560ee761ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x560ee7621678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560ee69627cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f96d19ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f96d3bf37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560ee69e1df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x560ee6a15f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x560ee6a2a0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x560ee765624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x560ee761ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x560ee7621678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x560ee69627cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f96d19ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f96d3bf37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560ee69e1df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x560ee6a167c9 in UnitCell::bcast_atoms_tau() /workspace/abacus-develop/source/module_cell/unitcell.cpp:404
    #3 0x560ee6e18a9b in Ions_Move_Basic::move_atoms(double*, double*) /workspace/abacus-develop/source/src_ions/ions_move_basic.cpp:112
    #4 0x560ee6e21062 in Ions_Move_BFGS::start(ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_bfgs.cpp:77
    #5 0x560ee6e252b8 in Ions_Move_Methods::cal_movement(int const&, int const&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_methods.cpp:49
    #6 0x560ee6e0b9b3 in Ions::do_relax(int const&, int&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions.cpp:372
    #7 0x560ee6e0d542 in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:280
    #8 0x560ee6e0e512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #9 0x560ee6e0194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #10 0x560ee7656d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #11 0x560ee761ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #12 0x560ee7621678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #13 0x560ee69627cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #14 0x7f96d19ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f96d3bf37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560ee69e1d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x560ee6a167c9 in UnitCell::bcast_atoms_tau() /workspace/abacus-develop/source/module_cell/unitcell.cpp:404
    #3 0x560ee6e18a9b in Ions_Move_Basic::move_atoms(double*, double*) /workspace/abacus-develop/source/src_ions/ions_move_basic.cpp:112
    #4 0x560ee6e21062 in Ions_Move_BFGS::start(ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_bfgs.cpp:77
    #5 0x560ee6e252b8 in Ions_Move_Methods::cal_movement(int const&, int const&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_methods.cpp:49
    #6 0x560ee6e0b9b3 in Ions::do_relax(int const&, int&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions.cpp:372
    #7 0x560ee6e0d542 in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:280
    #8 0x560ee6e0e512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #9 0x560ee6e0194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #10 0x560ee7656d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #11 0x560ee761ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #12 0x560ee7621678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #13 0x560ee69627cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #14 0x7f96d19ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f96d3bf37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560ee69e1d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x560ee6a167c9 in UnitCell::bcast_atoms_tau() /workspace/abacus-develop/source/module_cell/unitcell.cpp:404
    #3 0x560ee6e18a9b in Ions_Move_Basic::move_atoms(double*, double*) /workspace/abacus-develop/source/src_ions/ions_move_basic.cpp:112
    #4 0x560ee6e21062 in Ions_Move_BFGS::start(ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_bfgs.cpp:77
    #5 0x560ee6e252b8 in Ions_Move_Methods::cal_movement(int const&, int const&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_methods.cpp:49
    #6 0x560ee6e0b9b3 in Ions::do_relax(int const&, int&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions.cpp:372
    #7 0x560ee6e0d542 in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:280
    #8 0x560ee6e0e512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #9 0x560ee6e0194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #10 0x560ee7656d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #11 0x560ee761ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #12 0x560ee7621678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #13 0x560ee69627cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #14 0x7f96d19ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f96d3bf37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560ee6df14c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x560ee73644d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x560ee6e1196d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x560ee6e0194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x560ee7656d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x560ee761ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x560ee7621678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560ee69627cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f96d19ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f96d3bf37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560ee69e1d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x560ee6a15f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x560ee6a2a0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x560ee765624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x560ee761ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x560ee7621678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x560ee69627cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f96d19ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f96d3bf37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560ee69e1d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x560ee6a15f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x560ee6a2a0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x560ee765624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x560ee761ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x560ee7621678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x560ee69627cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f96d19ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 2448 byte(s) leaked in 50 allocation(s).
```

## Test case 108_PW_RE_MG

### On process id asan.7522

```bash

=================================================================
==7522==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 2400 byte(s) in 2 object(s) allocated from:
    #0 0x7f9b4d2e07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55be90871fb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x55be9087fc76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55be9049fcf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55be904a364e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55be904a4512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55be9049794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55be90cecd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55be90cb4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55be90cb7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55be8fff87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f9b4b0d8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1632 byte(s) in 17 object(s) allocated from:
    #0 0x7f9b4d2e07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55be90487643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55be909f65fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55be904a796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55be9049794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55be90cecd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55be90cb4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55be90cb7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55be8fff87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9b4b0d8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f9b4d2dee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9b4b8c60bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 800 byte(s) in 2 object(s) allocated from:
    #0 0x7f9b4d2e07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55be9087203d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x55be9087fc76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55be9049fcf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55be904a364e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55be904a4512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55be9049794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55be90cecd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55be90cb4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55be90cb7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55be8fff87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f9b4b0d8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 2 object(s) allocated from:
    #0 0x7f9b4d2e07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55be9087207c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x55be9087fc76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55be9049fcf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55be904a364e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55be904a4512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55be9049794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55be90cecd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55be90cb4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55be90cb7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55be8fff87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f9b4b0d8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 192 byte(s) in 2 object(s) allocated from:
    #0 0x7f9b4d2e07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55be90487643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55be909fa4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55be904a796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55be9049794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55be90cecd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55be90cb4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55be90cb7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55be8fff87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9b4b0d8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 136 byte(s) in 17 object(s) allocated from:
    #0 0x7f9b4d2e07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55be904874c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55be909f65fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55be904a796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55be9049794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55be90cecd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55be90cb4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55be90cb7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55be8fff87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9b4b0d8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f9b4d2e07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55be900e35df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55be900bfd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55be90cec24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55be90cb4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55be90cb7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55be8fff87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f9b4b0d8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f9b4d2e07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55be904874c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55be909fa4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55be904a796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55be9049794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55be90cecd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55be90cb4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55be90cb7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55be8fff87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9b4b0d8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f9b4d2e07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55be900e34e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55be900bfd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55be90cec24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55be90cb4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55be90cb7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55be8fff87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f9b4b0d8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f9b4d2e07a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55be900e3578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55be900bfd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55be90cec24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55be90cb4e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55be90cb7678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55be8fff87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f9b4b0d8d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9b4d2dee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9b4b91c94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9b4d2dee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9b4b91c4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 6752 byte(s) leaked in 52 allocation(s).
```

### On process id asan.7523

```bash

=================================================================
==7523==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1632 byte(s) in 17 object(s) allocated from:
    #0 0x7f2f0e5ab7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561579f94643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x56157a5035fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x561579fb496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x561579fa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56157a7f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56157a7c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56157a7c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x561579b057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2f0c3a3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 192 byte(s) in 2 object(s) allocated from:
    #0 0x7f2f0e5ab7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561579f94643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x56157a5074d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x561579fb496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x561579fa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56157a7f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56157a7c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56157a7c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x561579b057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2f0c3a3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 136 byte(s) in 17 object(s) allocated from:
    #0 0x7f2f0e5ab7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561579f944c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x56157a5035fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x561579fb496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x561579fa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56157a7f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56157a7c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56157a7c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x561579b057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2f0c3a3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f2f0e5ab7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561579b84df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x561579bb8f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x561579bcd0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56157a7f924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x56157a7c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x56157a7c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x561579b057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f2f0c3a3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f2f0e5ab7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561579b84df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x561579bb97c9 in UnitCell::bcast_atoms_tau() /workspace/abacus-develop/source/module_cell/unitcell.cpp:404
    #3 0x561579fbba9b in Ions_Move_Basic::move_atoms(double*, double*) /workspace/abacus-develop/source/src_ions/ions_move_basic.cpp:112
    #4 0x561579fc694a in Ions_Move_CG::start(ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_cg.cpp:145
    #5 0x561579fc948d in Ions_Move_Methods::cal_movement(int const&, int const&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_methods.cpp:61
    #6 0x561579fae9b3 in Ions::do_relax(int const&, int&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions.cpp:372
    #7 0x561579fb0542 in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:280
    #8 0x561579fb1512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #9 0x561579fa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #10 0x56157a7f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #11 0x56157a7c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #12 0x56157a7c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #13 0x561579b057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #14 0x7f2f0c3a3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f2f0e5ab7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561579b84d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x561579bb97c9 in UnitCell::bcast_atoms_tau() /workspace/abacus-develop/source/module_cell/unitcell.cpp:404
    #3 0x561579fbba9b in Ions_Move_Basic::move_atoms(double*, double*) /workspace/abacus-develop/source/src_ions/ions_move_basic.cpp:112
    #4 0x561579fc694a in Ions_Move_CG::start(ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_cg.cpp:145
    #5 0x561579fc948d in Ions_Move_Methods::cal_movement(int const&, int const&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_methods.cpp:61
    #6 0x561579fae9b3 in Ions::do_relax(int const&, int&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions.cpp:372
    #7 0x561579fb0542 in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:280
    #8 0x561579fb1512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #9 0x561579fa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #10 0x56157a7f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #11 0x56157a7c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #12 0x56157a7c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #13 0x561579b057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #14 0x7f2f0c3a3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f2f0e5ab7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561579b84d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x561579bb97c9 in UnitCell::bcast_atoms_tau() /workspace/abacus-develop/source/module_cell/unitcell.cpp:404
    #3 0x561579fbba9b in Ions_Move_Basic::move_atoms(double*, double*) /workspace/abacus-develop/source/src_ions/ions_move_basic.cpp:112
    #4 0x561579fc694a in Ions_Move_CG::start(ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_cg.cpp:145
    #5 0x561579fc948d in Ions_Move_Methods::cal_movement(int const&, int const&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions_move_methods.cpp:61
    #6 0x561579fae9b3 in Ions::do_relax(int const&, int&, ModuleBase::matrix const&, double const&) /workspace/abacus-develop/source/src_ions/ions.cpp:372
    #7 0x561579fb0542 in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:280
    #8 0x561579fb1512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #9 0x561579fa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #10 0x56157a7f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #11 0x56157a7c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #12 0x56157a7c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #13 0x561579b057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #14 0x7f2f0c3a3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f2f0e5ab7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561579f944c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x56157a5074d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x561579fb496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x561579fa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56157a7f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56157a7c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56157a7c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x561579b057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2f0c3a3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f2f0e5ab7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561579b84d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x561579bb8f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x561579bcd0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56157a7f924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x56157a7c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x56157a7c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x561579b057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f2f0c3a3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f2f0e5ab7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561579b84d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x561579bb8f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x561579bcd0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x56157a7f924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x56157a7c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x56157a7c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x561579b057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f2f0c3a3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 2136 byte(s) leaked in 44 allocation(s).
```

## Test case 109_PW_CR

### On process id asan.7675

```bash

=================================================================
==7675==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 2400 byte(s) in 2 object(s) allocated from:
    #0 0x7fe8aea587a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ccb941bfb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x55ccb9429c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55ccb9049cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55ccb904d64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55ccb904e512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55ccb904194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55ccb9896d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55ccb985ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55ccb9861678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55ccb8ba27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fe8ac850d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1152 byte(s) in 12 object(s) allocated from:
    #0 0x7fe8aea587a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ccb9031643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55ccb95a05fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55ccb905196d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ccb904194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ccb9896d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ccb985ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ccb9861678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ccb8ba27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fe8ac850d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7fe8aea56e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fe8ad03e0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 800 byte(s) in 2 object(s) allocated from:
    #0 0x7fe8aea587a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ccb941c03d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x55ccb9429c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55ccb9049cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55ccb904d64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55ccb904e512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55ccb904194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55ccb9896d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55ccb985ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55ccb9861678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55ccb8ba27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fe8ac850d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 2 object(s) allocated from:
    #0 0x7fe8aea587a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ccb941c07c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x55ccb9429c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55ccb9049cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55ccb904d64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55ccb904e512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55ccb904194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55ccb9896d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55ccb985ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55ccb9861678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55ccb8ba27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fe8ac850d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 192 byte(s) in 2 object(s) allocated from:
    #0 0x7fe8aea587a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ccb9031643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55ccb95a44d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55ccb905196d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ccb904194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ccb9896d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ccb985ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ccb9861678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ccb8ba27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fe8ac850d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 12 object(s) allocated from:
    #0 0x7fe8aea587a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ccb90314c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55ccb95a05fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55ccb905196d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ccb904194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ccb9896d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ccb985ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ccb9861678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ccb8ba27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fe8ac850d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 64 byte(s) in 1 object(s) allocated from:
    #0 0x7fe8aea587a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ccb952b6ed in wavefunc::allocate(int) /workspace/abacus-develop/source/src_pw/wavefunc.cpp:79
    #2 0x55ccb9041198 in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:8
    #3 0x55ccb9896d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #4 0x55ccb985ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55ccb9861678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55ccb8ba27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fe8ac850d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fe8aea587a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ccb8c8d5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55ccb8c69d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55ccb989624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55ccb985ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55ccb9861678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55ccb8ba27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fe8ac850d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fe8aea587a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ccb90314c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55ccb95a44d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55ccb905196d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ccb904194a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ccb9896d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ccb985ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ccb9861678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ccb8ba27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fe8ac850d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fe8aea587a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ccb8c8d4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55ccb8c69d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55ccb989624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55ccb985ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55ccb9861678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55ccb8ba27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fe8ac850d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fe8aea587a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ccb8c8d578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55ccb8c69d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55ccb989624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55ccb985ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55ccb9861678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55ccb8ba27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fe8ac850d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fe8aea56e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fe8ad09494e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fe8aea56e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fe8ad0944d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

Indirect leak of 512 byte(s) in 8 object(s) allocated from:
    #0 0x7fe8aea587a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ccb952b7a3 in wavefunc::allocate(int) /workspace/abacus-develop/source/src_pw/wavefunc.cpp:82
    #2 0x55ccb9041198 in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:8
    #3 0x55ccb9896d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #4 0x55ccb985ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55ccb9861678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55ccb8ba27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fe8ac850d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 6808 byte(s) leaked in 51 allocation(s).
```

### On process id asan.7676

```bash

=================================================================
==7676==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1152 byte(s) in 12 object(s) allocated from:
    #0 0x7ff43f9ae7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5630b8775643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5630b8ce45fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x5630b879596d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5630b878594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5630b8fdad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5630b8fa2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5630b8fa5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5630b82e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7ff43d7a6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 192 byte(s) in 2 object(s) allocated from:
    #0 0x7ff43f9ae7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5630b8775643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5630b8ce84d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x5630b879596d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5630b878594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5630b8fdad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5630b8fa2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5630b8fa5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5630b82e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7ff43d7a6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 12 object(s) allocated from:
    #0 0x7ff43f9ae7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5630b87754c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5630b8ce45fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x5630b879596d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5630b878594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5630b8fdad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5630b8fa2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5630b8fa5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5630b82e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7ff43d7a6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 64 byte(s) in 1 object(s) allocated from:
    #0 0x7ff43f9ae7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5630b8c6f6ed in wavefunc::allocate(int) /workspace/abacus-develop/source/src_pw/wavefunc.cpp:79
    #2 0x5630b8785198 in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:8
    #3 0x5630b8fdad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #4 0x5630b8fa2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x5630b8fa5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5630b82e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7ff43d7a6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7ff43f9ae7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5630b8365df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x5630b8399f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5630b83ae0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5630b8fda24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5630b8fa2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5630b8fa5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5630b82e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7ff43d7a6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7ff43f9ae7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5630b8365df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x5630b83aba7d in UnitCell_pseudo::setup_cell_after_vc(std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:725
    #3 0x5630b87b4e4d in Variable_Cell::init_after_vc() /workspace/abacus-develop/source/src_ions/variable_cell.cpp:12
    #4 0x5630b8790d3d in Ions::reset_after_cellrelax(int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:404
    #5 0x5630b87916ae in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:296
    #6 0x5630b8792512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #7 0x5630b878594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #8 0x5630b8fdad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #9 0x5630b8fa2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #10 0x5630b8fa5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #11 0x5630b82e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #12 0x7ff43d7a6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7ff43f9ae7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5630b8365d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x5630b83aba7d in UnitCell_pseudo::setup_cell_after_vc(std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:725
    #3 0x5630b87b4e4d in Variable_Cell::init_after_vc() /workspace/abacus-develop/source/src_ions/variable_cell.cpp:12
    #4 0x5630b8790d3d in Ions::reset_after_cellrelax(int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:404
    #5 0x5630b87916ae in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:296
    #6 0x5630b8792512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #7 0x5630b878594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #8 0x5630b8fdad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #9 0x5630b8fa2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #10 0x5630b8fa5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #11 0x5630b82e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #12 0x7ff43d7a6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7ff43f9ae7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5630b8365d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x5630b83aba7d in UnitCell_pseudo::setup_cell_after_vc(std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:725
    #3 0x5630b87b4e4d in Variable_Cell::init_after_vc() /workspace/abacus-develop/source/src_ions/variable_cell.cpp:12
    #4 0x5630b8790d3d in Ions::reset_after_cellrelax(int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:404
    #5 0x5630b87916ae in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:296
    #6 0x5630b8792512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #7 0x5630b878594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #8 0x5630b8fdad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #9 0x5630b8fa2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #10 0x5630b8fa5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #11 0x5630b82e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #12 0x7ff43d7a6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7ff43f9ae7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5630b8365d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x5630b8399f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5630b83ae0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5630b8fda24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5630b8fa2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5630b8fa5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5630b82e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7ff43d7a6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7ff43f9ae7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5630b87754c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5630b8ce84d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x5630b879596d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5630b878594a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5630b8fdad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5630b8fa2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5630b8fa5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5630b82e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7ff43d7a6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7ff43f9ae7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5630b8365d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x5630b8399f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5630b83ae0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5630b8fda24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5630b8fa2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5630b8fa5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5630b82e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7ff43d7a6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 512 byte(s) in 8 object(s) allocated from:
    #0 0x7ff43f9ae7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5630b8c6f7a3 in wavefunc::allocate(int) /workspace/abacus-develop/source/src_pw/wavefunc.cpp:82
    #2 0x5630b8785198 in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:8
    #3 0x5630b8fdad1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #4 0x5630b8fa2e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x5630b8fa5678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5630b82e67cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7ff43d7a6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 2192 byte(s) leaked in 43 allocation(s).
```

## Test case 110_PW_SY_symmetry

### On process id asan.7874

```bash

=================================================================
==7874==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f2032434e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f2030a1c0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 672 byte(s) in 7 object(s) allocated from:
    #0 0x7f20324367a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556319d19643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55631a2885fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x556319d3996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x556319d2994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55631a57ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55631a546e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55631a549678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55631988a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f203022ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f20324367a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556319d19643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55631a28c4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x556319d3996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x556319d2994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55631a57ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55631a546e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55631a549678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55631988a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f203022ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 56 byte(s) in 7 object(s) allocated from:
    #0 0x7f20324367a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556319d194c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55631a2885fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x556319d3996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x556319d2994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55631a57ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55631a546e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55631a549678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55631988a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f203022ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f20324367a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5563199755df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x556319951d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55631a57e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55631a546e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55631a549678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55631988a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f203022ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f20324367a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5563199754e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x556319951d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55631a57e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55631a546e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55631a549678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55631988a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f203022ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f20324367a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556319975578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x556319951d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55631a57e24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55631a546e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55631a549678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55631988a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f203022ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f20324367a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556319d194c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55631a28c4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x556319d3996d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x556319d2994a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55631a57ed1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55631a546e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55631a549678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55631988a7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f203022ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f2032434e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f2030a7294e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f2032434e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f2030a724d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 2008 byte(s) leaked in 24 allocation(s).
```

### On process id asan.7875

```bash

=================================================================
==7875==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 672 byte(s) in 7 object(s) allocated from:
    #0 0x7fea086157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55638202b643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55638259a5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55638204b96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55638203b94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x556382890d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x556382858e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55638285b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x556381b9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fea0640dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fea086157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55638202b643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55638259e4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55638204b96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55638203b94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x556382890d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x556382858e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55638285b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x556381b9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fea0640dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 56 byte(s) in 7 object(s) allocated from:
    #0 0x7fea086157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55638202b4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55638259a5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55638204b96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55638203b94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x556382890d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x556382858e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55638285b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x556381b9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fea0640dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fea086157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556381c1bdf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x556381c4ff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x556381c640b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55638289024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x556382858e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55638285b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x556381b9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fea0640dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fea086157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556381c1bd86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x556381c4ff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x556381c640b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55638289024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x556382858e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55638285b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x556381b9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fea0640dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fea086157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556381c1bd20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x556381c4ff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x556381c640b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55638289024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x556382858e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55638285b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x556381b9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fea0640dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fea086157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55638202b4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55638259e4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55638204b96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55638203b94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x556382890d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x556382858e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55638285b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x556381b9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fea0640dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 912 byte(s) leaked in 19 allocation(s).
```

## Test case 111_PW_elec_add

### On process id asan.7988

```bash

=================================================================
==7988==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7f9d67b767a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560caa68cfb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x560caa69ac76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x560caa2bacf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x560caa2be64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x560caa2bf512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x560caa2b294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x560caab07d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x560caaacfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x560caaad2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x560ca9e137cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f9d6596ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f9d67b74e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9d6615c0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 864 byte(s) in 9 object(s) allocated from:
    #0 0x7f9d67b767a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560caa2a2643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x560caa8115fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x560caa2c296d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x560caa2b294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x560caab07d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x560caaacfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x560caaad2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560ca9e137cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9d6596ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7f9d67b767a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560caa68d03d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x560caa69ac76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x560caa2bacf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x560caa2be64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x560caa2bf512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x560caa2b294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x560caab07d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x560caaacfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x560caaad2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x560ca9e137cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f9d6596ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7f9d67b767a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560caa68d07c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x560caa69ac76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x560caa2bacf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x560caa2be64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x560caa2bf512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x560caa2b294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x560caab07d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x560caaacfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x560caaad2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x560ca9e137cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f9d6596ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f9d67b767a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560caa2a2643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x560caa8154d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x560caa2c296d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x560caa2b294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x560caab07d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x560caaacfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x560caaad2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560ca9e137cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9d6596ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 9 object(s) allocated from:
    #0 0x7f9d67b767a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560caa2a24c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x560caa8115fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x560caa2c296d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x560caa2b294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x560caab07d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x560caaacfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x560caaad2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560ca9e137cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9d6596ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f9d67b767a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560ca9efe5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x560ca9edad76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x560caab0724e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x560caaacfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x560caaad2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x560ca9e137cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f9d6596ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f9d67b767a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560ca9efe4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x560ca9edad76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x560caab0724e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x560caaacfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x560caaad2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x560ca9e137cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f9d6596ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f9d67b767a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560ca9efe578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x560ca9edad76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x560caab0724e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x560caaacfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x560caaad2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x560ca9e137cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f9d6596ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9d67b767a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x560caa2a24c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x560caa8154d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x560caa2c296d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x560caa2b294a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x560caab07d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x560caaacfe39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x560caaad2678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x560ca9e137cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9d6596ed09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9d67b74e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9d661b294e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9d67b74e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9d661b24d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 4016 byte(s) leaked in 31 allocation(s).
```

### On process id asan.7989

```bash

=================================================================
==7989==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 864 byte(s) in 9 object(s) allocated from:
    #0 0x7f2b398c87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55976a7ec643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55976ad5b5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55976a80c96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55976a7fc94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55976b051d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55976b019e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55976b01c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55976a35d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2b376c0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f2b398c87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55976a7ec643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55976ad5f4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55976a80c96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55976a7fc94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55976b051d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55976b019e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55976b01c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55976a35d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2b376c0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 9 object(s) allocated from:
    #0 0x7f2b398c87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55976a7ec4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55976ad5b5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55976a80c96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55976a7fc94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55976b051d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55976b019e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55976b01c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55976a35d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2b376c0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f2b398c87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55976a3dcdf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55976a410f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55976a4250b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55976b05124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55976b019e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55976b01c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55976a35d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f2b376c0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f2b398c87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55976a3dcd86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55976a410f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55976a4250b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55976b05124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55976b019e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55976b01c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55976a35d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f2b376c0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f2b398c87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55976a3dcd20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55976a410f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55976a4250b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55976b05124e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55976b019e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55976b01c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55976a35d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f2b376c0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f2b398c87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55976a7ec4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55976ad5f4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55976a80c96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55976a7fc94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55976b051d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55976b019e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55976b01c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55976a35d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2b376c0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 1120 byte(s) leaked in 23 allocation(s).
```

## Test case 111_PW_elec_minus

### On process id asan.8187

```bash

=================================================================
==8187==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7fb13f5aa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ea025f8fb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x55ea02606c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55ea02226cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55ea0222a64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55ea0222b512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55ea0221e94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55ea02a73d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55ea02a3be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55ea02a3e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55ea01d7f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fb13d3a2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7fb13f5a8e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fb13db900bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 960 byte(s) in 10 object(s) allocated from:
    #0 0x7fb13f5aa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ea0220e643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55ea0277d5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55ea0222e96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ea0221e94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ea02a73d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ea02a3be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ea02a3e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ea01d7f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb13d3a2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7fb13f5aa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ea025f903d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x55ea02606c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55ea02226cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55ea0222a64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55ea0222b512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55ea0221e94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55ea02a73d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55ea02a3be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55ea02a3e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55ea01d7f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fb13d3a2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7fb13f5aa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ea025f907c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x55ea02606c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55ea02226cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55ea0222a64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55ea0222b512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55ea0221e94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55ea02a73d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55ea02a3be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55ea02a3e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55ea01d7f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fb13d3a2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fb13f5aa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ea0220e643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55ea027814d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55ea0222e96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ea0221e94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ea02a73d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ea02a3be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ea02a3e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ea01d7f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb13d3a2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 80 byte(s) in 10 object(s) allocated from:
    #0 0x7fb13f5aa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ea0220e4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55ea0277d5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55ea0222e96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ea0221e94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ea02a73d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ea02a3be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ea02a3e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ea01d7f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb13d3a2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7fb13f5aa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ea01e6a5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55ea01e46d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55ea02a7324e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55ea02a3be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55ea02a3e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55ea01d7f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fb13d3a2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fb13f5aa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ea0220e4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55ea027814d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55ea0222e96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ea0221e94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ea02a73d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ea02a3be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ea02a3e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ea01d7f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb13d3a2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fb13f5aa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ea01e6a4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55ea01e46d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55ea02a7324e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55ea02a3be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55ea02a3e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55ea01d7f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fb13d3a2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fb13f5aa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ea01e6a578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55ea01e46d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55ea02a7324e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55ea02a3be39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55ea02a3e678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55ea01d7f7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fb13d3a2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fb13f5a8e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fb13dbe694e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fb13f5a8e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fb13dbe64d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 4080 byte(s) leaked in 33 allocation(s).
```

### On process id asan.8188

```bash

=================================================================
==8188==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 960 byte(s) in 10 object(s) allocated from:
    #0 0x7f58ac54f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e8c42ab643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55e8c481a5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55e8c42cb96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e8c42bb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e8c4b10d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e8c4ad8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e8c4adb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e8c3e1c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f58aa347d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f58ac54f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e8c42ab643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55e8c481e4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55e8c42cb96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e8c42bb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e8c4b10d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e8c4ad8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e8c4adb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e8c3e1c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f58aa347d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 80 byte(s) in 10 object(s) allocated from:
    #0 0x7f58ac54f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e8c42ab4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55e8c481a5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55e8c42cb96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e8c42bb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e8c4b10d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e8c4ad8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e8c4adb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e8c3e1c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f58aa347d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f58ac54f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e8c3e9bdf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55e8c3ecff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55e8c3ee40b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55e8c4b1024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55e8c4ad8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55e8c4adb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55e8c3e1c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f58aa347d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f58ac54f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e8c42ab4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55e8c481e4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55e8c42cb96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e8c42bb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e8c4b10d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e8c4ad8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e8c4adb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e8c3e1c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f58aa347d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f58ac54f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e8c3e9bd86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55e8c3ecff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55e8c3ee40b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55e8c4b1024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55e8c4ad8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55e8c4adb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55e8c3e1c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f58aa347d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f58ac54f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e8c3e9bd20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55e8c3ecff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55e8c3ee40b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55e8c4b1024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55e8c4ad8e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55e8c4adb678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55e8c3e1c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f58aa347d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 1184 byte(s) leaked in 25 allocation(s).
```

## Test case 111_PW_S2_elec_add

### On process id asan.8376

```bash

=================================================================
==8376==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1920 byte(s) in 20 object(s) allocated from:
    #0 0x7f9a0bde47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559863d4a643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5598642b95fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x559863d6a96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x559863d5a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5598645afd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x559864577e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55986457a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5598638bb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9a09bdcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7f9a0bde47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559864134fb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x559864142c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x559863d62cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x559863d6664e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x559863d67512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x559863d5a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x5598645afd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x559864577e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55986457a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x5598638bb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f9a09bdcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f9a0bde2e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9a0a3ca0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7f9a0bde47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55986413503d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x559864142c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x559863d62cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x559863d6664e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x559863d67512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x559863d5a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x5598645afd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x559864577e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55986457a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x5598638bb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f9a09bdcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7f9a0bde47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55986413507c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x559864142c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x559863d62cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x559863d6664e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x559863d67512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x559863d5a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x5598645afd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x559864577e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55986457a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x5598638bb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f9a09bdcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 192 byte(s) in 2 object(s) allocated from:
    #0 0x7f9a0bde47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559863d4a643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5598642bd4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x559863d6a96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x559863d5a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5598645afd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x559864577e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55986457a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5598638bb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9a09bdcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 160 byte(s) in 20 object(s) allocated from:
    #0 0x7f9a0bde47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559863d4a4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5598642b95fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x559863d6a96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x559863d5a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5598645afd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x559864577e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55986457a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5598638bb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9a09bdcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f9a0bde47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5598639a65df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x559863982d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x5598645af24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x559864577e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55986457a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5598638bb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f9a09bdcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f9a0bde47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x559863d4a4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5598642bd4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x559863d6a96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x559863d5a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5598645afd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x559864577e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55986457a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5598638bb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9a09bdcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f9a0bde47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5598639a64e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x559863982d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x5598645af24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x559864577e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55986457a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5598638bb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f9a09bdcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f9a0bde47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5598639a6578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x559863982d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x5598645af24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x559864577e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55986457a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5598638bb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f9a09bdcd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9a0bde2e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9a0a42094e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9a0bde2e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9a0a4204d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 5264 byte(s) leaked in 55 allocation(s).
```

### On process id asan.8377

```bash

=================================================================
==8377==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1920 byte(s) in 20 object(s) allocated from:
    #0 0x7fc7e8abb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c3506cf643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55c350c3e5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55c3506ef96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c3506df94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c350f34d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c350efce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c350eff678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c3502407cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc7e68b3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 192 byte(s) in 2 object(s) allocated from:
    #0 0x7fc7e8abb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c3506cf643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55c350c424d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55c3506ef96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c3506df94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c350f34d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c350efce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c350eff678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c3502407cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc7e68b3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 160 byte(s) in 20 object(s) allocated from:
    #0 0x7fc7e8abb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c3506cf4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55c350c3e5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55c3506ef96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c3506df94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c350f34d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c350efce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c350eff678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c3502407cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc7e68b3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fc7e8abb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c3502bfdf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55c3502f3f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55c3503080b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55c350f3424e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55c350efce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55c350eff678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55c3502407cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fc7e68b3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fc7e8abb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c3506cf4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55c350c424d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55c3506ef96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c3506df94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c350f34d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c350efce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c350eff678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c3502407cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc7e68b3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fc7e8abb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c3502bfd86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55c3502f3f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55c3503080b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55c350f3424e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55c350efce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55c350eff678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55c3502407cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fc7e68b3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fc7e8abb7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c3502bfd20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55c3502f3f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55c3503080b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55c350f3424e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55c350efce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55c350eff678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55c3502407cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fc7e68b3d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 2368 byte(s) leaked in 47 allocation(s).
```

## Test case 111_PW_S2_elec_minus

### On process id asan.8575

```bash

=================================================================
==8575==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1920 byte(s) in 20 object(s) allocated from:
    #0 0x7fba6a9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f89d320643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55f89d88f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55f89d34096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55f89d33094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55f89db85d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55f89db4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55f89db50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55f89ce917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fba687a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7fba6a9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f89d70afb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x55f89d718c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55f89d338cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55f89d33c64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55f89d33d512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55f89d33094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55f89db85d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55f89db4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55f89db50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55f89ce917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fba687a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7fba6a9ade8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fba68f950bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7fba6a9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f89d70b03d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x55f89d718c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55f89d338cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55f89d33c64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55f89d33d512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55f89d33094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55f89db85d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55f89db4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55f89db50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55f89ce917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fba687a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7fba6a9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f89d70b07c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x55f89d718c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55f89d338cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55f89d33c64e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55f89d33d512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55f89d33094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55f89db85d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55f89db4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55f89db50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55f89ce917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fba687a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 192 byte(s) in 2 object(s) allocated from:
    #0 0x7fba6a9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f89d320643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55f89d8934d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55f89d34096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55f89d33094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55f89db85d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55f89db4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55f89db50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55f89ce917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fba687a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 160 byte(s) in 20 object(s) allocated from:
    #0 0x7fba6a9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f89d3204c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55f89d88f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55f89d34096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55f89d33094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55f89db85d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55f89db4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55f89db50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55f89ce917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fba687a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7fba6a9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f89cf7c5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55f89cf58d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55f89db8524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55f89db4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55f89db50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55f89ce917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fba687a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fba6a9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f89d3204c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55f89d8934d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55f89d34096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55f89d33094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55f89db85d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55f89db4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55f89db50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55f89ce917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fba687a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fba6a9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f89cf7c4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55f89cf58d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55f89db8524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55f89db4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55f89db50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55f89ce917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fba687a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fba6a9af7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55f89cf7c578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55f89cf58d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55f89db8524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55f89db4de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55f89db50678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55f89ce917cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fba687a7d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fba6a9ade8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fba68feb94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fba6a9ade8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fba68feb4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 5224 byte(s) leaked in 55 allocation(s).
```

### On process id asan.8576

```bash

=================================================================
==8576==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1920 byte(s) in 20 object(s) allocated from:
    #0 0x7eff2cf657a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db63c96643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55db642055fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55db63cb696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55db63ca694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55db644fbd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55db644c3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55db644c6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55db638077cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7eff2ad5dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 192 byte(s) in 2 object(s) allocated from:
    #0 0x7eff2cf657a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db63c96643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55db642094d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55db63cb696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55db63ca694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55db644fbd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55db644c3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55db644c6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55db638077cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7eff2ad5dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 160 byte(s) in 20 object(s) allocated from:
    #0 0x7eff2cf657a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db63c964c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55db642055fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55db63cb696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55db63ca694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55db644fbd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55db644c3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55db644c6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55db638077cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7eff2ad5dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7eff2cf657a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db63886df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55db638baf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55db638cf0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55db644fb24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55db644c3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55db644c6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55db638077cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7eff2ad5dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7eff2cf657a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db63c964c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55db642094d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55db63cb696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55db63ca694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55db644fbd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55db644c3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55db644c6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55db638077cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7eff2ad5dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7eff2cf657a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db63886d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55db638baf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55db638cf0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55db644fb24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55db644c3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55db644c6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55db638077cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7eff2ad5dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7eff2cf657a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db63886d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55db638baf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55db638cf0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55db644fb24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55db644c3e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55db644c6678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55db638077cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7eff2ad5dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 2328 byte(s) leaked in 47 allocation(s).
```

## Test case 114_PW_BD_15

### On process id asan.8764

```bash

=================================================================
==8764==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f27684abe8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f2766a930bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 960 byte(s) in 10 object(s) allocated from:
    #0 0x7f27684ad7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564cf4ec0643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x564cf542f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x564cf4ee096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x564cf4ed094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x564cf5725d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x564cf56ede39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x564cf56f0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x564cf4a317cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f27662a5d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f27684ad7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564cf4ec0643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x564cf54334d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x564cf4ee096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x564cf4ed094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x564cf5725d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x564cf56ede39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x564cf56f0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x564cf4a317cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f27662a5d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 80 byte(s) in 10 object(s) allocated from:
    #0 0x7f27684ad7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564cf4ec04c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x564cf542f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x564cf4ee096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x564cf4ed094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x564cf5725d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x564cf56ede39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x564cf56f0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x564cf4a317cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f27662a5d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f27684ad7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564cf4b1c5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x564cf4af8d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x564cf572524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x564cf56ede39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x564cf56f0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x564cf4a317cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f27662a5d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f27684ad7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564cf4b1c4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x564cf4af8d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x564cf572524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x564cf56ede39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x564cf56f0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x564cf4a317cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f27662a5d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f27684ad7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564cf4b1c578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x564cf4af8d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x564cf572524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x564cf56ede39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x564cf56f0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x564cf4a317cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f27662a5d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f27684ad7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564cf4ec04c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x564cf54334d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x564cf4ee096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x564cf4ed094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x564cf5725d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x564cf56ede39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x564cf56f0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x564cf4a317cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f27662a5d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f27684abe8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f2766ae994e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f27684abe8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f2766ae94d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 2320 byte(s) leaked in 30 allocation(s).
```

### On process id asan.8765

```bash

=================================================================
==8765==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 960 byte(s) in 10 object(s) allocated from:
    #0 0x7f1b871807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bceeca0643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55bcef20f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55bceecc096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55bceecb094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55bcef505d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55bcef4cde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55bcef4d0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55bcee8117cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f1b84f78d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f1b871807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bceeca0643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55bcef2134d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55bceecc096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55bceecb094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55bcef505d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55bcef4cde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55bcef4d0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55bcee8117cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f1b84f78d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 80 byte(s) in 10 object(s) allocated from:
    #0 0x7f1b871807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bceeca04c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55bcef20f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55bceecc096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55bceecb094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55bcef505d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55bcef4cde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55bcef4d0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55bcee8117cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f1b84f78d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f1b871807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bcee890df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55bcee8c4f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55bcee8d90b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55bcef50524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55bcef4cde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55bcef4d0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55bcee8117cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f1b84f78d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f1b871807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bcee890d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55bcee8c4f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55bcee8d90b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55bcef50524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55bcef4cde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55bcef4d0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55bcee8117cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f1b84f78d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f1b871807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bcee890d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55bcee8c4f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55bcee8d90b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55bcef50524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55bcef4cde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55bcef4d0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55bcee8117cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f1b84f78d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f1b871807a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bceeca04c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55bcef2134d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55bceecc096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55bceecb094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55bcef505d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55bcef4cde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55bcef4d0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55bcee8117cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f1b84f78d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 1224 byte(s) leaked in 25 allocation(s).
```

## Test case 120_PW_KP_MD_FIRE

### On process id asan.8877

```bash

=================================================================
==8877==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc31c4fb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x562dc31d2c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x562dc332b96e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x562dc2a97f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x562dc3325056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc31c4fb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x562dc31d2c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x562dc332b96e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x562dc2a97f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x562dc2aa9295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x562dc2accbd1 in FIRE::setup() /workspace/abacus-develop/source/module_md/FIRE.cpp:24
    #7 0x562dc3324d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f88bf819e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f88bde010bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 768 byte(s) in 8 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc2dda643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x562dc33495fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x562dc332bd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x562dc2a97f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x562dc2aa9295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x562dc2accbd1 in FIRE::setup() /workspace/abacus-develop/source/module_md/FIRE.cpp:24
    #7 0x562dc3324d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc31c503d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x562dc31d2c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x562dc332b96e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x562dc2a97f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x562dc2aa9295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x562dc2accbd1 in FIRE::setup() /workspace/abacus-develop/source/module_md/FIRE.cpp:24
    #7 0x562dc3324d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc31c503d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x562dc31d2c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x562dc332b96e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x562dc2a97f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x562dc3325056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 384 byte(s) in 4 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc2dda643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x562dc33495fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x562dc332bd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x562dc2a97f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x562dc3325056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 224 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b647 in operator new(unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:99
    #1 0x562dc3328599 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:55
    #2 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #3 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #4 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc31c507c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x562dc31d2c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x562dc332b96e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x562dc2a97f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x562dc3325056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc31c507c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x562dc31d2c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x562dc332b96e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x562dc2a97f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x562dc2aa9295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x562dc2accbd1 in FIRE::setup() /workspace/abacus-develop/source/module_md/FIRE.cpp:24
    #7 0x562dc3324d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc2dda643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x562dc334d4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x562dc332bd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x562dc2a97f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x562dc3325056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc2dda643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x562dc334d4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x562dc332bd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x562dc2a97f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x562dc2aa9295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x562dc2accbd1 in FIRE::setup() /workspace/abacus-develop/source/module_md/FIRE.cpp:24
    #7 0x562dc3324d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 64 byte(s) in 8 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc2dda4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x562dc33495fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x562dc332bd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x562dc2a97f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x562dc2aa9295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x562dc2accbd1 in FIRE::setup() /workspace/abacus-develop/source/module_md/FIRE.cpp:24
    #7 0x562dc3324d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc2a365df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x562dc2a12d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x562dc363f24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 32 byte(s) in 4 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc2dda4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x562dc33495fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x562dc332bd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x562dc2a97f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x562dc3325056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc2a364e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x562dc2a12d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x562dc363f24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc2a36578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x562dc2a12d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x562dc363f24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc2dda4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x562dc334d4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x562dc332bd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x562dc2a97f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x562dc2aa9295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x562dc2accbd1 in FIRE::setup() /workspace/abacus-develop/source/module_md/FIRE.cpp:24
    #7 0x562dc3324d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf819e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f88bde5794e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf819e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f88bde574d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc2dda4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x562dc334d4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x562dc332bd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x562dc2a97f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x562dc3325056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc298c8f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:147
    #2 0x562dc298c8f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:129
    #3 0x562dc2aaa0aa in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:16
    #4 0x562dc2ac6751 in FIRE::FIRE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/FIRE.cpp:4
    #5 0x562dc33285b2 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:55
    #6 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc298c294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:62
    #2 0x562dc298c294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:54
    #3 0x562dc298d4ae in ModuleBase::operator*(double const&, ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:231
    #4 0x562dc332bbf1 in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:344
    #5 0x562dc2a97f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #6 0x562dc3325056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #7 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #8 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #9 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #10 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #11 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #12 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc2aa9fe1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:14
    #2 0x562dc2ac6751 in FIRE::FIRE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/FIRE.cpp:4
    #3 0x562dc33285b2 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:55
    #4 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc2aa9db1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:12
    #2 0x562dc2ac6751 in FIRE::FIRE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/FIRE.cpp:4
    #3 0x562dc33285b2 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:55
    #4 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc2aa9cb5 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:11
    #2 0x562dc2ac6751 in FIRE::FIRE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/FIRE.cpp:4
    #3 0x562dc33285b2 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:55
    #4 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc2aa9eb1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:13
    #2 0x562dc2ac6751 in FIRE::FIRE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/FIRE.cpp:4
    #3 0x562dc33285b2 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:55
    #4 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f88bf81b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x562dc2aa9c31 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:10
    #2 0x562dc2ac6751 in FIRE::FIRE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/FIRE.cpp:4
    #3 0x562dc33285b2 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:55
    #4 0x562dc332a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x562dc364014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x562dc3607e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x562dc360a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x562dc294b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f88bd613d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 6784 byte(s) leaked in 50 allocation(s).
```

### On process id asan.8878

```bash

=================================================================
==8878==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 768 byte(s) in 8 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872ed60643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55872f2cf5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55872f2b1d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55872ea1df44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55872ea2f295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55872ea52bd1 in FIRE::setup() /workspace/abacus-develop/source/module_md/FIRE.cpp:24
    #7 0x55872f2aad55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55872f2b08d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55872f5c614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 384 byte(s) in 4 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872ed60643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55872f2cf5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55872f2b1d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55872ea1df44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55872f2ab056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55872f2b08d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55872f5c614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 224 byte(s) in 1 object(s) allocated from:
    #0 0x7f8aa2219647 in operator new(unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:99
    #1 0x55872f2ae599 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:55
    #2 0x55872f2b08d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #3 0x55872f5c614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #4 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872ed60643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55872f2d34d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55872f2b1d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55872ea1df44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55872f2ab056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55872f2b08d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55872f5c614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872ed60643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55872f2d34d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55872f2b1d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55872ea1df44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55872ea2f295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55872ea52bd1 in FIRE::setup() /workspace/abacus-develop/source/module_md/FIRE.cpp:24
    #7 0x55872f2aad55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55872f2b08d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55872f5c614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 64 byte(s) in 8 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872ed604c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55872f2cf5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55872f2b1d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55872ea1df44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55872ea2f295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55872ea52bd1 in FIRE::setup() /workspace/abacus-develop/source/module_md/FIRE.cpp:24
    #7 0x55872f2aad55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55872f2b08d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55872f5c614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872e950df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55872e984f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55872e9990b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55872f5c524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 32 byte(s) in 4 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872ed604c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55872f2cf5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55872f2b1d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55872ea1df44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55872f2ab056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55872f2b08d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55872f5c614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872e950d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55872e984f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55872e9990b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55872f5c524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872e950d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55872e984f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55872e9990b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55872f5c524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872ed604c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55872f2d34d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55872f2b1d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55872ea1df44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55872f2ab056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55872f2b08d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55872f5c614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872ed604c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55872f2d34d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55872f2b1d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55872ea1df44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55872ea2f295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55872ea52bd1 in FIRE::setup() /workspace/abacus-develop/source/module_md/FIRE.cpp:24
    #7 0x55872f2aad55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55872f2b08d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55872f5c614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872e912294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:62
    #2 0x55872e912294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:54
    #3 0x55872e9134ae in ModuleBase::operator*(double const&, ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:231
    #4 0x55872f2b1bf1 in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:344
    #5 0x55872ea1df44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #6 0x55872f2ab056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #7 0x55872f2b08d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #8 0x55872f5c614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #9 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #10 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #11 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #12 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872e9128f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:147
    #2 0x55872e9128f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:129
    #3 0x55872ea300aa in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:16
    #4 0x55872ea4c751 in FIRE::FIRE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/FIRE.cpp:4
    #5 0x55872f2ae5b2 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:55
    #6 0x55872f2b08d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55872f5c614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872ea2ffe1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:14
    #2 0x55872ea4c751 in FIRE::FIRE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/FIRE.cpp:4
    #3 0x55872f2ae5b2 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:55
    #4 0x55872f2b08d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55872f5c614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872ea2fdb1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:12
    #2 0x55872ea4c751 in FIRE::FIRE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/FIRE.cpp:4
    #3 0x55872f2ae5b2 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:55
    #4 0x55872f2b08d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55872f5c614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872ea2fcb5 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:11
    #2 0x55872ea4c751 in FIRE::FIRE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/FIRE.cpp:4
    #3 0x55872f2ae5b2 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:55
    #4 0x55872f2b08d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55872f5c614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872ea2feb1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:13
    #2 0x55872ea4c751 in FIRE::FIRE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/FIRE.cpp:4
    #3 0x55872f2ae5b2 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:55
    #4 0x55872f2b08d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55872f5c614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f8aa22197a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55872ea2fc31 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:10
    #2 0x55872ea4c751 in FIRE::FIRE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/FIRE.cpp:4
    #3 0x55872f2ae5b2 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:55
    #4 0x55872f2b08d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55872f5c614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55872f58de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55872f590678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55872e8d17cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8aa0011d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 2088 byte(s) leaked in 39 allocation(s).
```

## Test case 120_PW_KP_MD_NVE

### On process id asan.9076

```bash

=================================================================
==9076==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c716fafb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x563c71708c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x563c7186196e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x563c70fcdf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x563c7185b056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c716fafb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x563c71708c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x563c7186196e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x563c70fcdf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x563c70fdf295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x563c70fe6b0e in NVE::setup() /workspace/abacus-develop/source/module_md/NVE.cpp:13
    #7 0x563c7185ad55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7feb8cd3ce8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7feb8b3240bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 768 byte(s) in 8 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c71310643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x563c7187f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x563c71861d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x563c70fcdf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x563c70fdf295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x563c70fe6b0e in NVE::setup() /workspace/abacus-develop/source/module_md/NVE.cpp:13
    #7 0x563c7185ad55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c716fb03d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x563c71708c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x563c7186196e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x563c70fcdf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x563c70fdf295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x563c70fe6b0e in NVE::setup() /workspace/abacus-develop/source/module_md/NVE.cpp:13
    #7 0x563c7185ad55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c716fb03d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x563c71708c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x563c7186196e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x563c70fcdf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x563c7185b056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 384 byte(s) in 4 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c71310643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x563c7187f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x563c71861d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x563c70fcdf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x563c7185b056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c716fb07c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x563c71708c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x563c7186196e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x563c70fcdf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x563c7185b056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c716fb07c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x563c71708c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x563c7186196e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x563c70fcdf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x563c70fdf295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x563c70fe6b0e in NVE::setup() /workspace/abacus-develop/source/module_md/NVE.cpp:13
    #7 0x563c7185ad55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 152 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e647 in operator new(unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:99
    #1 0x563c7185e569 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:59
    #2 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #3 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #4 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c71310643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x563c718834d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x563c71861d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x563c70fcdf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x563c7185b056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c71310643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x563c718834d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x563c71861d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x563c70fcdf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x563c70fdf295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x563c70fe6b0e in NVE::setup() /workspace/abacus-develop/source/module_md/NVE.cpp:13
    #7 0x563c7185ad55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 64 byte(s) in 8 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c713104c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x563c7187f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x563c71861d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x563c70fcdf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x563c70fdf295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x563c70fe6b0e in NVE::setup() /workspace/abacus-develop/source/module_md/NVE.cpp:13
    #7 0x563c7185ad55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c70f6c5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x563c70f48d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x563c71b7524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 32 byte(s) in 4 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c713104c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x563c7187f5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x563c71861d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x563c70fcdf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x563c7185b056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c70f6c4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x563c70f48d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x563c71b7524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c70f6c578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x563c70f48d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x563c71b7524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c713104c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x563c718834d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x563c71861d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x563c70fcdf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x563c70fdf295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x563c70fe6b0e in NVE::setup() /workspace/abacus-develop/source/module_md/NVE.cpp:13
    #7 0x563c7185ad55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3ce8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7feb8b37a94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3ce8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7feb8b37a4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c713104c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x563c718834d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x563c71861d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x563c70fcdf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x563c7185b056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c70ec28f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:147
    #2 0x563c70ec28f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:129
    #3 0x563c70fe00aa in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:16
    #4 0x563c70fe6501 in NVE::NVE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVE.cpp:4
    #5 0x563c7185e582 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:59
    #6 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c70ec2294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:62
    #2 0x563c70ec2294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:54
    #3 0x563c70ec34ae in ModuleBase::operator*(double const&, ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:231
    #4 0x563c71861bf1 in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:344
    #5 0x563c70fcdf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #6 0x563c7185b056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #7 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #8 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #9 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #10 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #11 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #12 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c70fdffe1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:14
    #2 0x563c70fe6501 in NVE::NVE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVE.cpp:4
    #3 0x563c7185e582 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:59
    #4 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c70fdfdb1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:12
    #2 0x563c70fe6501 in NVE::NVE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVE.cpp:4
    #3 0x563c7185e582 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:59
    #4 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c70fdfcb5 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:11
    #2 0x563c70fe6501 in NVE::NVE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVE.cpp:4
    #3 0x563c7185e582 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:59
    #4 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c70fdfeb1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:13
    #2 0x563c70fe6501 in NVE::NVE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVE.cpp:4
    #3 0x563c7185e582 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:59
    #4 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7feb8cd3e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x563c70fdfc31 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:10
    #2 0x563c70fe6501 in NVE::NVE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVE.cpp:4
    #3 0x563c7185e582 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:59
    #4 0x563c718608d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x563c71b7614b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x563c71b3de39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x563c71b40678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x563c70e817cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7feb8ab36d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 6712 byte(s) leaked in 50 allocation(s).
```

### On process id asan.9077

```bash

=================================================================
==9077==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 768 byte(s) in 8 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f34b17643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x564f350865fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x564f35068d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x564f347d4f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x564f347e6295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x564f347edb0e in NVE::setup() /workspace/abacus-develop/source/module_md/NVE.cpp:13
    #7 0x564f35061d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x564f350678d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x564f3537d14b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 384 byte(s) in 4 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f34b17643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x564f350865fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x564f35068d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x564f347d4f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x564f35062056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x564f350678d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x564f3537d14b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 152 byte(s) in 1 object(s) allocated from:
    #0 0x7fb64205c647 in operator new(unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:99
    #1 0x564f35065569 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:59
    #2 0x564f350678d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #3 0x564f3537d14b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #4 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f34b17643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x564f3508a4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x564f35068d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x564f347d4f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x564f35062056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x564f350678d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x564f3537d14b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f34b17643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x564f3508a4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x564f35068d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x564f347d4f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x564f347e6295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x564f347edb0e in NVE::setup() /workspace/abacus-develop/source/module_md/NVE.cpp:13
    #7 0x564f35061d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x564f350678d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x564f3537d14b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 64 byte(s) in 8 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f34b174c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x564f350865fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x564f35068d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x564f347d4f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x564f347e6295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x564f347edb0e in NVE::setup() /workspace/abacus-develop/source/module_md/NVE.cpp:13
    #7 0x564f35061d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x564f350678d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x564f3537d14b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f34707df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x564f3473bf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x564f347500b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x564f3537c24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 32 byte(s) in 4 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f34b174c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x564f350865fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x564f35068d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x564f347d4f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x564f35062056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x564f350678d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x564f3537d14b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f34707d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x564f3473bf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x564f347500b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x564f3537c24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f34707d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x564f3473bf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x564f347500b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x564f3537c24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f34b174c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x564f3508a4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x564f35068d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x564f347d4f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x564f35062056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x564f350678d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x564f3537d14b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f34b174c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x564f3508a4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x564f35068d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x564f347d4f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x564f347e6295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x564f347edb0e in NVE::setup() /workspace/abacus-develop/source/module_md/NVE.cpp:13
    #7 0x564f35061d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x564f350678d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x564f3537d14b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f346c9294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:62
    #2 0x564f346c9294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:54
    #3 0x564f346ca4ae in ModuleBase::operator*(double const&, ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:231
    #4 0x564f35068bf1 in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:344
    #5 0x564f347d4f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #6 0x564f35062056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #7 0x564f350678d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #8 0x564f3537d14b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #9 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #10 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #11 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #12 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f346c98f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:147
    #2 0x564f346c98f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:129
    #3 0x564f347e70aa in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:16
    #4 0x564f347ed501 in NVE::NVE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVE.cpp:4
    #5 0x564f35065582 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:59
    #6 0x564f350678d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x564f3537d14b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f347e6fe1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:14
    #2 0x564f347ed501 in NVE::NVE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVE.cpp:4
    #3 0x564f35065582 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:59
    #4 0x564f350678d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x564f3537d14b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f347e6db1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:12
    #2 0x564f347ed501 in NVE::NVE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVE.cpp:4
    #3 0x564f35065582 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:59
    #4 0x564f350678d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x564f3537d14b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f347e6cb5 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:11
    #2 0x564f347ed501 in NVE::NVE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVE.cpp:4
    #3 0x564f35065582 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:59
    #4 0x564f350678d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x564f3537d14b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f347e6eb1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:13
    #2 0x564f347ed501 in NVE::NVE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVE.cpp:4
    #3 0x564f35065582 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:59
    #4 0x564f350678d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x564f3537d14b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fb64205c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564f347e6c31 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:10
    #2 0x564f347ed501 in NVE::NVE(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVE.cpp:4
    #3 0x564f35065582 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:59
    #4 0x564f350678d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x564f3537d14b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x564f35344e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x564f35347678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x564f346887cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb63fe54d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 2016 byte(s) leaked in 39 allocation(s).
```

## Test case 120_PW_KP_MD_NVT

### On process id asan.9277

```bash

=================================================================
==9277==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2d519fb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x561a2d527c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x561a2d68096e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x561a2cdecf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x561a2cdfe295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x561a2ce19b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x561a2d679d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2d519fb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x561a2d527c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x561a2d68096e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x561a2cdecf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x561a2d67a056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f111d08ae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f111b6720bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 768 byte(s) in 8 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2d12f643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x561a2d69e5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x561a2d680d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x561a2cdecf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x561a2cdfe295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x561a2ce19b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x561a2d679d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2d51a03d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x561a2d527c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x561a2d68096e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x561a2cdecf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x561a2cdfe295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x561a2ce19b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x561a2d679d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2d51a03d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x561a2d527c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x561a2d68096e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x561a2cdecf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x561a2d67a056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 384 byte(s) in 4 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2d12f643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x561a2d69e5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x561a2d680d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x561a2cdecf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x561a2d67a056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 248 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c647 in operator new(unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:99
    #1 0x561a2d67da59 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #2 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #3 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #4 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2d51a07c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x561a2d527c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x561a2d68096e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x561a2cdecf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x561a2cdfe295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x561a2ce19b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x561a2d679d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2d51a07c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x561a2d527c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x561a2d68096e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x561a2cdecf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x561a2d67a056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2d12f643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x561a2d6a24d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x561a2d680d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x561a2cdecf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x561a2d67a056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2d12f643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x561a2d6a24d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x561a2d680d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x561a2cdecf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x561a2cdfe295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x561a2ce19b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x561a2d679d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 64 byte(s) in 8 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2d12f4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x561a2d69e5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x561a2d680d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x561a2cdecf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x561a2cdfe295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x561a2ce19b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x561a2d679d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2cd8b5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x561a2cd67d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x561a2d99424e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 32 byte(s) in 4 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2d12f4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x561a2d69e5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x561a2d680d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x561a2cdecf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x561a2d67a056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2cd8b4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x561a2cd67d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x561a2d99424e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2cd8b578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x561a2cd67d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x561a2d99424e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2d12f4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x561a2d6a24d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x561a2d680d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x561a2cdecf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x561a2cdfe295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x561a2ce19b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x561a2d679d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08ae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f111b6c84d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08ae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f111b6c894e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2d12f4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x561a2d6a24d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x561a2d680d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x561a2cdecf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x561a2d67a056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2cce1294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:62
    #2 0x561a2cce1294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:54
    #3 0x561a2cce24ae in ModuleBase::operator*(double const&, ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:231
    #4 0x561a2d680bf1 in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:344
    #5 0x561a2cdecf44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #6 0x561a2d67a056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #7 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #8 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #9 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #10 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #11 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #12 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2cce18f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:147
    #2 0x561a2cce18f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:129
    #3 0x561a2cdff0aa in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:16
    #4 0x561a2ce12f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #5 0x561a2d67da72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #6 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2cdfefe1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:14
    #2 0x561a2ce12f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x561a2d67da72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2cdfedb1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:12
    #2 0x561a2ce12f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x561a2d67da72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2cdfecb5 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:11
    #2 0x561a2ce12f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x561a2d67da72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2ce13189 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:19
    #2 0x561a2d67da72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2ce13103 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:18
    #2 0x561a2d67da72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2ce1307d in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:17
    #2 0x561a2d67da72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2ce12ff7 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:16
    #2 0x561a2d67da72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2cdfeeb1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:13
    #2 0x561a2ce12f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x561a2d67da72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f111d08c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561a2cdfec31 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:10
    #2 0x561a2ce12f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x561a2d67da72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x561a2d67f8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x561a2d99514b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x561a2d95ce39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x561a2d95f678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x561a2cca07cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f111ae84d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 6936 byte(s) leaked in 54 allocation(s).
```

### On process id asan.9278

```bash

=================================================================
==9278==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 768 byte(s) in 8 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5619e1643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55c561f505fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55c561f32d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55c56169ef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55c5616b0295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55c5616cbb2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x55c561f2bd55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 384 byte(s) in 4 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5619e1643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55c561f505fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55c561f32d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55c56169ef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55c561f2c056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 248 byte(s) in 1 object(s) allocated from:
    #0 0x7fd722415647 in operator new(unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:99
    #1 0x55c561f2fa59 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #2 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #3 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #4 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5619e1643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55c561f544d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55c561f32d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55c56169ef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55c5616b0295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55c5616cbb2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x55c561f2bd55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5619e1643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55c561f544d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55c561f32d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55c56169ef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55c561f2c056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 64 byte(s) in 8 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5619e14c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55c561f505fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55c561f32d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55c56169ef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55c5616b0295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55c5616cbb2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x55c561f2bd55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5615d1df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55c561605f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55c56161a0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55c56224624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 32 byte(s) in 4 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5619e14c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55c561f505fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55c561f32d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55c56169ef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55c561f2c056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5615d1d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55c561605f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55c56161a0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55c56224624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5615d1d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55c561605f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55c56161a0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55c56224624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5619e14c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55c561f544d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55c561f32d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55c56169ef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55c561f2c056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5619e14c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55c561f544d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55c561f32d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55c56169ef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55c5616b0295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55c5616cbb2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x55c561f2bd55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c561593294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:62
    #2 0x55c561593294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:54
    #3 0x55c5615944ae in ModuleBase::operator*(double const&, ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:231
    #4 0x55c561f32bf1 in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:344
    #5 0x55c56169ef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #6 0x55c561f2c056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #7 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #8 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #9 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #10 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #11 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #12 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5615938f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:147
    #2 0x55c5615938f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:129
    #3 0x55c5616b10aa in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:16
    #4 0x55c5616c4f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #5 0x55c561f2fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #6 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5616b0db1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:12
    #2 0x55c5616c4f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x55c561f2fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5616b0cb5 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:11
    #2 0x55c5616c4f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x55c561f2fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5616b0fe1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:14
    #2 0x55c5616c4f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x55c561f2fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5616c5189 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:19
    #2 0x55c561f2fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5616c5103 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:18
    #2 0x55c561f2fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5616c507d in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:17
    #2 0x55c561f2fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5616c4ff7 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:16
    #2 0x55c561f2fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5616b0eb1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:13
    #2 0x55c5616c4f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x55c561f2fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fd7224157a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c5616b0c31 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:10
    #2 0x55c5616c4f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x55c561f2fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x55c561f318d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55c56224714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55c56220ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c562211678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c5615527cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fd72020dd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 2240 byte(s) leaked in 43 allocation(s).
```

## Test case 127_PW_15_PK_AF

### On process id asan.9478

```bash

=================================================================
==9478==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 7680 byte(s) in 64 object(s) allocated from:
    #0 0x7f187c8677a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555a61847643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x555a61db65fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x555a6186796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555a6185794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x555a620acd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555a62074e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555a62077678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x555a613b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f187a65fd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f187c865e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f187ae4d0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 512 byte(s) in 64 object(s) allocated from:
    #0 0x7f187c8677a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555a618474c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x555a61db65fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x555a6186796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555a6185794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x555a620acd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555a62074e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555a62077678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x555a613b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f187a65fd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 240 byte(s) in 2 object(s) allocated from:
    #0 0x7f187c8677a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555a61847643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x555a61dba4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x555a6186796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555a6185794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x555a620acd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555a62074e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555a62077678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x555a613b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f187a65fd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7f187c8677a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555a614a35df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x555a6147fd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x555a620ac24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x555a62074e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x555a62077678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x555a613b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f187a65fd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f187c8677a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555a618474c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x555a61dba4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x555a6186796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x555a6185794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x555a620acd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x555a62074e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x555a62077678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x555a613b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f187a65fd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f187c8677a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555a614a34e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x555a6147fd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x555a620ac24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x555a62074e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x555a62077678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x555a613b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f187a65fd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f187c8677a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555a614a3578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x555a6147fd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x555a620ac24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x555a62074e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x555a62077678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x555a613b87cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f187a65fd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f187c865e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f187aea394e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f187c865e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f187aea34d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 9624 byte(s) leaked in 143 allocation(s).
```

### On process id asan.9479

```bash

=================================================================
==9479==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 7680 byte(s) in 64 object(s) allocated from:
    #0 0x7f41f55de7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ff7314b643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55ff736ba5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55ff7316b96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ff7315b94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ff739b0d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ff73978e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ff7397b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ff72cbc7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f41f33d6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 512 byte(s) in 64 object(s) allocated from:
    #0 0x7f41f55de7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ff7314b4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55ff736ba5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55ff7316b96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ff7315b94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ff739b0d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ff73978e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ff7397b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ff72cbc7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f41f33d6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 240 byte(s) in 2 object(s) allocated from:
    #0 0x7f41f55de7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ff7314b643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55ff736be4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55ff7316b96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ff7315b94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ff739b0d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ff73978e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ff7397b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ff72cbc7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f41f33d6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7f41f55de7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ff72d3bdf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55ff72d6ff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55ff72d840b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55ff739b024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55ff73978e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55ff7397b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55ff72cbc7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f41f33d6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f41f55de7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ff7314b4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55ff736be4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55ff7316b96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ff7315b94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ff739b0d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ff73978e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ff7397b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ff72cbc7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f41f33d6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f41f55de7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ff72d3bd86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55ff72d6ff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55ff72d840b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55ff739b024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55ff73978e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55ff7397b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55ff72cbc7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f41f33d6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f41f55de7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ff72d3bd20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55ff72d6ff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55ff72d840b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55ff739b024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55ff73978e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55ff7397b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55ff72cbc7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f41f33d6d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 8528 byte(s) leaked in 138 allocation(s).
```

## Test case 133_PW_DJ_PK

### On process id asan.9591

```bash

=================================================================
==9591==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f8d39be1e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f8d381c90bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 672 byte(s) in 7 object(s) allocated from:
    #0 0x7f8d39be37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56021b2fa643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x56021b8695fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x56021b31a96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56021b30a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56021bb5fd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56021bb27e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56021bb2a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56021ae6b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8d379dbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f8d39be37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56021b2fa643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x56021b86d4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x56021b31a96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56021b30a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56021bb5fd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56021bb27e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56021bb2a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56021ae6b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8d379dbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 56 byte(s) in 7 object(s) allocated from:
    #0 0x7f8d39be37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56021b2fa4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x56021b8695fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x56021b31a96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56021b30a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56021bb5fd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56021bb27e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56021bb2a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56021ae6b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8d379dbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f8d39be37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56021af565df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x56021af32d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x56021bb5f24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x56021bb27e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x56021bb2a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x56021ae6b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f8d379dbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f8d39be37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56021af564e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x56021af32d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x56021bb5f24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x56021bb27e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x56021bb2a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x56021ae6b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f8d379dbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f8d39be37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56021af56578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x56021af32d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x56021bb5f24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x56021bb27e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x56021bb2a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x56021ae6b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f8d379dbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f8d39be37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56021b2fa4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x56021b86d4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x56021b31a96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56021b30a94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x56021bb5fd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x56021bb27e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x56021bb2a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x56021ae6b7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8d379dbd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f8d39be1e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f8d3821f94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f8d39be1e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f8d3821f4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 2008 byte(s) leaked in 24 allocation(s).
```

### On process id asan.9592

```bash

=================================================================
==9592==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 672 byte(s) in 7 object(s) allocated from:
    #0 0x7f3dad6b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fa99083643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55fa995f25fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55fa990a396d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fa9909394a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fa998e8d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fa998b0e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fa998b3678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fa98bf47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3dab4abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f3dad6b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fa99083643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55fa995f64d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55fa990a396d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fa9909394a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fa998e8d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fa998b0e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fa998b3678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fa98bf47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3dab4abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 56 byte(s) in 7 object(s) allocated from:
    #0 0x7f3dad6b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fa990834c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55fa995f25fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55fa990a396d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fa9909394a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fa998e8d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fa998b0e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fa998b3678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fa98bf47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3dab4abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f3dad6b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fa98c73df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55fa98ca7f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55fa98cbc0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55fa998e824e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55fa998b0e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55fa998b3678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55fa98bf47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f3dab4abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f3dad6b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fa98c73d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55fa98ca7f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55fa98cbc0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55fa998e824e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55fa998b0e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55fa998b3678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55fa98bf47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f3dab4abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f3dad6b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fa98c73d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55fa98ca7f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55fa98cbc0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55fa998e824e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55fa998b0e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55fa998b3678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55fa98bf47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f3dab4abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f3dad6b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55fa990834c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55fa995f64d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55fa990a396d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55fa9909394a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55fa998e8d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55fa998b0e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55fa998b3678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55fa98bf47cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3dab4abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 912 byte(s) leaked in 19 allocation(s).
```

## Test case 135_PW_15_PK

### On process id asan.9704

```bash

=================================================================
==9704==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1344 byte(s) in 14 object(s) allocated from:
    #0 0x7ff70cd8f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561255554643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x561255ac35fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x56125557496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56125556494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x561255db9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x561255d81e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x561255d84678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5612550c57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7ff70ab87d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7ff70cd8de8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7ff70b3750bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 112 byte(s) in 14 object(s) allocated from:
    #0 0x7ff70cd8f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5612555544c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x561255ac35fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x56125557496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56125556494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x561255db9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x561255d81e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x561255d84678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5612550c57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7ff70ab87d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7ff70cd8f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x561255554643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x561255ac74d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x56125557496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56125556494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x561255db9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x561255d81e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x561255d84678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5612550c57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7ff70ab87d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7ff70cd8f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5612551b05df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x56125518cd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x561255db924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x561255d81e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x561255d84678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5612550c57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7ff70ab87d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7ff70cd8f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5612551b04e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x56125518cd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x561255db924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x561255d81e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x561255d84678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5612550c57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7ff70ab87d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7ff70cd8f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5612551b0578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x56125518cd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x561255db924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x561255d81e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x561255d84678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5612550c57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7ff70ab87d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7ff70cd8f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5612555544c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x561255ac74d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x56125557496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x56125556494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x561255db9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x561255d81e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x561255d84678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5612550c57cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7ff70ab87d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7ff70cd8de8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7ff70b3cb94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7ff70cd8de8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7ff70b3cb4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 2736 byte(s) leaked in 41 allocation(s).
```

### On process id asan.9705

```bash

=================================================================
==9705==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1344 byte(s) in 14 object(s) allocated from:
    #0 0x7f185b0cc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ee05890643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55ee05dff5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55ee058b096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ee058a094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ee060f5d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ee060bde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ee060c0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ee054017cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f1858ec4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 112 byte(s) in 14 object(s) allocated from:
    #0 0x7f185b0cc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ee058904c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55ee05dff5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55ee058b096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ee058a094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ee060f5d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ee060bde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ee060c0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ee054017cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f1858ec4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f185b0cc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ee05890643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55ee05e034d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55ee058b096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ee058a094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ee060f5d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ee060bde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ee060c0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ee054017cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f1858ec4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7f185b0cc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ee05480df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55ee054b4f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55ee054c90b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55ee060f524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55ee060bde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55ee060c0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55ee054017cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f1858ec4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f185b0cc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ee05480d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55ee054b4f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55ee054c90b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55ee060f524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55ee060bde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55ee060c0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55ee054017cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f1858ec4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f185b0cc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ee05480d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55ee054b4f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55ee054c90b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55ee060f524e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55ee060bde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55ee060c0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55ee054017cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f1858ec4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f185b0cc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55ee058904c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55ee05e034d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55ee058b096d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55ee058a094a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55ee060f5d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55ee060bde39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55ee060c0678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55ee054017cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f1858ec4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 1640 byte(s) leaked in 36 allocation(s).
```

## Test case 140_PW_15_SO

### On process id asan.9817

```bash

=================================================================
==9817==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 10944 byte(s) in 76 object(s) allocated from:
    #0 0x7f8b6f4927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b90baf3896 in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:136
    #2 0x55b90c0660fa in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:349
    #3 0x55b90bb1796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b90bb0794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b90c35cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b90c324e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b90c327678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b90b6687cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8b6d28ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 10944 byte(s) in 76 object(s) allocated from:
    #0 0x7f8b6f4927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b90baf7643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55b90c0665fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55b90bb1796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b90bb0794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b90c35cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b90c324e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b90c327678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b90b6687cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8b6d28ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f8b6f490e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f8b6da780bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 608 byte(s) in 76 object(s) allocated from:
    #0 0x7f8b6f4927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b90baf3726 in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:128
    #2 0x55b90c0660fa in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:349
    #3 0x55b90bb1796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b90bb0794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b90c35cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b90c324e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b90c327678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b90b6687cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8b6d28ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 608 byte(s) in 76 object(s) allocated from:
    #0 0x7f8b6f4927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b90baf74c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55b90c0665fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55b90bb1796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b90bb0794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b90c35cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b90c324e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b90c327678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b90b6687cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8b6d28ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 608 byte(s) in 76 object(s) allocated from:
    #0 0x7f8b6f4927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b90baf35fd in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:118
    #2 0x55b90c0660fa in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:349
    #3 0x55b90bb1796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b90bb0794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b90c35cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b90c324e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b90c327678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b90b6687cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8b6d28ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 576 byte(s) in 4 object(s) allocated from:
    #0 0x7f8b6f4927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b90baf7643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55b90c06a4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55b90bb1796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b90bb0794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b90c35cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b90c324e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b90c327678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b90b6687cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8b6d28ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 576 byte(s) in 4 object(s) allocated from:
    #0 0x7f8b6f4927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b90baf3896 in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:136
    #2 0x55b90c06a07e in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:419
    #3 0x55b90bb1796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b90bb0794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b90c35cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b90c324e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b90c327678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b90b6687cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8b6d28ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7f8b6f4927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b90b7535df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55b90b72fd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55b90c35c24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55b90c324e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55b90c327678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55b90b6687cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f8b6d28ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 32 byte(s) in 4 object(s) allocated from:
    #0 0x7f8b6f4927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b90baf74c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55b90c06a4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55b90bb1796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b90bb0794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b90c35cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b90c324e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b90c327678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b90b6687cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8b6d28ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 32 byte(s) in 4 object(s) allocated from:
    #0 0x7f8b6f4927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b90baf3726 in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:128
    #2 0x55b90c06a07e in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:419
    #3 0x55b90bb1796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b90bb0794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b90c35cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b90c324e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b90c327678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b90b6687cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8b6d28ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 32 byte(s) in 4 object(s) allocated from:
    #0 0x7f8b6f4927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b90baf35fd in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:118
    #2 0x55b90c06a07e in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:419
    #3 0x55b90bb1796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55b90bb0794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55b90c35cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55b90c324e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55b90c327678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55b90b6687cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f8b6d28ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f8b6f4927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b90b753578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55b90b72fd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55b90c35c24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55b90c324e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55b90c327678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55b90b6687cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f8b6d28ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f8b6f4927a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b90b7534e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55b90b72fd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55b90c35c24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55b90c324e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55b90c327678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55b90b6687cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f8b6d28ad09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f8b6f490e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f8b6dace94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f8b6f490e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f8b6dace4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 26136 byte(s) leaked in 411 allocation(s).
```

### On process id asan.9818

```bash

=================================================================
==9818==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 10944 byte(s) in 76 object(s) allocated from:
    #0 0x7fc6febfa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db10d23896 in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:136
    #2 0x55db112960fa in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:349
    #3 0x55db10d4796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55db10d3794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55db1158cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55db11554e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55db11557678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55db108987cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc6fc9f2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 10944 byte(s) in 76 object(s) allocated from:
    #0 0x7fc6febfa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db10d27643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55db112965fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55db10d4796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55db10d3794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55db1158cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55db11554e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55db11557678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55db108987cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc6fc9f2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 608 byte(s) in 76 object(s) allocated from:
    #0 0x7fc6febfa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db10d23726 in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:128
    #2 0x55db112960fa in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:349
    #3 0x55db10d4796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55db10d3794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55db1158cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55db11554e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55db11557678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55db108987cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc6fc9f2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 608 byte(s) in 76 object(s) allocated from:
    #0 0x7fc6febfa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db10d274c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55db112965fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55db10d4796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55db10d3794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55db1158cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55db11554e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55db11557678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55db108987cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc6fc9f2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 608 byte(s) in 76 object(s) allocated from:
    #0 0x7fc6febfa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db10d235fd in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:118
    #2 0x55db112960fa in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:349
    #3 0x55db10d4796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55db10d3794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55db1158cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55db11554e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55db11557678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55db108987cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc6fc9f2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 576 byte(s) in 4 object(s) allocated from:
    #0 0x7fc6febfa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db10d23896 in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:136
    #2 0x55db1129a07e in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:419
    #3 0x55db10d4796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55db10d3794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55db1158cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55db11554e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55db11557678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55db108987cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc6fc9f2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 576 byte(s) in 4 object(s) allocated from:
    #0 0x7fc6febfa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db10d27643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55db1129a4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55db10d4796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55db10d3794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55db1158cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55db11554e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55db11557678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55db108987cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc6fc9f2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7fc6febfa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db10917df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55db1094bf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55db109600b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55db1158c24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55db11554e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55db11557678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55db108987cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fc6fc9f2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 32 byte(s) in 4 object(s) allocated from:
    #0 0x7fc6febfa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db10d274c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55db1129a4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55db10d4796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55db10d3794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55db1158cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55db11554e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55db11557678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55db108987cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc6fc9f2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 32 byte(s) in 4 object(s) allocated from:
    #0 0x7fc6febfa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db10d235fd in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:118
    #2 0x55db1129a07e in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:419
    #3 0x55db10d4796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55db10d3794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55db1158cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55db11554e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55db11557678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55db108987cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc6fc9f2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 32 byte(s) in 4 object(s) allocated from:
    #0 0x7fc6febfa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db10d23726 in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:128
    #2 0x55db1129a07e in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:419
    #3 0x55db10d4796d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55db10d3794a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55db1158cd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55db11554e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55db11557678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55db108987cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc6fc9f2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fc6febfa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db10917d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55db1094bf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55db109600b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55db1158c24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55db11554e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55db11557678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55db108987cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fc6fc9f2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fc6febfa7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55db10917d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55db1094bf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55db109600b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55db1158c24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55db11554e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55db11557678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55db108987cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fc6fc9f2d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 25040 byte(s) leaked in 406 allocation(s).
```

## Test case 140_PW_15_SO_average

### On process id asan.9931

```bash

=================================================================
==9931==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1728 byte(s) in 12 object(s) allocated from:
    #0 0x7f9e40b997a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5590efa94643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5590f00035fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x5590efab496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5590efaa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5590f02f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5590f02c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5590f02c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5590ef6057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9e3e991d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1728 byte(s) in 12 object(s) allocated from:
    #0 0x7f9e40b997a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5590efa90896 in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:136
    #2 0x5590f00030fa in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:349
    #3 0x5590efab496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5590efaa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5590f02f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5590f02c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5590f02c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5590ef6057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9e3e991d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f9e40b97e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9e3f17f0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 144 byte(s) in 1 object(s) allocated from:
    #0 0x7f9e40b997a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5590efa90896 in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:136
    #2 0x5590f000707e in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:419
    #3 0x5590efab496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5590efaa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5590f02f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5590f02c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5590f02c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5590ef6057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9e3e991d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 144 byte(s) in 1 object(s) allocated from:
    #0 0x7f9e40b997a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5590efa94643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5590f00074d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x5590efab496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5590efaa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5590f02f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5590f02c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5590f02c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5590ef6057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9e3e991d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 12 object(s) allocated from:
    #0 0x7f9e40b997a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5590efa944c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5590f00035fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x5590efab496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5590efaa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5590f02f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5590f02c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5590f02c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5590ef6057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9e3e991d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 12 object(s) allocated from:
    #0 0x7f9e40b997a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5590efa90726 in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:128
    #2 0x5590f00030fa in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:349
    #3 0x5590efab496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5590efaa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5590f02f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5590f02c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5590f02c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5590ef6057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9e3e991d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 12 object(s) allocated from:
    #0 0x7f9e40b997a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5590efa905fd in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:118
    #2 0x5590f00030fa in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:349
    #3 0x5590efab496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5590efaa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5590f02f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5590f02c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5590f02c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5590ef6057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9e3e991d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7f9e40b997a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5590ef6f05df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x5590ef6ccd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x5590f02f924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x5590f02c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x5590f02c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5590ef6057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f9e3e991d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f9e40b997a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5590ef6f04e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x5590ef6ccd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x5590f02f924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x5590f02c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x5590f02c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5590ef6057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f9e3e991d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f9e40b997a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5590ef6f0578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x5590ef6ccd76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x5590f02f924e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x5590f02c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x5590f02c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5590ef6057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f9e3e991d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9e40b997a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5590efa944c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5590f00074d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x5590efab496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5590efaa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5590f02f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5590f02c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5590f02c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5590ef6057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9e3e991d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9e40b997a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5590efa90726 in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:128
    #2 0x5590f000707e in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:419
    #3 0x5590efab496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5590efaa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5590f02f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5590f02c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5590f02c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5590ef6057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9e3e991d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9e40b997a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5590efa905fd in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:118
    #2 0x5590f000707e in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:419
    #3 0x5590efab496d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x5590efaa494a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x5590f02f9d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x5590f02c1e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5590f02c4678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5590ef6057cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f9e3e991d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9e40b97e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9e3f1d594e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f9e40b97e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f9e3f1d54d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 5232 byte(s) leaked in 76 allocation(s).
```

### On process id asan.9932

```bash

=================================================================
==9932==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 1728 byte(s) in 12 object(s) allocated from:
    #0 0x7fb4833b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557ec3426643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x557ec39955fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x557ec344696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557ec343694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557ec3c8bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557ec3c53e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557ec3c56678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557ec2f977cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb4811abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1728 byte(s) in 12 object(s) allocated from:
    #0 0x7fb4833b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557ec3422896 in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:136
    #2 0x557ec39950fa in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:349
    #3 0x557ec344696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557ec343694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557ec3c8bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557ec3c53e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557ec3c56678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557ec2f977cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb4811abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 144 byte(s) in 1 object(s) allocated from:
    #0 0x7fb4833b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557ec3426643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x557ec39994d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x557ec344696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557ec343694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557ec3c8bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557ec3c53e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557ec3c56678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557ec2f977cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb4811abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 144 byte(s) in 1 object(s) allocated from:
    #0 0x7fb4833b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557ec3422896 in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:136
    #2 0x557ec399907e in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:419
    #3 0x557ec344696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557ec343694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557ec3c8bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557ec3c53e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557ec3c56678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557ec2f977cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb4811abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 12 object(s) allocated from:
    #0 0x7fb4833b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557ec34225fd in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:118
    #2 0x557ec39950fa in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:349
    #3 0x557ec344696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557ec343694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557ec3c8bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557ec3c53e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557ec3c56678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557ec2f977cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb4811abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 12 object(s) allocated from:
    #0 0x7fb4833b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557ec34264c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x557ec39955fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x557ec344696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557ec343694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557ec3c8bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557ec3c53e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557ec3c56678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557ec2f977cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb4811abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 12 object(s) allocated from:
    #0 0x7fb4833b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557ec3422726 in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:128
    #2 0x557ec39950fa in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:349
    #3 0x557ec344696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557ec343694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557ec3c8bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557ec3c53e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557ec3c56678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557ec2f977cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb4811abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7fb4833b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557ec3016df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x557ec304af76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x557ec305f0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x557ec3c8b24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x557ec3c53e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x557ec3c56678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x557ec2f977cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fb4811abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fb4833b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557ec3016d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x557ec304af76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x557ec305f0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x557ec3c8b24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x557ec3c53e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x557ec3c56678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x557ec2f977cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fb4811abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fb4833b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557ec3016d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x557ec304af76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x557ec305f0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x557ec3c8b24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x557ec3c53e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x557ec3c56678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x557ec2f977cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fb4811abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fb4833b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557ec3422726 in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:128
    #2 0x557ec399907e in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:419
    #3 0x557ec344696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557ec343694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557ec3c8bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557ec3c53e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557ec3c56678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557ec2f977cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb4811abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fb4833b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557ec34264c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x557ec39994d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x557ec344696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557ec343694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557ec3c8bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557ec3c53e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557ec3c56678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557ec2f977cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb4811abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fb4833b37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x557ec34225fd in Charge::write_rho(double const*, int const&, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&, bool) /workspace/abacus-develop/source/src_io/write_rho.cpp:118
    #2 0x557ec399907e in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:419
    #3 0x557ec344696d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x557ec343694a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x557ec3c8bd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x557ec3c53e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x557ec3c56678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x557ec2f977cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fb4811abd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 4136 byte(s) leaked in 71 allocation(s).
```

## Test case 150_PW_15_CR_VDW3

### On process id asan.10045

```bash

=================================================================
==10045==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 3960 byte(s) in 11 object(s) allocated from:
    #0 0x7fa3d09d87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c9e2ceb643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55c9e325a5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55c9e2d0b96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c9e2cfb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c9e3550d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c9e3518e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c9e351b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c9e285c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fa3ce7d0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7fa3d09d87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c9e30d5fb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x55c9e30e3c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55c9e2d03cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55c9e2d0764e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55c9e2d08512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55c9e2cfb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55c9e3550d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55c9e3518e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55c9e351b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55c9e285c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fa3ce7d0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7fa3d09d6e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fa3cefbe0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7fa3d09d87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c9e30d603d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x55c9e30e3c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55c9e2d03cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55c9e2d0764e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55c9e2d08512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55c9e2cfb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55c9e3550d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55c9e3518e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55c9e351b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55c9e285c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fa3ce7d0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 360 byte(s) in 1 object(s) allocated from:
    #0 0x7fa3d09d87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c9e2ceb643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55c9e325e4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55c9e2d0b96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c9e2cfb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c9e3550d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c9e3518e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c9e351b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c9e285c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fa3ce7d0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7fa3d09d87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c9e30d607c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x55c9e30e3c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55c9e2d03cf4 in Ions::gather_force_pw(ModuleBase::matrix&) /workspace/abacus-develop/source/src_ions/ions.cpp:306
    #4 0x55c9e2d0764e in Ions::after_scf(int const&, int&, int&) /workspace/abacus-develop/source/src_ions/ions.cpp:261
    #5 0x55c9e2d08512 in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:203
    #6 0x55c9e2cfb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #7 0x55c9e3550d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #8 0x55c9e3518e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55c9e351b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55c9e285c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fa3ce7d0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 88 byte(s) in 11 object(s) allocated from:
    #0 0x7fa3d09d87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c9e2ceb4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55c9e325a5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55c9e2d0b96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c9e2cfb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c9e3550d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c9e3518e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c9e351b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c9e285c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fa3ce7d0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7fa3d09d87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c9e29475df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55c9e2923d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55c9e355024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55c9e3518e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55c9e351b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55c9e285c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fa3ce7d0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fa3d09d87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c9e29474e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55c9e2923d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55c9e355024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55c9e3518e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55c9e351b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55c9e285c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fa3ce7d0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7fa3d09d87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c9e2947578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55c9e2923d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55c9e355024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55c9e3518e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55c9e351b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55c9e285c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fa3ce7d0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fa3d09d87a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55c9e2ceb4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55c9e325e4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55c9e2d0b96d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55c9e2cfb94a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55c9e3550d1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55c9e3518e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55c9e351b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55c9e285c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fa3ce7d0d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fa3d09d6e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fa3cf01494e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fa3d09d6e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fa3cf0144d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

SUMMARY: AddressSanitizer: 7392 byte(s) leaked in 38 allocation(s).
```

### On process id asan.10046

```bash

=================================================================
==10046==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 3960 byte(s) in 11 object(s) allocated from:
    #0 0x7f430249a7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e6644d8643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55e664a475fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55e6644f896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e6644e894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e664d3dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e664d05e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e664d08678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e6640497cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f4300292d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 360 byte(s) in 1 object(s) allocated from:
    #0 0x7f430249a7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e6644d8643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55e664a4b4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55e6644f896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e6644e894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e664d3dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e664d05e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e664d08678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e6640497cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f4300292d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 88 byte(s) in 11 object(s) allocated from:
    #0 0x7f430249a7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e6644d84c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55e664a475fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55e6644f896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e6644e894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e664d3dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e664d05e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e664d08678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e6640497cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f4300292d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7f430249a7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e6640c8df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55e6640fcf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55e6641110b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55e664d3d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55e664d05e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55e664d08678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55e6640497cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f4300292d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f430249a7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e6640c8d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55e6640fcf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55e6641110b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55e664d3d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55e664d05e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55e664d08678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55e6640497cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f4300292d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 2 object(s) allocated from:
    #0 0x7f430249a7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e6640c8d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55e6640fcf76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55e6641110b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55e664d3d24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55e664d05e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55e664d08678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55e6640497cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f4300292d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f430249a7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55e6644d84c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55e664a4b4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55e6644f896d in Ions::opt_ions_pw() /workspace/abacus-develop/source/src_ions/ions.cpp:143
    #4 0x55e6644e894a in Cell_PW::opt_cells_pw() /workspace/abacus-develop/source/src_ions/Cell_PW.cpp:83
    #5 0x55e664d3dd1e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:113
    #6 0x55e664d05e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55e664d08678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55e6640497cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f4300292d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 4496 byte(s) leaked in 30 allocation(s).
```

## Test case 170_PW_MD_1O

### On process id asan.10244

```bash

=================================================================
==10244==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 3600 byte(s) in 3 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf58324fb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x55bf58332c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55bf5848b96e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x55bf57bf7f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55bf58485056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf58324fb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x55bf58332c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55bf5848b96e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x55bf57bf7f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55bf57c09295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55bf57c24b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x55bf58484d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1200 byte(s) in 3 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf5832503d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x55bf58332c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55bf5848b96e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x55bf57bf7f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55bf58485056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7fc325af1e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fc3240d90bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 864 byte(s) in 9 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57f3a643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55bf584a95fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55bf5848bd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55bf57bf7f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55bf58485056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 672 byte(s) in 7 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57f3a643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55bf584a95fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55bf5848bd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55bf57bf7f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55bf57c09295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55bf57c24b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x55bf58484d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 600 byte(s) in 3 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf5832507c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x55bf58332c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55bf5848b96e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x55bf57bf7f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55bf58485056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf5832503d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x55bf58332c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55bf5848b96e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x55bf57bf7f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55bf57c09295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55bf57c24b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x55bf58484d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 288 byte(s) in 3 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57f3a643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55bf584ad4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55bf5848bd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55bf57bf7f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55bf58485056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 248 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af3647 in operator new(unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:99
    #1 0x55bf58488a59 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #2 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #3 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #4 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf5832507c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x55bf58332c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x55bf5848b96e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x55bf57bf7f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55bf57c09295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55bf57c24b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x55bf58484d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57f3a643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55bf584ad4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55bf5848bd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55bf57bf7f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55bf57c09295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55bf57c24b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x55bf58484d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 9 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57f3a4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55bf584a95fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55bf5848bd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55bf57bf7f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55bf58485056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 56 byte(s) in 7 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57f3a4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55bf584a95fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55bf5848bd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55bf57bf7f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55bf57c09295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55bf57c24b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x55bf58484d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57b965df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55bf57b72d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55bf5879f24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 3 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57f3a4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55bf584ad4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55bf5848bd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55bf57bf7f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55bf58485056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57b964e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55bf57b72d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55bf5879f24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57b96578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55bf57b72d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55bf5879f24e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57f3a4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55bf584ad4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55bf5848bd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55bf57bf7f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55bf57c09295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55bf57c24b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x55bf58484d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af1e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fc32412f4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af1e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fc32412f94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57aec294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:62
    #2 0x55bf57aec294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:54
    #3 0x55bf57aed4ae in ModuleBase::operator*(double const&, ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:231
    #4 0x55bf5848bbf1 in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:344
    #5 0x55bf57bf7f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #6 0x55bf58485056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #7 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #8 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #9 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #10 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #11 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #12 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57aec8f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:147
    #2 0x55bf57aec8f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:129
    #3 0x55bf57c0a0aa in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:16
    #4 0x55bf57c1df17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #5 0x55bf58488a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #6 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57c09fe1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:14
    #2 0x55bf57c1df17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x55bf58488a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57c09db1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:12
    #2 0x55bf57c1df17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x55bf58488a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57c09cb5 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:11
    #2 0x55bf57c1df17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x55bf58488a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57c1e189 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:19
    #2 0x55bf58488a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57c1e103 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:18
    #2 0x55bf58488a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57c1e07d in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:17
    #2 0x55bf58488a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57c1dff7 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:16
    #2 0x55bf58488a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57c09eb1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:13
    #2 0x55bf57c1df17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x55bf58488a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fc325af37a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf57c09c31 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:10
    #2 0x55bf57c1df17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x55bf58488a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x55bf5848a8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55bf587a014b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55bf58767e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55bf5876a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55bf57aab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fc3238ebd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 11160 byte(s) leaked in 72 allocation(s).
```

### On process id asan.10245

```bash

=================================================================
==10245==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 864 byte(s) in 9 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b732b643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5608b789a5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x5608b787cd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x5608b6fe8f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x5608b7876056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 672 byte(s) in 7 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b732b643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5608b789a5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x5608b787cd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x5608b6fe8f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x5608b6ffa295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x5608b7015b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x5608b7875d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 288 byte(s) in 3 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b732b643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5608b789e4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x5608b787cd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x5608b6fe8f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x5608b7876056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 248 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a407647 in operator new(unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:99
    #1 0x5608b7879a59 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #2 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #3 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #4 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b732b643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5608b789e4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x5608b787cd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x5608b6fe8f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x5608b6ffa295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x5608b7015b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x5608b7875d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 72 byte(s) in 9 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b732b4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5608b789a5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x5608b787cd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x5608b6fe8f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x5608b7876056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 56 byte(s) in 7 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b732b4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5608b789a5fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x5608b787cd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x5608b6fe8f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x5608b6ffa295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x5608b7015b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x5608b7875d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b6f1bdf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x5608b6f4ff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5608b6f640b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5608b7b9024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 3 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b732b4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5608b789e4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x5608b787cd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x5608b6fe8f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x5608b7876056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b6f1bd20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x5608b6f4ff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5608b6f640b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5608b7b9024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b6f1bd86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x5608b6f4ff76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5608b6f640b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5608b7b9024e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b732b4c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5608b789e4d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x5608b787cd3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x5608b6fe8f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x5608b6ffa295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x5608b7015b2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x5608b7875d55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b6edd294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:62
    #2 0x5608b6edd294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:54
    #3 0x5608b6ede4ae in ModuleBase::operator*(double const&, ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:231
    #4 0x5608b787cbf1 in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:344
    #5 0x5608b6fe8f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #6 0x5608b7876056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #7 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #8 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #9 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #10 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #11 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #12 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b6edd8f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:147
    #2 0x5608b6edd8f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:129
    #3 0x5608b6ffb0aa in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:16
    #4 0x5608b700ef17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #5 0x5608b7879a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #6 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b6ffadb1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:12
    #2 0x5608b700ef17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x5608b7879a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b6ffacb5 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:11
    #2 0x5608b700ef17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x5608b7879a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b6ffafe1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:14
    #2 0x5608b700ef17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x5608b7879a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b700f189 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:19
    #2 0x5608b7879a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b700f103 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:18
    #2 0x5608b7879a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b700f07d in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:17
    #2 0x5608b7879a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b700eff7 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:16
    #2 0x5608b7879a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b6ffaeb1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:13
    #2 0x5608b700ef17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x5608b7879a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f2d4a4077a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5608b6ffac31 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:10
    #2 0x5608b700ef17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x5608b7879a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x5608b787b8d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x5608b7b9114b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x5608b7b58e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x5608b7b5b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x5608b6e9c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f2d481ffd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 2864 byte(s) leaked in 55 allocation(s).
```

## Test case 170_PW_MD_2O

### On process id asan.10443

```bash

=================================================================
==10443==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 3600 byte(s) in 3 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56438172bfb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x564381739c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x56438189296e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x564380ffef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x56438188c056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56438172bfb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x564381739c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x56438189296e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x564380ffef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x564381010295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x56438102bb2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x56438188bd55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1200 byte(s) in 3 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56438172c03d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x564381739c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x56438189296e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x564380ffef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x56438188c056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1080 byte(s) in 3 object(s) allocated from:
    #0 0x7f372465fe8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f3722c470bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 672 byte(s) in 7 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564381341643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5643818b05fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x564381892d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x564380ffef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x56438188c056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 672 byte(s) in 7 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564381341643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5643818b05fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x564381892d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x564380ffef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x564381010295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x56438102bb2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x56438188bd55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 600 byte(s) in 3 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56438172c07c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x564381739c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x56438189296e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x564380ffef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x56438188c056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56438172c03d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x564381739c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x56438189296e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x564380ffef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x564381010295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x56438102bb2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x56438188bd55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 288 byte(s) in 3 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564381341643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5643818b44d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x564381892d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x564380ffef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x56438188c056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 248 byte(s) in 1 object(s) allocated from:
    #0 0x7f3724661647 in operator new(unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:99
    #1 0x56438188fa59 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #2 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #3 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #4 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56438172c07c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x564381739c76 in Forces::init(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:32
    #3 0x56438189296e in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:331
    #4 0x564380ffef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x564381010295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x56438102bb2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x56438188bd55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564381341643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x5643818b44d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x564381892d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x564380ffef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x564381010295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x56438102bb2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x56438188bd55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 56 byte(s) in 7 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5643813414c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5643818b05fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x564381892d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x564380ffef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x564381010295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x56438102bb2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x56438188bd55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 56 byte(s) in 7 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5643813414c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5643818b05fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x564381892d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x564380ffef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x56438188c056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564380f9d5df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x564380f79d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x564381ba624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 3 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5643813414c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5643818b44d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x564381892d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x564380ffef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x56438188c056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564380f9d4e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x564380f79d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x564381ba624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564380f9d578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x564380f79d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x564381ba624e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #4 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5643813414c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x5643818b44d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x564381892d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x564380ffef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x564381010295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x56438102bb2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x56438188bd55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f372465fe8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f3722c9d4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f372465fe8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f3722c9d94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564380ef3294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:62
    #2 0x564380ef3294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:54
    #3 0x564380ef44ae in ModuleBase::operator*(double const&, ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:231
    #4 0x564381892bf1 in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:344
    #5 0x564380ffef44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #6 0x56438188c056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #7 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #8 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #9 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #10 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #11 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #12 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564380ef38f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:147
    #2 0x564380ef38f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:129
    #3 0x5643810110aa in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:16
    #4 0x564381024f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #5 0x56438188fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #6 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564381010fe1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:14
    #2 0x564381024f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x56438188fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564381010db1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:12
    #2 0x564381024f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x56438188fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564381010cb5 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:11
    #2 0x564381024f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x56438188fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564381025189 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:19
    #2 0x56438188fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564381025103 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:18
    #2 0x56438188fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x56438102507d in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:17
    #2 0x56438188fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564381024ff7 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:16
    #2 0x56438188fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564381010eb1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:13
    #2 0x564381024f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x56438188fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f37246617a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564381010c31 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:10
    #2 0x564381024f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x56438188fa72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x5643818918d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x564381ba714b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x564381b6ee39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x564381b71678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x564380eb27cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7f3722459d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 10952 byte(s) leaked in 68 allocation(s).
```

### On process id asan.10444

```bash

=================================================================
==10444==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 672 byte(s) in 7 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d181213643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55d1817825fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55d181764d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55d180ed0f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55d180ee2295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55d180efdb2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x55d18175dd55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 672 byte(s) in 7 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d181213643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55d1817825fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55d181764d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55d180ed0f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55d18175e056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 288 byte(s) in 3 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d181213643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55d1817864d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55d181764d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55d180ed0f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55d18175e056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 248 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d4647 in operator new(unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:99
    #1 0x55d181761a59 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #2 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #3 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #4 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #5 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 96 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d181213643 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:116
    #2 0x55d1817864d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55d181764d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55d180ed0f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55d180ee2295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55d180efdb2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x55d18175dd55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 56 byte(s) in 7 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d1812134c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55d1817825fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55d181764d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55d180ed0f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55d180ee2295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55d180efdb2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x55d18175dd55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 56 byte(s) in 7 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d1812134c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55d1817825fd in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:351
    #3 0x55d181764d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55d180ed0f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55d18175e056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d180e03df0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55d180e37f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55d180e4c0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55d181a7824e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 24 byte(s) in 3 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d1812134c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55d1817864d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55d181764d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55d180ed0f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55d18175e056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #6 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d180e03d20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55d180e37f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55d180e4c0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55d181a7824e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d180e03d86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55d180e37f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55d180e4c0b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55d181a7824e in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:27
    #5 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d1812134c6 in Charge::write_rho_cube(double const*, int const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int const&) /workspace/abacus-develop/source/src_io/write_rho_cube.cpp:107
    #2 0x55d1817864d5 in Electrons::self_consistent(int const&) /workspace/abacus-develop/source/src_pw/electrons.cpp:420
    #3 0x55d181764d3d in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:288
    #4 0x55d180ed0f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #5 0x55d180ee2295 in Verlet::setup() /workspace/abacus-develop/source/module_md/verlet.cpp:52
    #6 0x55d180efdb2a in NVT_NHC::setup() /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:50
    #7 0x55d18175dd55 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:84
    #8 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #9 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #10 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #11 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #12 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #13 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d180dc5294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:62
    #2 0x55d180dc5294 in ModuleBase::matrix::matrix(ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:54
    #3 0x55d180dc64ae in ModuleBase::operator*(double const&, ModuleBase::matrix const&) /workspace/abacus-develop/source/module_base/matrix.cpp:231
    #4 0x55d181764bf1 in Run_MD_PW::md_force_virial(int const&, int const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:344
    #5 0x55d180ed0f44 in MD_func::force_virial(int const&, MD_parameters const&, UnitCell_pseudo const&, double&, ModuleBase::Vector3<double>*, ModuleBase::matrix&) /workspace/abacus-develop/source/module_md/MD_func.cpp:280
    #6 0x55d18175e056 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:116
    #7 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #8 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #9 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #10 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #11 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #12 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 72 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d180dc58f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:147
    #2 0x55d180dc58f3 in ModuleBase::matrix::create(int, int, bool) /workspace/abacus-develop/source/module_base/matrix.cpp:129
    #3 0x55d180ee30aa in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:16
    #4 0x55d180ef6f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #5 0x55d181761a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #6 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #7 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #8 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #9 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d180ee2db1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:12
    #2 0x55d180ef6f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x55d181761a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d180ee2cb5 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:11
    #2 0x55d180ef6f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x55d181761a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d180ee2fe1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:14
    #2 0x55d180ef6f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x55d181761a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d180ef7189 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:19
    #2 0x55d181761a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d180ef7103 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:18
    #2 0x55d181761a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d180ef707d in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:17
    #2 0x55d181761a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 32 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d180ef6ff7 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:16
    #2 0x55d181761a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #3 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #4 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #5 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #6 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d180ee2eb1 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:13
    #2 0x55d180ef6f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x55d181761a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Indirect leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fca695d47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55d180ee2c31 in Verlet::Verlet(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/verlet.cpp:10
    #2 0x55d180ef6f17 in NVT_NHC::NVT_NHC(MD_parameters&, UnitCell_pseudo&) /workspace/abacus-develop/source/module_md/NVT_NHC.cpp:4
    #3 0x55d181761a72 in Run_MD_PW::md_ions_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:67
    #4 0x55d1817638d6 in Run_MD_PW::md_cells_pw() /workspace/abacus-develop/source/src_pw/run_md_pw.cpp:236
    #5 0x55d181a7914b in Run_pw::plane_wave_line() /workspace/abacus-develop/source/run_pw.cpp:108
    #6 0x55d181a40e39 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:96
    #7 0x55d181a43678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #8 0x55d180d847cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #9 0x7fca673ccd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 2656 byte(s) leaked in 51 allocation(s).
```

## Test case 201_NO_15_f_pseudopots

### On process id asan.10642

```bash

=================================================================
==10642==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 7200 byte(s) in 20 object(s) allocated from:
    #0 0x7f8494f69e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f84935510bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 3192 byte(s) in 38 object(s) allocated from:
    #0 0x7f8494f6b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556357574ee1 in Gint_k::cal_vlocal_k(double const*, Grid_Technique const&, int) [clone ._omp_fn.0] /workspace/abacus-develop/source/src_lcao/gint_k_vl.cpp:405
    #2 0x7f8493246de5  (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0x19de5)

Direct leak of 2016 byte(s) in 24 object(s) allocated from:
    #0 0x7f8494f6b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556357574ee1 in Gint_k::cal_vlocal_k(double const*, Grid_Technique const&, int) [clone ._omp_fn.0] /workspace/abacus-develop/source/src_lcao/gint_k_vl.cpp:405
    #2 0x7f849323f4c1 in GOMP_parallel (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0x124c1)
    #3 0x55635818007f  (/workspace/abacus-develop/build/abacus+0x14a207f)

Direct leak of 56 byte(s) in 8 object(s) allocated from:
    #0 0x7f8494f69e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f84935a74d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

Direct leak of 56 byte(s) in 8 object(s) allocated from:
    #0 0x7f8494f69e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f84935a794e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f8494f6b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556356f975df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x556356f73d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x556357b9ca12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #4 0x556357b68eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #5 0x556357b6b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x556356eac7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f8492d63d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f8494f6b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556356f97578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x556356f73d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x556357b9ca12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #4 0x556357b68eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #5 0x556357b6b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x556356eac7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f8492d63d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f8494f6b7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x556356f974e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x556356f73d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x556357b9ca12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #4 0x556357b68eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #5 0x556357b6b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x556356eac7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f8492d63d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 12560 byte(s) leaked in 101 allocation(s).
```

### On process id asan.10643

```bash

=================================================================
==10643==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 3960 byte(s) in 11 object(s) allocated from:
    #0 0x7f165cea2e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f165b48a0bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 3192 byte(s) in 38 object(s) allocated from:
    #0 0x7f165cea47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555adba85ee1 in Gint_k::cal_vlocal_k(double const*, Grid_Technique const&, int) [clone ._omp_fn.0] /workspace/abacus-develop/source/src_lcao/gint_k_vl.cpp:405
    #2 0x7f165b17fde5  (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0x19de5)

Direct leak of 2016 byte(s) in 24 object(s) allocated from:
    #0 0x7f165cea47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555adba85ee1 in Gint_k::cal_vlocal_k(double const*, Grid_Technique const&, int) [clone ._omp_fn.0] /workspace/abacus-develop/source/src_lcao/gint_k_vl.cpp:405
    #2 0x7f165b1784c1 in GOMP_parallel (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0x124c1)
    #3 0x555adc69107f  (/workspace/abacus-develop/build/abacus+0x14a207f)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7f165cea2e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f165b5273b7  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x35d3b7)

Direct leak of 40 byte(s) in 6 object(s) allocated from:
    #0 0x7f165cea2e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f165b4e04d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

Direct leak of 40 byte(s) in 6 object(s) allocated from:
    #0 0x7f165cea2e8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f165b4e094e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 24 byte(s) in 1 object(s) allocated from:
    #0 0x7f165cea47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555adb43cdf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x555adb470f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x555adb4850b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x555adc0ada12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #5 0x555adc079eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #6 0x555adc07c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x555adb3bd7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f165ac9cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f165cea47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555adb43cd86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x555adb470f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x555adb4850b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x555adc0ada12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #5 0x555adc079eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #6 0x555adc07c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x555adb3bd7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f165ac9cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 8 byte(s) in 1 object(s) allocated from:
    #0 0x7f165cea47a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x555adb43cd20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x555adb470f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x555adb4850b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x555adc0ada12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #5 0x555adc079eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #6 0x555adc07c678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x555adb3bd7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f165ac9cd09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 9336 byte(s) leaked in 90 allocation(s).
```

## Test case 201_NO_15_pseudopots

### On process id asan.10778

```bash

=================================================================
==10778==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 7200 byte(s) in 20 object(s) allocated from:
    #0 0x7f008627ce8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f00848640bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 2552 byte(s) in 22 object(s) allocated from:
    #0 0x7f008627e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55a33e373ee1 in Gint_k::cal_vlocal_k(double const*, Grid_Technique const&, int) [clone ._omp_fn.0] /workspace/abacus-develop/source/src_lcao/gint_k_vl.cpp:405
    #2 0x7f0084559de5  (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0x19de5)

Direct leak of 928 byte(s) in 8 object(s) allocated from:
    #0 0x7f008627e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55a33e373ee1 in Gint_k::cal_vlocal_k(double const*, Grid_Technique const&, int) [clone ._omp_fn.0] /workspace/abacus-develop/source/src_lcao/gint_k_vl.cpp:405
    #2 0x7f00845524c1 in GOMP_parallel (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0x124c1)
    #3 0x55a33ef7f07f  (/workspace/abacus-develop/build/abacus+0x14a207f)

Direct leak of 56 byte(s) in 8 object(s) allocated from:
    #0 0x7f008627ce8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f00848ba4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

Direct leak of 56 byte(s) in 8 object(s) allocated from:
    #0 0x7f008627ce8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f00848ba94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f008627e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55a33dd965df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55a33dd72d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55a33e99ba12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #4 0x55a33e967eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #5 0x55a33e96a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55a33dcab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f0084076d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f008627e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55a33dd96578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55a33dd72d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55a33e99ba12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #4 0x55a33e967eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #5 0x55a33e96a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55a33dcab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f0084076d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f008627e7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55a33dd964e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55a33dd72d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55a33e99ba12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #4 0x55a33e967eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #5 0x55a33e96a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55a33dcab7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f0084076d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 10872 byte(s) leaked in 69 allocation(s).
```

### On process id asan.10779

```bash

=================================================================
==10779==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 3960 byte(s) in 11 object(s) allocated from:
    #0 0x7fb26af4de8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fb2695350bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 2376 byte(s) in 22 object(s) allocated from:
    #0 0x7fb26af4f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf840e8ee1 in Gint_k::cal_vlocal_k(double const*, Grid_Technique const&, int) [clone ._omp_fn.0] /workspace/abacus-develop/source/src_lcao/gint_k_vl.cpp:405
    #2 0x7fb26922ade5  (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0x19de5)

Direct leak of 864 byte(s) in 8 object(s) allocated from:
    #0 0x7fb26af4f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf840e8ee1 in Gint_k::cal_vlocal_k(double const*, Grid_Technique const&, int) [clone ._omp_fn.0] /workspace/abacus-develop/source/src_lcao/gint_k_vl.cpp:405
    #2 0x7fb2692234c1 in GOMP_parallel (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0x124c1)
    #3 0x55bf84cf407f  (/workspace/abacus-develop/build/abacus+0x14a207f)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7fb26af4f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf83a9fdf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x55bf83ad3f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55bf83ae80b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55bf84710a12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #5 0x55bf846dceb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #6 0x55bf846df678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55bf83a207cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fb268d47d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7fb26af4de8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fb2695d23b7  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x35d3b7)

Direct leak of 40 byte(s) in 6 object(s) allocated from:
    #0 0x7fb26af4de8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fb26958b4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

Direct leak of 40 byte(s) in 6 object(s) allocated from:
    #0 0x7fb26af4de8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7fb26958b94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fb26af4f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf83a9fd86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x55bf83ad3f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55bf83ae80b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55bf84710a12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #5 0x55bf846dceb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #6 0x55bf846df678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55bf83a207cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fb268d47d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7fb26af4f7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55bf83a9fd20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x55bf83ad3f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x55bf83ae80b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x55bf84710a12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #5 0x55bf846dceb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #6 0x55bf846df678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x55bf83a207cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7fb268d47d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 7408 byte(s) leaked in 58 allocation(s).
```

## Test case 201_NO_OU_pseudopots

### On process id asan.10903

```bash

=================================================================
==10903==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 7200 byte(s) in 20 object(s) allocated from:
    #0 0x7f2f2290ee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f2f20ef60bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 2668 byte(s) in 23 object(s) allocated from:
    #0 0x7f2f229107a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b5dd454ee1 in Gint_k::cal_vlocal_k(double const*, Grid_Technique const&, int) [clone ._omp_fn.0] /workspace/abacus-develop/source/src_lcao/gint_k_vl.cpp:405
    #2 0x7f2f20bebde5  (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0x19de5)

Direct leak of 1200 byte(s) in 1 object(s) allocated from:
    #0 0x7f2f229107a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b5dd605fb5 in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:491
    #2 0x55b5dd2af344 in Force_Stress_LCAO::calForcePwPart(ModuleBase::matrix&, ModuleBase::matrix&, ModuleBase::matrix&, ModuleBase::matrix&) /workspace/abacus-develop/source/src_lcao/FORCE_STRESS.cpp:708
    #3 0x55b5dd2af344 in Force_Stress_LCAO::getForceStress(bool, bool, bool, bool, ModuleBase::matrix&, ModuleBase::matrix&) /workspace/abacus-develop/source/src_lcao/FORCE_STRESS.cpp:88
    #4 0x55b5dd38ba4e in LOOP_ions::force_stress(int const&, int&, int&) /workspace/abacus-develop/source/src_lcao/LOOP_ions.cpp:310
    #5 0x55b5dd390574 in LOOP_ions::opt_ions() /workspace/abacus-develop/source/src_lcao/LOOP_ions.cpp:230
    #6 0x55b5dd38482c in LOOP_cell::opt_cell() /workspace/abacus-develop/source/src_lcao/LOOP_cell.cpp:70
    #7 0x55b5dda7da87 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:189
    #8 0x55b5dda48eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #9 0x55b5dda4b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55b5dcd8c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f2f20708d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 1044 byte(s) in 9 object(s) allocated from:
    #0 0x7f2f229107a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b5dd454ee1 in Gint_k::cal_vlocal_k(double const*, Grid_Technique const&, int) [clone ._omp_fn.0] /workspace/abacus-develop/source/src_lcao/gint_k_vl.cpp:405
    #2 0x7f2f20be44c1 in GOMP_parallel (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0x124c1)
    #3 0x55b5de06007f  (/workspace/abacus-develop/build/abacus+0x14a207f)

Direct leak of 400 byte(s) in 1 object(s) allocated from:
    #0 0x7f2f229107a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b5dd60603d in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:492
    #2 0x55b5dd2af344 in Force_Stress_LCAO::calForcePwPart(ModuleBase::matrix&, ModuleBase::matrix&, ModuleBase::matrix&, ModuleBase::matrix&) /workspace/abacus-develop/source/src_lcao/FORCE_STRESS.cpp:708
    #3 0x55b5dd2af344 in Force_Stress_LCAO::getForceStress(bool, bool, bool, bool, ModuleBase::matrix&, ModuleBase::matrix&) /workspace/abacus-develop/source/src_lcao/FORCE_STRESS.cpp:88
    #4 0x55b5dd38ba4e in LOOP_ions::force_stress(int const&, int&, int&) /workspace/abacus-develop/source/src_lcao/LOOP_ions.cpp:310
    #5 0x55b5dd390574 in LOOP_ions::opt_ions() /workspace/abacus-develop/source/src_lcao/LOOP_ions.cpp:230
    #6 0x55b5dd38482c in LOOP_cell::opt_cell() /workspace/abacus-develop/source/src_lcao/LOOP_cell.cpp:70
    #7 0x55b5dda7da87 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:189
    #8 0x55b5dda48eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #9 0x55b5dda4b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55b5dcd8c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f2f20708d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 200 byte(s) in 1 object(s) allocated from:
    #0 0x7f2f229107a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b5dd60607c in Forces::cal_force_ew(ModuleBase::matrix&) /workspace/abacus-develop/source/src_pw/forces.cpp:494
    #2 0x55b5dd2af344 in Force_Stress_LCAO::calForcePwPart(ModuleBase::matrix&, ModuleBase::matrix&, ModuleBase::matrix&, ModuleBase::matrix&) /workspace/abacus-develop/source/src_lcao/FORCE_STRESS.cpp:708
    #3 0x55b5dd2af344 in Force_Stress_LCAO::getForceStress(bool, bool, bool, bool, ModuleBase::matrix&, ModuleBase::matrix&) /workspace/abacus-develop/source/src_lcao/FORCE_STRESS.cpp:88
    #4 0x55b5dd38ba4e in LOOP_ions::force_stress(int const&, int&, int&) /workspace/abacus-develop/source/src_lcao/LOOP_ions.cpp:310
    #5 0x55b5dd390574 in LOOP_ions::opt_ions() /workspace/abacus-develop/source/src_lcao/LOOP_ions.cpp:230
    #6 0x55b5dd38482c in LOOP_cell::opt_cell() /workspace/abacus-develop/source/src_lcao/LOOP_cell.cpp:70
    #7 0x55b5dda7da87 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:189
    #8 0x55b5dda48eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #9 0x55b5dda4b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #10 0x55b5dcd8c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #11 0x7f2f20708d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 56 byte(s) in 8 object(s) allocated from:
    #0 0x7f2f2290ee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f2f20f4c4d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

Direct leak of 56 byte(s) in 8 object(s) allocated from:
    #0 0x7f2f2290ee8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f2f20f4c94e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f2f229107a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b5dce775df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x55b5dce53d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55b5dda7ca12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #4 0x55b5dda48eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #5 0x55b5dda4b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55b5dcd8c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f2f20708d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f2f229107a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b5dce77578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x55b5dce53d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55b5dda7ca12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #4 0x55b5dda48eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #5 0x55b5dda4b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55b5dcd8c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f2f20708d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f2f229107a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x55b5dce774e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x55b5dce53d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x55b5dda7ca12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #4 0x55b5dda48eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #5 0x55b5dda4b678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x55b5dcd8c7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f2f20708d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 12904 byte(s) leaked in 74 allocation(s).
```

### On process id asan.10904

```bash

=================================================================
==10904==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 3960 byte(s) in 11 object(s) allocated from:
    #0 0x7f6fb0bfae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f6faf1e20bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 2484 byte(s) in 23 object(s) allocated from:
    #0 0x7f6fb0bfc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5557f39f5ee1 in Gint_k::cal_vlocal_k(double const*, Grid_Technique const&, int) [clone ._omp_fn.0] /workspace/abacus-develop/source/src_lcao/gint_k_vl.cpp:405
    #2 0x7f6faeed7de5  (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0x19de5)

Direct leak of 972 byte(s) in 9 object(s) allocated from:
    #0 0x7f6fb0bfc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5557f39f5ee1 in Gint_k::cal_vlocal_k(double const*, Grid_Technique const&, int) [clone ._omp_fn.0] /workspace/abacus-develop/source/src_lcao/gint_k_vl.cpp:405
    #2 0x7f6faeed04c1 in GOMP_parallel (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0x124c1)
    #3 0x5557f460107f  (/workspace/abacus-develop/build/abacus+0x14a207f)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f6fb0bfc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5557f33acdf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x5557f33e0f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5557f33f50b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5557f401da12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #5 0x5557f3fe9eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #6 0x5557f3fec678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5557f332d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f6fae9f4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7f6fb0bfae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f6faf27f3b7  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x35d3b7)

Direct leak of 40 byte(s) in 6 object(s) allocated from:
    #0 0x7f6fb0bfae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f6faf2384d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

Direct leak of 40 byte(s) in 6 object(s) allocated from:
    #0 0x7f6fb0bfae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f6faf23894e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f6fb0bfc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5557f33acd86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x5557f33e0f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5557f33f50b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5557f401da12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #5 0x5557f3fe9eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #6 0x5557f3fec678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5557f332d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f6fae9f4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f6fb0bfc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5557f33acd20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x5557f33e0f76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5557f33f50b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5557f401da12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #5 0x5557f3fe9eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #6 0x5557f3fec678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5557f332d7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f6fae9f4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 7624 byte(s) leaked in 60 allocation(s).
```

## Test case 201_NO_upf201_pseudopots

### On process id asan.11088

```bash

=================================================================
==11088==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 7200 byte(s) in 20 object(s) allocated from:
    #0 0x7f3d17ffae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f3d165e20bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 2320 byte(s) in 20 object(s) allocated from:
    #0 0x7f3d17ffc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564c7cc66ee1 in Gint_k::cal_vlocal_k(double const*, Grid_Technique const&, int) [clone ._omp_fn.0] /workspace/abacus-develop/source/src_lcao/gint_k_vl.cpp:405
    #2 0x7f3d162d7de5  (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0x19de5)

Direct leak of 696 byte(s) in 6 object(s) allocated from:
    #0 0x7f3d17ffc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564c7cc66ee1 in Gint_k::cal_vlocal_k(double const*, Grid_Technique const&, int) [clone ._omp_fn.0] /workspace/abacus-develop/source/src_lcao/gint_k_vl.cpp:405
    #2 0x7f3d162d04c1 in GOMP_parallel (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0x124c1)
    #3 0x564c7d87207f  (/workspace/abacus-develop/build/abacus+0x14a207f)

Direct leak of 56 byte(s) in 8 object(s) allocated from:
    #0 0x7f3d17ffae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f3d166384d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

Direct leak of 56 byte(s) in 8 object(s) allocated from:
    #0 0x7f3d17ffae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f3d1663894e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f3d17ffc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564c7c6895df in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:574
    #2 0x564c7c665d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x564c7d28ea12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #4 0x564c7d25aeb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #5 0x564c7d25d678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x564c7c59e7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f3d15df4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f3d17ffc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564c7c689578 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:573
    #2 0x564c7c665d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x564c7d28ea12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #4 0x564c7d25aeb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #5 0x564c7d25d678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x564c7c59e7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f3d15df4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f3d17ffc7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x564c7c6894e8 in UnitCell_pseudo::read_atom_positions(LCAO_Orbitals&, std::basic_ifstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/read_atoms.cpp:572
    #2 0x564c7c665d76 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:96
    #3 0x564c7d28ea12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #4 0x564c7d25aeb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #5 0x564c7d25d678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #6 0x564c7c59e7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #7 0x7f3d15df4d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 10408 byte(s) leaked in 65 allocation(s).
```

### On process id asan.11089

```bash

=================================================================
==11089==ERROR: LeakSanitizer: detected memory leaks

Direct leak of 3960 byte(s) in 11 object(s) allocated from:
    #0 0x7f1aadb0ae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f1aac0f20bc  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x2c00bc)

Direct leak of 2160 byte(s) in 20 object(s) allocated from:
    #0 0x7f1aadb0c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5560db193ee1 in Gint_k::cal_vlocal_k(double const*, Grid_Technique const&, int) [clone ._omp_fn.0] /workspace/abacus-develop/source/src_lcao/gint_k_vl.cpp:405
    #2 0x7f1aabde7de5  (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0x19de5)

Direct leak of 648 byte(s) in 6 object(s) allocated from:
    #0 0x7f1aadb0c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5560db193ee1 in Gint_k::cal_vlocal_k(double const*, Grid_Technique const&, int) [clone ._omp_fn.0] /workspace/abacus-develop/source/src_lcao/gint_k_vl.cpp:405
    #2 0x7f1aabde04c1 in GOMP_parallel (/usr/lib/x86_64-linux-gnu/libgomp.so.1+0x124c1)
    #3 0x5560dbd9f07f  (/workspace/abacus-develop/build/abacus+0x14a207f)

Direct leak of 48 byte(s) in 1 object(s) allocated from:
    #0 0x7f1aadb0c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5560dab4adf0 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:145
    #2 0x5560dab7ef76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5560dab930b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5560db7bba12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #5 0x5560db787eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #6 0x5560db78a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5560daacb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f1aab904d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 48 byte(s) in 2 object(s) allocated from:
    #0 0x7f1aadb0ae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f1aac18f3b7  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x35d3b7)

Direct leak of 40 byte(s) in 6 object(s) allocated from:
    #0 0x7f1aadb0ae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f1aac1484d4  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x3164d4)

Direct leak of 40 byte(s) in 6 object(s) allocated from:
    #0 0x7f1aadb0ae8f in __interceptor_malloc ../../../../src/libsanitizer/asan/asan_malloc_linux.cpp:145
    #1 0x7f1aac14894e  (/usr/lib/x86_64-linux-gnu/libmpich.so.12+0x31694e)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f1aadb0c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5560dab4ad86 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:144
    #2 0x5560dab7ef76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5560dab930b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5560db7bba12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #5 0x5560db787eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #6 0x5560db78a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5560daacb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f1aab904d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

Direct leak of 16 byte(s) in 1 object(s) allocated from:
    #0 0x7f1aadb0c7a7 in operator new[](unsigned long) ../../../../src/libsanitizer/asan/asan_new_delete.cpp:102
    #1 0x5560dab4ad20 in Atom::bcast_atom() /workspace/abacus-develop/source/module_cell/atom_spec.cpp:143
    #2 0x5560dab7ef76 in UnitCell::bcast_unitcell() /workspace/abacus-develop/source/module_cell/unitcell.cpp:129
    #3 0x5560dab930b7 in UnitCell_pseudo::setup_cell(LCAO_Orbitals&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_ofstream<char, std::char_traits<char> >&) /workspace/abacus-develop/source/module_cell/unitcell_pseudo.cpp:129
    #4 0x5560db7bba12 in Run_lcao::lcao_line() /workspace/abacus-develop/source/run_lcao.cpp:29
    #5 0x5560db787eb3 in Driver::atomic_world() /workspace/abacus-develop/source/driver.cpp:101
    #6 0x5560db78a678 in Driver::init() /workspace/abacus-develop/source/driver.cpp:32
    #7 0x5560daacb7cd in main (/workspace/abacus-develop/build/abacus+0x1ce7cd)
    #8 0x7f1aab904d09 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x26d09)

SUMMARY: AddressSanitizer: 6976 byte(s) leaked in 54 allocation(s).
```

